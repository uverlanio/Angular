//PLV-3649 - INICIO - Performance - Gravar Orçamentos
@isTest
public class GravarOrcamentoServiceTest {

    @isTest 
    public static void getComplementoTestParcelamentoTrue(){

        Account contaPF = (Account) new AccountFactory.PessoaFisica().createRecord();

        ContadorCodigo__c contadorTec = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoTecnico().createRecord();
        ContadorCodigo__c contadorCom = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoComercial().createRecord();

        

        Product2 produtoTecnico = (Product2) new produtoFactory.ProdutoTecnico().createRecord();
        produtoTecnico.Status__c = 'Em ativação';
		produtoTecnico.NumeroSusep__c = '123';
		produtoTecnico.VersaoRenovacao__c = 'Versão atual';
        update produtoTecnico;
		produtoTecnico.Status__c = 'Ativo';
		update produtoTecnico;

        Product2 produtoComercial = (Product2) new ProdutoFactory.produtoComercial(produtoTecnico).createRecord();
        produtoComercial.VigenciaFinal__c = System.today().addDays(3);
        produtoComercial.status__c = 'Ativo'; 
        //PLV-5331 INICIO
        produtoComercial.CodigoPrecificaProduto__c = 'VI-PESSOAS';
        produtoComercial.ProductCode = 'VI-PESSOAS';
        //PLV-5331 FIM
        update produtoComercial;

        
        
        CanalDistribuicao__c canalDist = (CanalDistribuicao__c) new CanalDistribuicaoFactory().createRecord();
        canalDist.sigla__c = 'COR';
        update canalDist;

        ProdutoCanal__c produtoCanal = new ProdutoCanal__c(
                CanalDistribuicao__c = canalDist.Id,
                Produto__c = produtoComercial.Id
        );
        insert produtoCanal;

        TipoRemuneracao__c tipoRemuneracao = (TipoRemuneracao__c) new TipoRemuneracaoFactory().createRecord();
        tipoRemuneracao.name = 'CORRETAGEM';
        update tipoRemuneracao;
        
        RemuneracaoProduto__c remuneracaoProduto = (RemuneracaoProduto__c) new RemuneracaoProdutoFactory(tipoRemuneracao, produtoComercial).createRecord();
        remuneracaoProduto.Produto__c = produtoCanal.produto__c;
        remuneracaoProduto.TipoRemuneracao__c = tipoRemuneracao.Id;
        remuneracaoProduto.LimiteMinimo__c = 1;
        remuneracaoProduto.LimiteMaximo__c = 45;
        update remuneracaoProduto;
        
        RemuneracaoCanal__c remuneracaoCanal = new RemuneracaoCanal__c(
                ProdutoCanal__c = produtoCanal.Id,
                TipoRemuneracao__c = tipoRemuneracao.Id,
                LimiteMinimo__c = 1,
                LimiteMaximo__c = 45
        );
        insert remuneracaoCanal;

        FormaPagamento__c formaPagamento = (FormaPagamento__c) new FormaPagamentoFactory().createRecord();
        
        CondicaoCobranca__c condicaoCobranca = (CondicaoCobranca__c) new CondicaoCobrancaFactory.CondicaoCobranca(produtoComercial,formaPagamento).createRecord();
        condicaoCobranca.NomeFormaPagamento__c = 'ADC';
        condicaoCobranca.PercentualDescontoAgravo__c = -30;
        update condicaoCobranca;

        PlanoParcelamento__c planoParcelamento = new PlanoParcelamento__c(
                CodigoMeioRecebimento__c = '1234',
                DescricaoMeioRecebimento__c = 'RECEBIMENTO-BOLETO REGISTRADO',
                FormaPagamento__c = formaPagamento.id,
                NumeroParcela__c = 1               
        );

        insert planoParcelamento;

        ParametroVigencia__c parametroTec = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaTecnico(produtoTecnico).createRecord(); 
        parametroTec.ParcelamentoAposFinalVigencia__c = true;
        update parametroTec;
        ParametroVigencia__c parametroCom = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaComercial(produtoComercial).createRecord(); 
        parametroCom.ParcelamentoAposFinalVigencia__c = true;
        update parametroCom;

        RamoSeguro__c ramoSegurado = (RamoSeguro__c) new RamoSeguroFactory().createRecord();
        Garantia__c garantia = (garantia__c) new GarantiaFactory().createRecord();
        garantia.Sigla__c = 'MAP';
        garantia.TipoEvento__c = 'Acidente';
        update garantia;

        RamoGarantia__c ramoGarantia = (RamoGarantia__c) new RamoGarantiaFactory(garantia, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoTEC = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoTec(garantia, produtoTecnico, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoCom = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoCom(produtoComercial, garantia, garantiaProdutoTEC, ramoSegurado).createRecord();
        

        Opportunity orcamento1 = (Opportunity) new OrcamentoFactory.VidaIndividual(produtoComercial, contaPF).createRecord();        
        orcamento1.numero__c = '00008730';
        update orcamento1;
        
        

        List<Opportunity> listOrcamento = [SELECT Id, Name, Numero__c 
                                            FROM Opportunity 
                                            WHERE Numero__c IN ('00008730')];

        system.debug('listOrcamento:' + listOrcamento);
 
       //StaticResource recursoEstatico = [SELECT body FROM StaticResource WHERE name = 'PayloadGravarOrcamentoService' LIMIT 1]; //PLV-5331 INÍCIO / FIM
        
        // EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize(recursoEstatico.Body.toString(), EmissaoTO.PayloadTO.class); //PLV-5331 INÍCIO  FIM
        EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize('{"ofertas":[{"orcamento":{"tipoVigencia":"Determinado","tipoSeguro":"Novo","vigenciaFinal":"2020-05-09","numeroOrcamento":"00008730","numeroPortal":0,"codigoProdutoVida":"VI-PESSOAS","'+produtoComercial.Id+'":"123","contratantes":[{"tipo":"PRI","numero":1,"grupos":[{"numero":1,"tipoCalculo":"MOVSINT","segurados":[{"numero":1,"pessoa":{"tipo":"FIS","nome":"DOUGLAS DOMICIANO GANSO","dadosPessoaFisica":{"sexo":"MASC","numeroCpf":"378549429","digitoCpf":"78","estadoCivil":"CAS","dataNascimento":"1982-08-26","profissao":"493-09/883"},"email":"mussum.forevis@gmail.com","enderecos":[{"uf":"SP","tipoLogradouro":"R","tipoEndereco":"RES","paisResidencia":"BRA","numeroLogradouro":"92","logradouro":"Guaianses","complementoCep":"420","complemento":"Apto 22","cidade":"SAO PAULO","cep":"07114","bairro":"Centro"}]},"coberturas":[{"sigla":"ABC","valor":50000.0},{"sigla":"IEA","percentual":100.0,"garantiaReferenciada":"BAS"},{"sigla":"AFT","valor":3000.0}]}],"nome":"Passageiros até 70 anos","qtdeVidas":1,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]},{"numero":2,"tipoCalculo":"MOVSINT","nome":"Passageiros de 71 a 90 anos","qtdeVidas":0,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]}]}],"canalDistribuicao":"COR","viagem":{"tipoViagem":"NACIONAL","praticaEsportesAventura":false,"destinos":[{"codigo":"DESTINO","pais":"Brasil"}],"utilizaraMotocicleta":false,"passageirosNaoIdosos":1,"passageirosIdosos":0},"meioComercializacao":"CO2","varConsultivo":true,"segmento":"Individual","versoesCalculos":[{"opcao":1,"tipo":"FPG","descontoAgravo":-30},{"opcao":0,"tipo":"FPG","descontoAgravo":-25}],"numeroOferta":1699,"orcnum":"00008730","ordemPortal":1,"rotulo":"Brasil Terra","susepOrcamento":"P5005J","remuneracoes":[{"percentual":25,"tipoRemuneracao":"CORRETAGEM"}],"vigenciaInicial":"2020-04-20","dataCalculo":"2020-04-20"},"retornosCalculo":[{"opcao":1,"precificacao":{"encargos":0,"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}],"contratantes":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"grupos":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"segurados":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.834}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.649863}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.13589}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.633}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.4477}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.7434}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3601}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.1962}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3556}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2019}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}],"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"},{"opcao":0,"precificacao":{"encargos":0,"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}],"contratantes":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"grupos":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"segurados":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.834}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.649863}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.13589}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.633}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.4477}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.7434}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3601}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.1962}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3556}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2019}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}],"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"}],"retornoAceitacao":{"analises":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$400.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PARA ANALISAR","cliente":null,"representante":null}}],"recusas":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"avisos":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"pendencias":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"decisoes":[{"codigo":10055,"descricao":"Risco médio","tipo":"RISCO","acao":"QTNR_Completo"}]},"retornoIntegracoes":{}}]}', EmissaoTO.PayloadTO.class);

        for(EmissaoTO.OfertasTO oferta : payloadTO.ofertas){
            oferta.orcamento.vigenciaInicial = String.valueOf(System.today().addDays(1));
            oferta.orcamento.vigenciaFinal = String.valueOf(System.today().addDays(2));
            oferta.orcamento.dataCalculo = String.valueOf(system.today().addDays(1));
            oferta.orcamento.codigoProdutoVida = 'VI-PESSOAS'; //PLV-5331 INICIO/FIM
            oferta.orcamento.IdProdutoSf = produtoComercial.Id; //PLV-5331 INICIO/FIM
        }

        //FNPVVEP-83 INICIO
        Pergunta__c pergunta = new Pergunta__c(
            Pergunta__c = 'Qual a data de hoje',
            TipoResposta__c = 'Opção',
            OpcoesResposta__c = 'Sim;Não'
        );
        insert pergunta;
        
    	Questionario__c questionario = TestDataFactory.gerarQuestionario();
        questionario.Codigo__c = 'QTNR_Completo';
        update questionario;
        
    	PerguntaQuestionario__c perguntaQuestionario = new PerguntaQuestionario__c(
            Pergunta__c = pergunta.Id,
            Questionario__c = questionario.Id,
            Numero__c = 1,
            PerguntasOpcao__c = 'Sim;Não'
        );
        insert perguntaQuestionario;

        CoCorretagem__c corretagem = new CoCorretagem__c(
            SusepTransmissao__c = 'P5005J'
        );
        insert corretagem;
        //FNPVVEP-83 FIM

        GravarOrcamentoRest.Request rs = new GravarOrcamentoRest.Request();
        rs.ofertas = payloadTO.ofertas;
        //PLV-4698 INICIO
        rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.profissao = null;
        //PLV-4698 FIM

        Test.StartTest();
        GravarOrcamentoService gravarOrcamento = new GravarOrcamentoService(rs);
        gravarOrcamento.getcomplemento();
        Test.StopTest();
    }
    
    //PLV-4744 INICIO
    @isTest 
    public static void getComplementoTestComAgenciamentoEPercentualMaiorQueZero(){

        Account contaPF = (Account) new AccountFactory.PessoaFisica().createRecord();

        ContadorCodigo__c contadorTec = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoTecnico().createRecord();
        ContadorCodigo__c contadorCom = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoComercial().createRecord();

        Product2 produtoTecnico = (Product2) new produtoFactory.ProdutoTecnico().createRecord();
        produtoTecnico.Status__c = 'Em ativação';
		produtoTecnico.NumeroSusep__c = '123';
		produtoTecnico.VersaoRenovacao__c = 'Versão atual';
        update produtoTecnico;
		produtoTecnico.Status__c = 'Ativo';
		update produtoTecnico;

        Product2 produtoComercial = (Product2) new ProdutoFactory.produtoComercial(produtoTecnico).createRecord();
        produtoComercial.VigenciaFinal__c = System.today().addDays(3);
        produtoComercial.status__c = 'Ativo'; 
        //PLV-5331 INICIO
        produtoComercial.CodigoPrecificaProduto__c = 'VI-PESSOAS';
        produtoComercial.ProductCode = 'VI-PESSOAS';
        //PLV-5331 FIM
        update produtoComercial;

        CanalDistribuicao__c canalDist = (CanalDistribuicao__c) new CanalDistribuicaoFactory().createRecord();
        canalDist.sigla__c = 'COR';
        update canalDist;

        ProdutoCanal__c produtoCanal = new ProdutoCanal__c(
                CanalDistribuicao__c = canalDist.Id,
                Produto__c = produtoComercial.Id
        );
        insert produtoCanal;

        TipoRemuneracao__c tipoRemuneracao = (TipoRemuneracao__c) new TipoRemuneracaoFactory().createRecord();
        tipoRemuneracao.name = 'CORRETAGEM';
        update tipoRemuneracao;
        
        RemuneracaoProduto__c remuneracaoProduto = (RemuneracaoProduto__c) new RemuneracaoProdutoFactory(tipoRemuneracao, produtoComercial).createRecord();
        remuneracaoProduto.Produto__c = produtoCanal.produto__c;
        remuneracaoProduto.TipoRemuneracao__c = tipoRemuneracao.Id;
        remuneracaoProduto.LimiteMinimo__c = 1;
        remuneracaoProduto.LimiteMaximo__c = 45;
        update remuneracaoProduto;
        
        RemuneracaoCanal__c remuneracaoCanal = new RemuneracaoCanal__c(
                ProdutoCanal__c = produtoCanal.Id,
                TipoRemuneracao__c = tipoRemuneracao.Id,
                LimiteMinimo__c = 1,
                LimiteMaximo__c = 45
        );
        insert remuneracaoCanal;

        FormaPagamento__c formaPagamento = (FormaPagamento__c) new FormaPagamentoFactory().createRecord();
        
        CondicaoCobranca__c condicaoCobranca = (CondicaoCobranca__c) new CondicaoCobrancaFactory.CondicaoCobranca(produtoComercial,formaPagamento).createRecord();
        condicaoCobranca.NomeFormaPagamento__c = 'ADC';
        condicaoCobranca.PercentualDescontoAgravo__c = -30;
        update condicaoCobranca;

        PlanoParcelamento__c planoParcelamento = new PlanoParcelamento__c(
                CodigoMeioRecebimento__c = '1234',
                DescricaoMeioRecebimento__c = 'RECEBIMENTO-BOLETO REGISTRADO',
                FormaPagamento__c = formaPagamento.id,
                NumeroParcela__c = 1               
        );

        insert planoParcelamento;

        ParametroVigencia__c parametroTec = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaTecnico(produtoTecnico).createRecord(); 
        parametroTec.ParcelamentoAposFinalVigencia__c = true;
        update parametroTec;
        ParametroVigencia__c parametroCom = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaComercial(produtoComercial).createRecord(); 
        parametroCom.ParcelamentoAposFinalVigencia__c = true;
        update parametroCom;

        RamoSeguro__c ramoSegurado = (RamoSeguro__c) new RamoSeguroFactory().createRecord();
        Garantia__c garantia = (garantia__c) new GarantiaFactory().createRecord();
        garantia.Sigla__c = 'MAP';
        garantia.TipoEvento__c = 'Acidente';
        update garantia;

        RamoGarantia__c ramoGarantia = (RamoGarantia__c) new RamoGarantiaFactory(garantia, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoTEC = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoTec(garantia, produtoTecnico, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoCom = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoCom(produtoComercial, garantia, garantiaProdutoTEC, ramoSegurado).createRecord();
        


        Opportunity orcamento1 = (Opportunity) new OrcamentoFactory.VidaIndividual(produtoComercial, contaPF).createRecord();        
        orcamento1.numero__c = '00008730';
        update orcamento1;
        
        

        List<Opportunity> listOrcamento = [SELECT Id, Name, Numero__c 
                                            FROM Opportunity 
                                            WHERE Numero__c IN ('00008730')];

        system.debug('listOrcamento:' + listOrcamento);
 
        //StaticResource recursoEstatico = [SELECT body FROM StaticResource WHERE name = 'PayloadGravarOrcamentoService' LIMIT 1]; //PLV-5331 INÍCIO / FIM
        
        // EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize(recursoEstatico.Body.toString(), EmissaoTO.PayloadTO.class); //PLV-5331 INÍCIO  FIM
        EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize('{"ofertas":[{"orcamento":{"tipoVigencia":"Determinado","tipoSeguro":"Novo","vigenciaFinal":"2020-05-09","numeroOrcamento":"00008730","numeroPortal":0,"codigoProdutoVida":"VI-PESSOAS","idProdutoSf":"'+produtoComercial.Id+'","contratantes":[{"tipo":"PRI","numero":1,"grupos":[{"numero":1,"tipoCalculo":"MOVSINT","segurados":[{"numero":1,"pessoa":{"tipo":"FIS","nome":"DOUGLAS DOMICIANO GANSO","dadosPessoaFisica":{"sexo":"MASC","numeroCpf":"378549429","digitoCpf":"78","estadoCivil":"CAS","dataNascimento":"1982-08-26","profissao":"493-09/883"},"email":"mussum.forevis@gmail.com","enderecos":[{"uf":"SP","tipoLogradouro":"R","tipoEndereco":"RES","paisResidencia":"BRA","numeroLogradouro":"92","logradouro":"Guaianses","complementoCep":"420","complemento":"Apto 22","cidade":"SAO PAULO","cep":"07114","bairro":"Centro"}]},"coberturas":[{"sigla":"ABC","valor":50000.0},{"sigla":"IEA","percentual":100.0,"garantiaReferenciada":"BAS"},{"sigla":"AFT","valor":3000.0}]}],"nome":"Passageiros até 70 anos","qtdeVidas":1,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]},{"numero":2,"tipoCalculo":"MOVSINT","nome":"Passageiros de 71 a 90 anos","qtdeVidas":0,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]}]}],"canalDistribuicao":"COR","viagem":{"tipoViagem":"NACIONAL","praticaEsportesAventura":false,"destinos":[{"codigo":"DESTINO","pais":"Brasil"}],"utilizaraMotocicleta":false,"passageirosNaoIdosos":1,"passageirosIdosos":0},"meioComercializacao":"CO2","varConsultivo":true,"segmento":"Individual","versoesCalculos":[{"opcao":1,"tipo":"FPG","descontoAgravo":-30},{"opcao":0,"tipo":"FPG","descontoAgravo":-25}],"numeroOferta":1699,"orcnum":"00008730","ordemPortal":1,"rotulo":"Brasil Terra","susepOrcamento":"P5005J","remuneracoes":[{"percentual":25,"tipoRemuneracao":"CORRETAGEM"}],"vigenciaInicial":"2020-04-20","dataCalculo":"2020-04-20"},"retornosCalculo":[{"opcao":1,"precificacao":{"encargos":0,"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}],"contratantes":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"grupos":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"segurados":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.834}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.649863}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.13589}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.633}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.4477}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.7434}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3601}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.1962}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3556}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2019}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}],"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"},{"opcao":0,"precificacao":{"encargos":0,"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}],"contratantes":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"grupos":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"segurados":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.834}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.649863}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.13589}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.633}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.4477}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.7434}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3601}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.1962}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3556}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2019}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}],"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"}],"retornoAceitacao":{"analises":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$400.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PARA ANALISAR","cliente":null,"representante":null}}],"recusas":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"avisos":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"pendencias":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"decisoes":[{"codigo":10055,"descricao":"Risco médio","tipo":"RISCO","acao":"QTNR_Completo"}]},"retornoIntegracoes":{}}]}', EmissaoTO.PayloadTO.class);

        for(EmissaoTO.OfertasTO oferta : payloadTO.ofertas){
            oferta.orcamento.vigenciaInicial = String.valueOf(System.today().addDays(1));
            oferta.orcamento.vigenciaFinal = String.valueOf(System.today().addDays(2));
            oferta.orcamento.dataCalculo = String.valueOf(system.today().addDays(1));
            oferta.orcamento.codigoProdutoVida = 'VI-PESSOAS'; //PLV-5331 INICIO/FIM
            oferta.orcamento.IdProdutoSf = produtoComercial.Id; //PLV-5331 INICIO/FIM
        }

        GravarOrcamentoRest.Request rs = new GravarOrcamentoRest.Request();
        rs.ofertas = payloadTO.ofertas;
        rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.profissao = null;
        
        rs.ofertas[0].orcamento.remuneracoes[0].percentual = 100;
        rs.ofertas[0].orcamento.remuneracoes[0].tipoRemuneracao = 'AGENCIAMENTO';
        system.debug('getComplementoTestParcelamentoTrue .. rs.ofertas .. percentual .. '+rs.ofertas[0].orcamento.remuneracoes[0].percentual);
        system.debug('getComplementoTestParcelamentoTrue .. rs.ofertas .. tipoRemuneracao .. '+rs.ofertas[0].orcamento.remuneracoes[0].tipoRemuneracao);
        
        
        Test.StartTest();
        GravarOrcamentoService gravarOrcamento = new GravarOrcamentoService(rs);
        gravarOrcamento.getcomplemento();
        Test.StopTest();
    }
    //PLV-4744 FIM
    
    @isTest 
    public static void getComplementoTestParcelamentoFalse(){
        
        Account contaPF = (Account) new AccountFactory.PessoaFisica().createRecord();

        ContadorCodigo__c contadorTec = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoTecnico().createRecord();
        ContadorCodigo__c contadorCom = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoComercial().createRecord();

        Product2 produtoTecnico = (Product2) new produtoFactory.ProdutoTecnico().createRecord();
        produtoTecnico.Status__c = 'Em ativação';
		produtoTecnico.NumeroSusep__c = '123';
		produtoTecnico.VersaoRenovacao__c = 'Versão atual';
        update produtoTecnico;
		produtoTecnico.Status__c = 'Ativo';
		update produtoTecnico;

        Product2 produtoComercial = (Product2) new ProdutoFactory.produtoComercial(produtoTecnico).createRecord();
        produtoComercial.VigenciaFinal__c = System.today().addDays(3);
        produtoComercial.status__c = 'Ativo'; 
        //PLV-5331 INICIO
        produtoComercial.CodigoPrecificaProduto__c = 'VI-PESSOAS';
        produtoComercial.ProductCode = 'VI-PESSOAS';
        //PLV-5331 FIM
        update produtoComercial;

        CanalDistribuicao__c canalDist = (CanalDistribuicao__c) new CanalDistribuicaoFactory().createRecord();
        canalDist.sigla__c = 'COR';
        update canalDist;

        ProdutoCanal__c produtoCanal = new ProdutoCanal__c(
                CanalDistribuicao__c = canalDist.Id,
                Produto__c = produtoComercial.Id
        );
        insert produtoCanal;

        TipoRemuneracao__c tipoRemuneracao = (TipoRemuneracao__c) new TipoRemuneracaoFactory().createRecord();
        tipoRemuneracao.name = 'CORRETAGEM';
        update tipoRemuneracao;
        
        RemuneracaoProduto__c remuneracaoProduto = (RemuneracaoProduto__c) new RemuneracaoProdutoFactory(tipoRemuneracao, produtoComercial).createRecord();
        remuneracaoProduto.Produto__c = produtoCanal.produto__c;
        remuneracaoProduto.TipoRemuneracao__c = tipoRemuneracao.Id;
        remuneracaoProduto.LimiteMinimo__c = 1;
        remuneracaoProduto.LimiteMaximo__c = 45;
        update remuneracaoProduto;
        
        RemuneracaoCanal__c remuneracaoCanal = new RemuneracaoCanal__c(
                ProdutoCanal__c = produtoCanal.Id,
                TipoRemuneracao__c = tipoRemuneracao.Id,
                LimiteMinimo__c = 1,
                LimiteMaximo__c = 45
        );
        insert remuneracaoCanal;

        FormaPagamento__c formaPagamento = (FormaPagamento__c) new FormaPagamentoFactory().createRecord();
        
        CondicaoCobranca__c condicaoCobranca = (CondicaoCobranca__c) new CondicaoCobrancaFactory.CondicaoCobranca(produtoComercial,formaPagamento).createRecord();
        condicaoCobranca.NomeFormaPagamento__c = 'ADC';
        condicaoCobranca.PercentualDescontoAgravo__c = -30;
        update condicaoCobranca;

        PlanoParcelamento__c planoParcelamento = new PlanoParcelamento__c(
                CodigoMeioRecebimento__c = '1234',
                DescricaoMeioRecebimento__c = 'RECEBIMENTO-BOLETO REGISTRADO',
                FormaPagamento__c = formaPagamento.id,
                NumeroParcela__c = 1               
        );

        insert planoParcelamento;

        ParametroVigencia__c parametroTec = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaTecnico(produtoTecnico).createRecord(); 
        parametroTec.ParcelamentoAposFinalVigencia__c = false;
        update parametroTec;
        ParametroVigencia__c parametroCom = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaComercial(produtoComercial).createRecord(); 
        parametroCom.ParcelamentoAposFinalVigencia__c = false;
        update parametroCom;

        RamoSeguro__c ramoSegurado = (RamoSeguro__c) new RamoSeguroFactory().createRecord();
        Garantia__c garantia = (garantia__c) new GarantiaFactory().createRecord();
        garantia.Sigla__c = 'MAP';
        garantia.TipoEvento__c = 'Acidente';
        update garantia;

        RamoGarantia__c ramoGarantia = (RamoGarantia__c) new RamoGarantiaFactory(garantia, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoTEC = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoTec(garantia, produtoTecnico, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoCom = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoCom(produtoComercial, garantia, garantiaProdutoTEC, ramoSegurado).createRecord();
        

        Opportunity orcamento1 = (Opportunity) new OrcamentoFactory.VidaIndividual(produtoComercial, contaPF).createRecord();        
        orcamento1.numero__c = '00008730';
        update orcamento1;
        
        List<Opportunity> listOrcamento = [SELECT Id, Name, Numero__c 
                                            FROM Opportunity 
                                            WHERE Numero__c IN ('00008730')];

        system.debug('listOrcamento:' + listOrcamento); 

        //StaticResource recursoEstatico = [SELECT body FROM StaticResource WHERE name = 'PayloadGravarOrcamentoService' LIMIT 1]; //PLV-5331 INÍCIO / FIM
        
        // EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize(recursoEstatico.Body.toString(), EmissaoTO.PayloadTO.class); //PLV-5331 INÍCIO  FIM
        EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize('{"ofertas":[{"orcamento":{"tipoVigencia":"Determinado","tipoSeguro":"Novo","vigenciaFinal":"2020-05-09","numeroOrcamento":"00008730","numeroPortal":0,"codigoProdutoVida":"VI-PESSOAS","idProdutoSf":"'+produtoComercial.Id+'","contratantes":[{"tipo":"PRI","numero":1,"grupos":[{"numero":1,"tipoCalculo":"MOVSINT","segurados":[{"numero":1,"pessoa":{"tipo":"FIS","nome":"DOUGLAS DOMICIANO GANSO","dadosPessoaFisica":{"sexo":"MASC","numeroCpf":"378549429","digitoCpf":"78","estadoCivil":"CAS","dataNascimento":"1982-08-26","profissao":"493-09/883"},"email":"mussum.forevis@gmail.com","enderecos":[{"uf":"SP","tipoLogradouro":"R","tipoEndereco":"RES","paisResidencia":"BRA","numeroLogradouro":"92","logradouro":"Guaianses","complementoCep":"420","complemento":"Apto 22","cidade":"SAO PAULO","cep":"07114","bairro":"Centro"}]},"coberturas":[{"sigla":"ABC","valor":50000.0},{"sigla":"IEA","percentual":100.0,"garantiaReferenciada":"BAS"},{"sigla":"AFT","valor":3000.0}]}],"nome":"Passageiros até 70 anos","qtdeVidas":1,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]},{"numero":2,"tipoCalculo":"MOVSINT","nome":"Passageiros de 71 a 90 anos","qtdeVidas":0,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]}]}],"canalDistribuicao":"COR","viagem":{"tipoViagem":"NACIONAL","praticaEsportesAventura":false,"destinos":[{"codigo":"DESTINO","pais":"Brasil"}],"utilizaraMotocicleta":false,"passageirosNaoIdosos":1,"passageirosIdosos":0},"meioComercializacao":"CO2","varConsultivo":true,"segmento":"Individual","versoesCalculos":[{"opcao":1,"tipo":"FPG","descontoAgravo":-30},{"opcao":0,"tipo":"FPG","descontoAgravo":-25}],"numeroOferta":1699,"orcnum":"00008730","ordemPortal":1,"rotulo":"Brasil Terra","susepOrcamento":"P5005J","remuneracoes":[{"percentual":25,"tipoRemuneracao":"CORRETAGEM"}],"vigenciaInicial":"2020-04-20","dataCalculo":"2020-04-20"},"retornosCalculo":[{"opcao":1,"precificacao":{"encargos":0,"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}],"contratantes":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"grupos":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"segurados":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.834}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.649863}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.13589}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.633}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.4477}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.7434}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3601}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.1962}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3556}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2019}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}],"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"},{"opcao":0,"precificacao":{"encargos":0,"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}],"contratantes":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"grupos":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"segurados":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.834}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.649863}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.13589}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.633}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.4477}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.7434}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3601}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.1962}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3556}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2019}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}],"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"}],"retornoAceitacao":{"analises":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$400.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PARA ANALISAR","cliente":null,"representante":null}}],"recusas":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"avisos":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"pendencias":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"decisoes":[{"codigo":10055,"descricao":"Risco médio","tipo":"RISCO","acao":"QTNR_Completo"}]},"retornoIntegracoes":{}}]}', EmissaoTO.PayloadTO.class);

        for(EmissaoTO.OfertasTO oferta : payloadTO.ofertas){
            oferta.orcamento.vigenciaInicial = String.valueOf(System.today().addDays(1));
            oferta.orcamento.vigenciaFinal = String.valueOf(System.today().addDays(2));
            oferta.orcamento.dataCalculo = String.valueOf(system.today().addDays(1));
            oferta.orcamento.codigoProdutoVida = 'VI-PESSOAS'; //PLV-5331 INICIO/FIM
            oferta.orcamento.IdProdutoSf = produtoComercial.Id; //PLV-5331 INICIO/FIM
        }

        GravarOrcamentoRest.Request rs = new GravarOrcamentoRest.Request();
        rs.ofertas = payloadTO.ofertas;
        //PLV-4698 INICIO
        rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.profissao = null;
        //PLV-4698 FIM
		

        Test.StartTest();
        GravarOrcamentoService gravarOrcamento = new GravarOrcamentoService(rs);
        gravarOrcamento.getcomplemento();
        Test.StopTest();
    } 
    //PLV-4840 INICIO
    @isTest
    public static void getComplementoTestIdadeForaRange(){
        Account contaPF = (Account) new AccountFactory.PessoaFisica().createRecord();

        ContadorCodigo__c contadorTec = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoTecnico().createRecord();
        ContadorCodigo__c contadorCom = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoComercial().createRecord();

        

        Product2 produtoTecnico = (Product2) new produtoFactory.ProdutoTecnico().createRecord();
        produtoTecnico.Status__c = 'Em ativação';
		produtoTecnico.NumeroSusep__c = '123';
		produtoTecnico.VersaoRenovacao__c = 'Versão atual';
        update produtoTecnico;
		produtoTecnico.Status__c = 'Ativo';
		update produtoTecnico;

        Product2 produtoComercial = (Product2) new ProdutoFactory.produtoComercial(produtoTecnico).createRecord();
        produtoComercial.VigenciaFinal__c = System.today().addDays(3);
        produtoComercial.status__c = 'Ativo'; 
        //PLV-5331 INICIO
        produtoComercial.CodigoPrecificaProduto__c = 'VI-PESSOAS';
        produtoComercial.ProductCode = 'VI-PESSOAS';
        //PLV-5331 FIM

        update produtoComercial;

        
        
        CanalDistribuicao__c canalDist = (CanalDistribuicao__c) new CanalDistribuicaoFactory().createRecord();
        canalDist.sigla__c = 'COR';
        update canalDist;

        ProdutoCanal__c produtoCanal = new ProdutoCanal__c(
                CanalDistribuicao__c = canalDist.Id,
                Produto__c = produtoComercial.Id
        );
        insert produtoCanal;

        TipoRemuneracao__c tipoRemuneracao = (TipoRemuneracao__c) new TipoRemuneracaoFactory().createRecord();
        tipoRemuneracao.name = 'CORRETAGEM';
        update tipoRemuneracao;
        
        RemuneracaoProduto__c remuneracaoProduto = (RemuneracaoProduto__c) new RemuneracaoProdutoFactory(tipoRemuneracao, produtoComercial).createRecord();
        remuneracaoProduto.Produto__c = produtoCanal.produto__c;
        remuneracaoProduto.TipoRemuneracao__c = tipoRemuneracao.Id;
        remuneracaoProduto.LimiteMinimo__c = 1;
        remuneracaoProduto.LimiteMaximo__c = 45;
        update remuneracaoProduto;
        
        RemuneracaoCanal__c remuneracaoCanal = new RemuneracaoCanal__c(
                ProdutoCanal__c = produtoCanal.Id,
                TipoRemuneracao__c = tipoRemuneracao.Id,
                LimiteMinimo__c = 1,
                LimiteMaximo__c = 45
        );
        insert remuneracaoCanal;

        FormaPagamento__c formaPagamento = (FormaPagamento__c) new FormaPagamentoFactory().createRecord();
        
        CondicaoCobranca__c condicaoCobranca = (CondicaoCobranca__c) new CondicaoCobrancaFactory.CondicaoCobranca(produtoComercial,formaPagamento).createRecord();
        condicaoCobranca.NomeFormaPagamento__c = 'ADC';
        condicaoCobranca.PercentualDescontoAgravo__c = -30;
        update condicaoCobranca;

        PlanoParcelamento__c planoParcelamento = new PlanoParcelamento__c(
                CodigoMeioRecebimento__c = '1234',
                DescricaoMeioRecebimento__c = 'RECEBIMENTO-BOLETO REGISTRADO',
                FormaPagamento__c = formaPagamento.id,
                NumeroParcela__c = 1               
        );

        insert planoParcelamento;

        ParametroVigencia__c parametroTec = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaTecnico(produtoTecnico).createRecord(); 
        parametroTec.ParcelamentoAposFinalVigencia__c = true;
        update parametroTec;
        ParametroVigencia__c parametroCom = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaComercial(produtoComercial).createRecord(); 
        parametroCom.ParcelamentoAposFinalVigencia__c = true;
        update parametroCom;

        RamoSeguro__c ramoSegurado = (RamoSeguro__c) new RamoSeguroFactory().createRecord();
        Garantia__c garantia = (garantia__c) new GarantiaFactory().createRecord();
        garantia.Sigla__c = 'MAP';
        garantia.TipoEvento__c = 'Acidente';
        update garantia;

        RamoGarantia__c ramoGarantia = (RamoGarantia__c) new RamoGarantiaFactory(garantia, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoTEC = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoTec(garantia, produtoTecnico, ramoSegurado).createRecord();
        garantiaProdutoTEC.LimiteIdadeMaximo__c = 70;
        garantiaProdutoTEC.LimiteIdadeMinimo__c = 16;
        update  garantiaProdutoTEC;
        GarantiaProduto__c garantiaProdutoCom = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoCom(produtoComercial, garantia, garantiaProdutoTEC, ramoSegurado).createRecord();
        garantiaProdutoCom.LimiteIdadeMaximo__c = 70;
        garantiaProdutoCom.LimiteIdadeMinimo__c = 16;
        update  garantiaProdutoCom;


        Opportunity orcamento1 = (Opportunity) new OrcamentoFactory.VidaIndividual(produtoComercial, contaPF).createRecord();        
        orcamento1.numero__c = '00008730';
        update orcamento1;
        
        

        List<Opportunity> listOrcamento = [SELECT Id, Name, Numero__c 
                                            FROM Opportunity 
                                            WHERE Numero__c IN ('00008730')];

        system.debug('listOrcamento:' + listOrcamento);
 
        
        //StaticResource recursoEstatico = [SELECT body FROM StaticResource WHERE name = 'PayloadGravarOrcamentoService' LIMIT 1]; //PLV-5331 INICIO /FIM
    
        // EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize(recursoEstatico.Body.toString(), EmissaoTO.PayloadTO.class); //PLV-5331 INÍCIO  FIM
        EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize('{"ofertas":[{"orcamento":{"tipoVigencia":"Determinado","tipoSeguro":"Novo","vigenciaFinal":"2020-05-09","numeroOrcamento":"00008730","numeroPortal":0,"codigoProdutoVida":"VI-PESSOAS","idProdutoSf":"'+produtoComercial.Id+'","contratantes":[{"tipo":"PRI","numero":1,"grupos":[{"numero":1,"tipoCalculo":"MOVSINT","segurados":[{"numero":1,"pessoa":{"tipo":"FIS","nome":"DOUGLAS DOMICIANO GANSO","dadosPessoaFisica":{"sexo":"MASC","numeroCpf":"378549429","digitoCpf":"78","estadoCivil":"CAS","dataNascimento":"1982-08-26","profissao":"493-09/883"},"email":"mussum.forevis@gmail.com","enderecos":[{"uf":"SP","tipoLogradouro":"R","tipoEndereco":"RES","paisResidencia":"BRA","numeroLogradouro":"92","logradouro":"Guaianses","complementoCep":"420","complemento":"Apto 22","cidade":"SAO PAULO","cep":"07114","bairro":"Centro"}]},"coberturas":[{"sigla":"ABC","valor":50000.0},{"sigla":"IEA","percentual":100.0,"garantiaReferenciada":"BAS"},{"sigla":"AFT","valor":3000.0}]}],"nome":"Passageiros até 70 anos","qtdeVidas":1,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]},{"numero":2,"tipoCalculo":"MOVSINT","nome":"Passageiros de 71 a 90 anos","qtdeVidas":0,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]}]}],"canalDistribuicao":"COR","viagem":{"tipoViagem":"NACIONAL","praticaEsportesAventura":false,"destinos":[{"codigo":"DESTINO","pais":"Brasil"}],"utilizaraMotocicleta":false,"passageirosNaoIdosos":1,"passageirosIdosos":0},"meioComercializacao":"CO2","varConsultivo":true,"segmento":"Individual","versoesCalculos":[{"opcao":1,"tipo":"FPG","descontoAgravo":-30},{"opcao":0,"tipo":"FPG","descontoAgravo":-25}],"numeroOferta":1699,"orcnum":"00008730","ordemPortal":1,"rotulo":"Brasil Terra","susepOrcamento":"P5005J","remuneracoes":[{"percentual":25,"tipoRemuneracao":"CORRETAGEM"}],"vigenciaInicial":"2020-04-20","dataCalculo":"2020-04-20"},"retornosCalculo":[{"opcao":1,"precificacao":{"encargos":0,"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}],"contratantes":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"grupos":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"segurados":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.834}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.649863}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.13589}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.633}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.4477}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.7434}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3601}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.1962}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3556}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2019}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}],"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"},{"opcao":0,"precificacao":{"encargos":0,"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}],"contratantes":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"grupos":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"segurados":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.834}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.649863}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.13589}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.633}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.4477}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.7434}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3601}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.1962}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3556}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2019}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}],"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"}],"retornoAceitacao":{"analises":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$400.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PARA ANALISAR","cliente":null,"representante":null}}],"recusas":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"avisos":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"pendencias":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"decisoes":[{"codigo":10055,"descricao":"Risco médio","tipo":"RISCO","acao":"QTNR_Completo"}]},"retornoIntegracoes":{}}]}', EmissaoTO.PayloadTO.class);
        for(EmissaoTO.OfertasTO oferta : payloadTO.ofertas){
            oferta.orcamento.vigenciaInicial = String.valueOf(System.today().addDays(1));
            oferta.orcamento.vigenciaFinal = String.valueOf(System.today().addDays(2));
            oferta.orcamento.dataCalculo = String.valueOf(system.today().addDays(1));
            oferta.orcamento.codigoProdutoVida = 'VI-PESSOAS'; //PLV-5331 INICIO/FIM
            oferta.orcamento.IdProdutoSf = produtoComercial.Id; //PLV-5331 INICIO/FIM
        }

        GravarOrcamentoRest.Request rs = new GravarOrcamentoRest.Request();
        rs.ofertas = payloadTO.ofertas;
        rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.profissao = null;
		rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.dataNascimento = '1949-01-01';

        Test.StartTest();
        GravarOrcamentoService gravarOrcamento = new GravarOrcamentoService(rs);
        gravarOrcamento.getcomplemento();
        Test.StopTest();
    }
    //PLV-4840 FIM

    //PLV-5066 - INICIO
    @isTest
    public static void ajustarPremioEndossoCadastral_sucesso(){
        Account contaPF = (Account) new AccountFactory.PessoaFisica().createRecord();

        ContadorCodigo__c contadorTec = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoTecnico().createRecord();
        ContadorCodigo__c contadorCom = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoComercial().createRecord();

        

        Product2 produtoTecnico = (Product2) new produtoFactory.ProdutoTecnico().createRecord();
        produtoTecnico.Status__c = 'Em ativação';
		produtoTecnico.NumeroSusep__c = '123';
		produtoTecnico.VersaoRenovacao__c = 'Versão atual';
        update produtoTecnico;
		produtoTecnico.Status__c = 'Ativo';
		update produtoTecnico;

        Product2 produtoComercial = (Product2) new ProdutoFactory.produtoComercial(produtoTecnico).createRecord();
        produtoComercial.VigenciaFinal__c = System.today().addDays(3);
        produtoComercial.status__c = 'Ativo'; 
        //PLV-5331 INICIO
        produtoComercial.CodigoPrecificaProduto__c = 'VI-PESSOAS';
        produtoComercial.ProductCode = 'VI-PESSOAS';
        //PLV-5331 FIM
        update produtoComercial;

        
        
        CanalDistribuicao__c canalDist = (CanalDistribuicao__c) new CanalDistribuicaoFactory().createRecord();
        canalDist.sigla__c = 'COR';
        update canalDist;

        ProdutoCanal__c produtoCanal = new ProdutoCanal__c(
                CanalDistribuicao__c = canalDist.Id,
                Produto__c = produtoComercial.Id
        );
        insert produtoCanal;

        TipoRemuneracao__c tipoRemuneracao = (TipoRemuneracao__c) new TipoRemuneracaoFactory().createRecord();
        tipoRemuneracao.name = 'CORRETAGEM';
        update tipoRemuneracao;
        
        RemuneracaoProduto__c remuneracaoProduto = (RemuneracaoProduto__c) new RemuneracaoProdutoFactory(tipoRemuneracao, produtoComercial).createRecord();
        remuneracaoProduto.Produto__c = produtoCanal.produto__c;
        remuneracaoProduto.TipoRemuneracao__c = tipoRemuneracao.Id;
        remuneracaoProduto.LimiteMinimo__c = 1;
        remuneracaoProduto.LimiteMaximo__c = 45;
        update remuneracaoProduto;
        
        RemuneracaoCanal__c remuneracaoCanal = new RemuneracaoCanal__c(
                ProdutoCanal__c = produtoCanal.Id,
                TipoRemuneracao__c = tipoRemuneracao.Id,
                LimiteMinimo__c = 1,
                LimiteMaximo__c = 45
        );
        insert remuneracaoCanal;

        FormaPagamento__c formaPagamento = (FormaPagamento__c) new FormaPagamentoFactory().createRecord();
        
        CondicaoCobranca__c condicaoCobranca = (CondicaoCobranca__c) new CondicaoCobrancaFactory.CondicaoCobranca(produtoComercial,formaPagamento).createRecord();
        condicaoCobranca.NomeFormaPagamento__c = 'ADC';
        condicaoCobranca.PercentualDescontoAgravo__c = -30;
        update condicaoCobranca;

        PlanoParcelamento__c planoParcelamento = new PlanoParcelamento__c(
                CodigoMeioRecebimento__c = '1234',
                DescricaoMeioRecebimento__c = 'RECEBIMENTO-BOLETO REGISTRADO',
                FormaPagamento__c = formaPagamento.id, 
                NumeroParcela__c = 1               
        );

        insert planoParcelamento;

        ParametroVigencia__c parametroTec = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaTecnico(produtoTecnico).createRecord(); 
        parametroTec.ParcelamentoAposFinalVigencia__c = true;
        update parametroTec;
        ParametroVigencia__c parametroCom = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaComercial(produtoComercial).createRecord(); 
        parametroCom.ParcelamentoAposFinalVigencia__c = true;
        update parametroCom;

        RamoSeguro__c ramoSegurado = (RamoSeguro__c) new RamoSeguroFactory().createRecord();
        Garantia__c garantia = (garantia__c) new GarantiaFactory().createRecord();
        garantia.Sigla__c = 'MAP';
        garantia.TipoEvento__c = 'Acidente';
        update garantia;

        RamoGarantia__c ramoGarantia = (RamoGarantia__c) new RamoGarantiaFactory(garantia, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoTEC = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoTec(garantia, produtoTecnico, ramoSegurado).createRecord();
        garantiaProdutoTEC.LimiteIdadeMaximo__c = 70;
        garantiaProdutoTEC.LimiteIdadeMinimo__c = 16;
        update  garantiaProdutoTEC;
        GarantiaProduto__c garantiaProdutoCom = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoCom(produtoComercial, garantia, garantiaProdutoTEC, ramoSegurado).createRecord();
        garantiaProdutoCom.LimiteIdadeMaximo__c = 70;
        garantiaProdutoCom.LimiteIdadeMinimo__c = 16;
        update  garantiaProdutoCom;

        Opportunity orcamento1 = (Opportunity) new OrcamentoFactory.VidaIndividual(produtoComercial, contaPF).createRecord();        
        orcamento1.numero__c = '00008730';
        update orcamento1;
        
        //StaticResource recursoEstatico = [SELECT body FROM StaticResource WHERE name = 'PayloadGravarOrcamentoService' LIMIT 1]; //PLV-5331 INICIO / FIM

        // EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize(recursoEstatico.Body.toString(), EmissaoTO.PayloadTO.class); //PLV-5331 INÍCIO  FIM
        EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize('{"ofertas":[{"orcamento":{"tipoVigencia":"Determinado","tipoSeguro":"Novo","vigenciaFinal":"2020-05-09","numeroOrcamento":"00008730","numeroPortal":0,"codigoProdutoVida":"VI-PESSOAS","idProdutoSf":"'+produtoComercial.Id+'","contratantes":[{"tipo":"PRI","numero":1,"grupos":[{"numero":1,"tipoCalculo":"MOVSINT","segurados":[{"numero":1,"pessoa":{"tipo":"FIS","nome":"DOUGLAS DOMICIANO GANSO","dadosPessoaFisica":{"sexo":"MASC","numeroCpf":"378549429","digitoCpf":"78","estadoCivil":"CAS","dataNascimento":"1982-08-26","profissao":"493-09/883"},"email":"mussum.forevis@gmail.com","enderecos":[{"uf":"SP","tipoLogradouro":"R","tipoEndereco":"RES","paisResidencia":"BRA","numeroLogradouro":"92","logradouro":"Guaianses","complementoCep":"420","complemento":"Apto 22","cidade":"SAO PAULO","cep":"07114","bairro":"Centro"}]},"coberturas":[{"sigla":"ABC","valor":50000.0},{"sigla":"IEA","percentual":100.0,"garantiaReferenciada":"BAS"},{"sigla":"AFT","valor":3000.0}]}],"nome":"Passageiros até 70 anos","qtdeVidas":1,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]},{"numero":2,"tipoCalculo":"MOVSINT","nome":"Passageiros de 71 a 90 anos","qtdeVidas":0,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]}]}],"canalDistribuicao":"COR","viagem":{"tipoViagem":"NACIONAL","praticaEsportesAventura":false,"destinos":[{"codigo":"DESTINO","pais":"Brasil"}],"utilizaraMotocicleta":false,"passageirosNaoIdosos":1,"passageirosIdosos":0},"meioComercializacao":"CO2","varConsultivo":true,"segmento":"Individual","versoesCalculos":[{"opcao":1,"tipo":"FPG","descontoAgravo":-30},{"opcao":0,"tipo":"FPG","descontoAgravo":-25}],"numeroOferta":1699,"orcnum":"00008730","ordemPortal":1,"rotulo":"Brasil Terra","susepOrcamento":"P5005J","remuneracoes":[{"percentual":25,"tipoRemuneracao":"CORRETAGEM"}],"vigenciaInicial":"2020-04-20","dataCalculo":"2020-04-20"},"retornosCalculo":[{"opcao":1,"precificacao":{"encargos":0,"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}],"contratantes":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"grupos":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"segurados":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.834}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.649863}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.13589}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.633}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.4477}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.7434}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3601}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.1962}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3556}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2019}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}],"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"},{"opcao":0,"precificacao":{"encargos":0,"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}],"contratantes":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"grupos":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"segurados":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.834}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.649863}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.13589}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.633}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.4477}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.7434}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3601}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.1962}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3556}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2019}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}],"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"}],"retornoAceitacao":{"analises":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$400.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PARA ANALISAR","cliente":null,"representante":null}}],"recusas":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"avisos":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"pendencias":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"decisoes":[{"codigo":10055,"descricao":"Risco médio","tipo":"RISCO","acao":"QTNR_Completo"}]},"retornoIntegracoes":{}}]}', EmissaoTO.PayloadTO.class);
        EmissaoTO.TaxaTO taxa = new EmissaoTO.TaxaTO();
        taxa.pura = 100;
        taxa.mensal = 150;
        taxa.anual = 1800;
        taxa.puroInterno = 90;
        taxa.puroResseguro = 80;
        taxa.comercial = 120;
        taxa.total = 2500;
        for(EmissaoTO.OfertasTO oferta : payloadTO.ofertas){
            oferta.orcamento.vigenciaInicial = String.valueOf(System.today().addDays(1));
            oferta.orcamento.vigenciaFinal = String.valueOf(System.today().addDays(2));
            oferta.orcamento.dataCalculo = String.valueOf(system.today().addDays(1));
            oferta.orcamento.codigoProdutoVida = 'VI-PESSOAS'; //PLV-5331 INICIO/FIM
            oferta.orcamento.IdProdutoSf = produtoComercial.Id; //PLV-5331 INICIO/FIM
            EmissaoTO.TipoEndossoTO tiposEndosso = new EmissaoTO.TipoEndossoTO();
            tiposEndosso.cad = true;
            oferta.orcamento.tiposEndosso = tiposEndosso;
            EmissaoTO contratoOriginal = new EmissaoTO();
            contratoOriginal.remuneracoes = oferta.orcamento.remuneracoes;
            oferta.orcamento.contratoOriginal = contratoOriginal;
            for(EmissaoTO.ContratanteTO contratante :oferta.orcamento.contratantes){
                contratante.manterPlanoParcelamento = true;
            }
            for(EmissaoTO.RetornoCalculoTO retornoCalculo : oferta.retornosCalculo){
                EmissaoTO.PrecificacaoTO precificacao = retornoCalculo.precificacao;
                precificacao.taxa = taxa;
                for(EmissaoTO.ContratanteTO contratante : precificacao.contratantes){
                    contratante.taxa = taxa;
                    for(EmissaoTO.GrupoTO grupo : contratante.grupos){
                        grupo.taxa = taxa;
                        for(EmissaoTO.SeguradoTO segurado : grupo.segurados){
                            segurado.taxa = taxa;
                        }
                    }
                }
            } 
        }
        GravarOrcamentoRest.Request rs = new GravarOrcamentoRest.Request();
        rs.ofertas = payloadTO.ofertas;
        rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.profissao = null;
		rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.dataNascimento = '1949-01-01';

        Test.StartTest();
        GravarOrcamentoService gravarOrcamento = new GravarOrcamentoService(rs);        
        ServiceTO.PayRetornoOfertasTO ofertaRetorno = gravarOrcamento.getcomplemento();
        Test.StopTest();
        for(ServiceTO.OfertaTO  oferta: ofertaRetorno.ofertas){
            for(ServiceTO.ParcelamentoTO parcelamento : oferta.parcelamentos){
                System.assertEquals(parcelamento.juros, 0);
                System.assertEquals(parcelamento.iof, 0);
                System.assertEquals(parcelamento.encargos, 0);
            }
        }
        
    }
    //PLV-5066 - FIM
    //RVI-240 - INICIO
    @isTest 
    public static void getComplementoTestParcelamentoTrue2(){

        Account contaPF = (Account) new AccountFactory.PessoaFisica().createRecord();

        ContadorCodigo__c contadorTec = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoTecnico().createRecord();
        ContadorCodigo__c contadorCom = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoComercial().createRecord();        

        Product2 produtoTecnico = (Product2) new produtoFactory.ProdutoTecnico().createRecord();
        produtoTecnico.Status__c = 'Em ativação';
		produtoTecnico.NumeroSusep__c = '123';
		produtoTecnico.VersaoRenovacao__c = 'Versão atual';
        update produtoTecnico;
		produtoTecnico.Status__c = 'Ativo';
		update produtoTecnico;

        Product2 produtoComercial = (Product2) new ProdutoFactory.produtoComercial(produtoTecnico).createRecord();
        produtoComercial.VigenciaFinal__c = System.today().addDays(3);
        produtoComercial.status__c = 'Ativo';         
        produtoComercial.CodigoPrecificaProduto__c = 'VI-PESSOAS';
        produtoComercial.ProductCode = 'VI-PESSOAS';        
        update produtoComercial;        
        
        CanalDistribuicao__c canalDist = (CanalDistribuicao__c) new CanalDistribuicaoFactory().createRecord();
        canalDist.sigla__c = 'COR';
        update canalDist;

        ProdutoCanal__c produtoCanal = new ProdutoCanal__c(
                CanalDistribuicao__c = canalDist.Id,
                Produto__c = produtoComercial.Id
        );
        insert produtoCanal;

        TipoRemuneracao__c tipoRemuneracao = (TipoRemuneracao__c) new TipoRemuneracaoFactory().createRecord();
        tipoRemuneracao.name = 'CORRETAGEM';
        update tipoRemuneracao;
        
        RemuneracaoProduto__c remuneracaoProduto = (RemuneracaoProduto__c) new RemuneracaoProdutoFactory(tipoRemuneracao, produtoComercial).createRecord();
        remuneracaoProduto.Produto__c = produtoCanal.produto__c;
        remuneracaoProduto.TipoRemuneracao__c = tipoRemuneracao.Id;
        remuneracaoProduto.LimiteMinimo__c = 1;
        remuneracaoProduto.LimiteMaximo__c = 45;
        update remuneracaoProduto;
        
        RemuneracaoCanal__c remuneracaoCanal = new RemuneracaoCanal__c(
                ProdutoCanal__c = produtoCanal.Id,
                TipoRemuneracao__c = tipoRemuneracao.Id,
                LimiteMinimo__c = 1,
                LimiteMaximo__c = 45
        );
        insert remuneracaoCanal;

        FormaPagamento__c formaPagamento = new FormaPagamento__c();
        formaPagamento.Codigo__c = '4325';
        formaPagamento.Name = 'testeX';
        insert formaPagamento;

        PremioMinimoProduto__c PremioMin = new PremioMinimoProduto__c();
        PremioMin.PremioMinimoParcela__c = 25;
        PremioMin.Produto__c = produtoComercial.Id;
        PremioMin.PeriodicidadePagamento__c = 'Anual';
        PremioMin.TipoContratacao__c = 'Novo';
        PremioMin.ValidarRegrasProdutoComercial__c = false;
        PremioMin.FormaPagamento__c = formaPagamento.Id;
        insert PremioMin;
        
        CondicaoCobranca__c condicaoCobranca = new CondicaoCobranca__c();
        condicaoCobranca.TipoPagamento__c = 'Boleto';
        condicaoCobranca.QuantidadeParcelas__c = '12';
        condicaoCobranca.PercentualDescontoAgravo__c = 6;
        condicaoCobranca.Produto__c = produtoComercial.Id;
        condicaoCobranca.FormaPagamento__c = formaPagamento.Id;
        condicaoCobranca.NomeFormaPagamento__c = 'Boleto bancário';
        condicaoCobranca.PercentualDescontoAgravo__c = -30;
        insert condicaoCobranca;

        PlanoParcelamento__c planoParcelamento = new PlanoParcelamento__c(
                CodigoMeioRecebimento__c = '1234',
                DescricaoMeioRecebimento__c = 'RECEBIMENTO-BOLETO REGISTRADO',
                FormaPagamento__c = formaPagamento.id,
                NumeroParcela__c = 2     
        );
        insert planoParcelamento;

        PlanoParcelamento__c planoParcelamento2 = new PlanoParcelamento__c(
                CodigoMeioRecebimento__c = '1234',
                DescricaoMeioRecebimento__c = 'RECEBIMENTO-BOLETO REGISTRADO',
                FormaPagamento__c = formaPagamento.id,
                NumeroParcela__c = 2     
        );

        insert planoParcelamento2;

        ParametroVigencia__c parametroTec = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaTecnico(produtoTecnico).createRecord(); 
        parametroTec.ParcelamentoAposFinalVigencia__c = true;
        update parametroTec;
        ParametroVigencia__c parametroCom = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaComercial(produtoComercial).createRecord(); 
        parametroCom.ParcelamentoAposFinalVigencia__c = true;
        update parametroCom;

        RamoSeguro__c ramoSegurado = (RamoSeguro__c) new RamoSeguroFactory().createRecord();
        Garantia__c garantia = (garantia__c) new GarantiaFactory().createRecord();
        garantia.Sigla__c = 'MAP';
        garantia.TipoEvento__c = 'Acidente';
        update garantia;

        RamoGarantia__c ramoGarantia = (RamoGarantia__c) new RamoGarantiaFactory(garantia, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoTEC = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoTec(garantia, produtoTecnico, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoCom = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoCom(produtoComercial, garantia, garantiaProdutoTEC, ramoSegurado).createRecord();        

        Opportunity orcamento1 = (Opportunity) new OrcamentoFactory.VidaIndividual(produtoComercial, contaPF).createRecord();        
        orcamento1.numero__c = '00008730';        
        update orcamento1;        

        List<Opportunity> listOrcamento = [SELECT Id, Name, Numero__c 
                                            FROM Opportunity 
                                            WHERE Numero__c IN ('00008730')];

        system.debug('listOrcamento:' + listOrcamento);        
       
        EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize('{"ofertas":[{"orcamento":{"tipoVigencia":"Determinado","tipoSeguro":"Novo","vigenciaFinal":"2020-05-09","numeroOrcamento":"00008730","numeroPortal":0,"codigoProdutoVida":"VI-PESSOAS","codigoEmpresa":1,"idProdutoSf":"'+produtoComercial.Id+'","contratantes":[{"tipo":"PRI","numero":1,"grupos":[{"numero":1,"tipoCalculo":"MOVSINT","segurados":[{"numero":1,"pessoa":{"tipo":"FIS","nome":"DOUGLAS DOMICIANO GANSO","dadosPessoaFisica":{"sexo":"MASC","numeroCpf":"378549429","digitoCpf":"78","estadoCivil":"CAS","dataNascimento":"1982-08-26","profissao":"493-09/883"},"email":"mussum.forevis@gmail.com","enderecos":[{"uf":"SP","tipoLogradouro":"R","tipoEndereco":"RES","paisResidencia":"BRA","numeroLogradouro":"92","logradouro":"Guaianses","complementoCep":"420","complemento":"Apto 22","cidade":"SAO PAULO","cep":"07114","bairro":"Centro"}]},"coberturas":[{"sigla":"ABC","valor":50000.0},{"sigla":"IEA","percentual":100.0,"garantiaReferenciada":"BAS"},{"sigla":"AFT","valor":3000.0}]}],"nome":"Passageiros até 70 anos","qtdeVidas":1,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]},{"numero":2,"tipoCalculo":"MOVSINT","nome":"Passageiros de 71 a 90 anos","qtdeVidas":0,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]}]}],"canalDistribuicao":"COR","viagem":{"tipoViagem":"NACIONAL","praticaEsportesAventura":false,"destinos":[{"codigo":"DESTINO","pais":"Brasil"}],"utilizaraMotocicleta":false,"passageirosNaoIdosos":1,"passageirosIdosos":0},"meioComercializacao":"CO2","varConsultivo":true,"segmento":"Individual","versoesCalculos":[{"opcao":1,"tipo":"FPG","descontoAgravo":-30},{"opcao":0,"tipo":"FPG","descontoAgravo":-25}],"numeroOferta":1699,"orcnum":"00008730","ordemPortal":1,"rotulo":"Brasil Terra","susepOrcamento":"P5005J","remuneracoes":[{"percentual":25,"tipoRemuneracao":"CORRETAGEM"}],"vigenciaInicial":"2020-04-20","dataCalculo":"2020-04-20"},"retornosCalculo":[{"opcao":1,"precificacao":{"encargos":0,"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"premio":{"comercial":70.39,"total":12000.45,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}],"contratantes":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"grupos":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"segurados":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.834}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.649863}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.13589}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.633}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.4477}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.7434}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3601}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.1962}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3556}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2019}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}],"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"},{"opcao":0,"precificacao":{"encargos":0,"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}],"contratantes":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"grupos":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"segurados":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.834}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.649863}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.13589}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.633}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.4477}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.7434}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3601}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.1962}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3556}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2019}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}],"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"}],"retornoAceitacao":{"analises":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$400.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PARA ANALISAR","cliente":null,"representante":null}}],"recusas":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"avisos":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"pendencias":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"decisoes":[{"codigo":10055,"descricao":"Risco médio","tipo":"RISCO","acao":"QTNR_Completo"}]},"retornoIntegracoes":{}}]}', EmissaoTO.PayloadTO.class);

        for(EmissaoTO.OfertasTO oferta : payloadTO.ofertas){
            oferta.orcamento.vigenciaInicial = String.valueOf(System.today().addDays(1));
            oferta.orcamento.vigenciaFinal = String.valueOf(System.today().addDays(2));
            oferta.orcamento.dataCalculo = String.valueOf(system.today().addDays(1));
            oferta.orcamento.codigoProdutoVida = 'VI-PESSOAS'; 
            oferta.orcamento.IdProdutoSf = produtoComercial.Id; 
        }

        GravarOrcamentoRest.Request rs = new GravarOrcamentoRest.Request();
        rs.ofertas = payloadTO.ofertas;        
        rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.profissao = null;        

        Test.StartTest();
        GravarOrcamentoService gravarOrcamento = new GravarOrcamentoService(rs);
        gravarOrcamento.getcomplemento();
        Test.StopTest();
    }
    //RVI-240 - FIM
    //FNPVVEP-83 INICIO
    /*@isTest //ANNVI-55 - INICIO
    public static void getComplementoTestParcelamentoFalseEndosso(){
        
        Account contaPF = (Account) new AccountFactory.PessoaFisica().createRecord();

        ContadorCodigo__c contadorTec = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoTecnico().createRecord();
        ContadorCodigo__c contadorCom = (ContadorCodigo__c) new ContadorCodigoFactory.ProdutoComercial().createRecord();

        Product2 produtoTecnico = (Product2) new produtoFactory.ProdutoTecnico().createRecord();
        produtoTecnico.Status__c = 'Em ativação';
		produtoTecnico.NumeroSusep__c = '123';
		produtoTecnico.VersaoRenovacao__c = 'Versão atual';
        update produtoTecnico;
		produtoTecnico.Status__c = 'Ativo';
		update produtoTecnico;

        Product2 produtoComercial = (Product2) new ProdutoFactory.produtoComercial(produtoTecnico).createRecord();
        produtoComercial.VigenciaFinal__c = System.today().addDays(3);
        produtoComercial.status__c = 'Ativo'; 
        produtoComercial.CodigoPrecificaProduto__c = 'VI-PESSOAS';
        produtoComercial.ProductCode = 'VI-PESSOAS';
        update produtoComercial;

        CanalDistribuicao__c canalDist = (CanalDistribuicao__c) new CanalDistribuicaoFactory().createRecord();
        canalDist.sigla__c = 'COR';
        update canalDist;

        ProdutoCanal__c produtoCanal = new ProdutoCanal__c(
                CanalDistribuicao__c = canalDist.Id,
                Produto__c = produtoComercial.Id
        );
        insert produtoCanal;

        TipoRemuneracao__c tipoRemuneracao = (TipoRemuneracao__c) new TipoRemuneracaoFactory().createRecord();
        tipoRemuneracao.name = 'CORRETAGEM';
        update tipoRemuneracao;
        
        RemuneracaoProduto__c remuneracaoProduto = (RemuneracaoProduto__c) new RemuneracaoProdutoFactory(tipoRemuneracao, produtoComercial).createRecord();
        remuneracaoProduto.Produto__c = produtoCanal.produto__c;
        remuneracaoProduto.TipoRemuneracao__c = tipoRemuneracao.Id;
        remuneracaoProduto.LimiteMinimo__c = 1;
        remuneracaoProduto.LimiteMaximo__c = 45;
        update remuneracaoProduto;
        
        RemuneracaoCanal__c remuneracaoCanal = new RemuneracaoCanal__c(
                ProdutoCanal__c = produtoCanal.Id,
                TipoRemuneracao__c = tipoRemuneracao.Id,
                LimiteMinimo__c = 1,
                LimiteMaximo__c = 45
        );
        insert remuneracaoCanal;

        FormaPagamento__c formaPagamento = (FormaPagamento__c) new FormaPagamentoFactory().createRecord();
        
        CondicaoCobranca__c condicaoCobranca = (CondicaoCobranca__c) new CondicaoCobrancaFactory.CondicaoCobranca(produtoComercial,formaPagamento).createRecord();
        condicaoCobranca.NomeFormaPagamento__c = 'ADC';
        condicaoCobranca.PercentualDescontoAgravo__c = -30;
        update condicaoCobranca;

        PlanoParcelamento__c planoParcelamento = new PlanoParcelamento__c(
                CodigoMeioRecebimento__c = '1234',
                DescricaoMeioRecebimento__c = 'RECEBIMENTO-BOLETO REGISTRADO',
                FormaPagamento__c = formaPagamento.id,
                NumeroParcela__c = 1               
        );

        insert planoParcelamento;

        ParametroVigencia__c parametroTec = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaTecnico(produtoTecnico).createRecord(); 
        parametroTec.ParcelamentoAposFinalVigencia__c = false;
        update parametroTec;
        ParametroVigencia__c parametroCom = (ParametroVigencia__c) new ParametroVigenciaFactory.ParametroVigenciaComercial(produtoComercial).createRecord(); 
        parametroCom.ParcelamentoAposFinalVigencia__c = false;
        update parametroCom;

        RamoSeguro__c ramoSegurado = (RamoSeguro__c) new RamoSeguroFactory().createRecord();
        Garantia__c garantia = (garantia__c) new GarantiaFactory().createRecord();
        garantia.Sigla__c = 'MAP';
        garantia.TipoEvento__c = 'Acidente';
        update garantia;

        RamoGarantia__c ramoGarantia = (RamoGarantia__c) new RamoGarantiaFactory(garantia, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoTEC = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoTec(garantia, produtoTecnico, ramoSegurado).createRecord();
        GarantiaProduto__c garantiaProdutoCom = (GarantiaProduto__c) new GarantiaProdutoFactory.GarantiaProdutoCom(produtoComercial, garantia, garantiaProdutoTEC, ramoSegurado).createRecord();
        

        Opportunity orcamento1 = (Opportunity) new OrcamentoFactory.VidaIndividual(produtoComercial, contaPF).createRecord();        
        orcamento1.numero__c = '00008730';
        update orcamento1;
        
        List<Opportunity> listOrcamento = [SELECT Id, Name, Numero__c 
                                            FROM Opportunity 
                                            WHERE Numero__c IN ('00008730')];

        system.debug('listOrcamento:' + listOrcamento); 

        EmissaoTO.PayloadTO payloadTO = (EmissaoTO.PayloadTO) JSON.deserialize('{"ofertas":[{"orcamento":{"tipoVigencia":"Determinado","tipoSeguro":"eds","vigenciaFinal":"2020-05-09","numeroOrcamento":"00008730","numeroPortal":0,"codigoProdutoVida":"VI-PESSOAS","idProdutoSf":"'+produtoComercial.Id+'","contratantes":[{"tipo":"PRI","numero":1,"grupos":[{"numero":1,"tipoCalculo":"MOVSINT","segurados":[{"numero":1,"pessoa":{"tipo":"FIS","nome":"DOUGLAS DOMICIANO GANSO","dadosPessoaFisica":{"sexo":"MASC","numeroCpf":"378549429","digitoCpf":"78","estadoCivil":"CAS","dataNascimento":"1982-08-26","profissao":"493-09/883"},"email":"mussum.forevis@gmail.com","enderecos":[{"uf":"SP","tipoLogradouro":"R","tipoEndereco":"RES","paisResidencia":"BRA","numeroLogradouro":"92","logradouro":"Guaianses","complementoCep":"420","complemento":"Apto 22","cidade":"SAO PAULO","cep":"07114","bairro":"Centro"}]},"coberturas":[{"sigla":"ABC","valor":50000.0},{"sigla":"IEA","percentual":100.0,"garantiaReferenciada":"BAS"},{"sigla":"AFT","valor":3000.0}]}],"nome":"Passageiros até 70 anos","qtdeVidas":1,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]},{"numero":2,"tipoCalculo":"MOVSINT","nome":"Passageiros de 71 a 90 anos","qtdeVidas":0,"coberturas":[{"sigla":"DMHO","valor":10000},{"sigla":"MAP","valor":50000},{"sigla":"IPTA","valor":15000},{"sigla":"AFI","valor":12000},{"sigla":"HAH","valor":11000},{"sigla":"HAHP","valor":14000},{"sigla":"AHP","valor":5000},{"sigla":"TC","valor":10000},{"sigla":"TM","valor":15000},{"sigla":"RPR","valor":2000},{"sigla":"AM","valor":4000},{"sigla":"RMF","valor":8000},{"sigla":"EVRM","valor":null},{"sigla":"OEPD","valor":null},{"sigla":"TMU","valor":null},{"sigla":"RS","valor":20000},{"sigla":"PVB","valor":null}]}]}],"canalDistribuicao":"COR","viagem":{"tipoViagem":"NACIONAL","praticaEsportesAventura":false,"destinos":[{"codigo":"DESTINO","pais":"Brasil"}],"utilizaraMotocicleta":false,"passageirosNaoIdosos":1,"passageirosIdosos":0},"meioComercializacao":"CO2","varConsultivo":true,"segmento":"Individual","versoesCalculos":[{"opcao":1,"tipo":"FPG","descontoAgravo":-30},{"opcao":0,"tipo":"FPG","descontoAgravo":-25}],"numeroOferta":1699,"orcnum":"00008730","ordemPortal":1,"rotulo":"Brasil Terra","susepOrcamento":"P5005J","remuneracoes":[{"percentual":25,"tipoRemuneracao":"CORRETAGEM"}],"vigenciaInicial":"2020-04-20","dataCalculo":"2020-04-20"},"retornosCalculo":[{"opcao":1,"precificacao":{"encargos":0,"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}],"contratantes":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"grupos":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"segurados":[{"iof":0.13,"descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-17.29}],"numero":1,"premio":{"comercial":40.49,"total":40.62,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.834}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.649863}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.13589}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.633}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.4477}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.7434}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3601}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.1962}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.3556}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2019}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.7897}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003325,"pura":0.000173658,"total":0.003337635},"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"taxa":{"comercial":0.0000205,"pura":0.0000010684,"total":0.000020625},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"taxa":{"comercial":0.000001,"pura":5.47e-8,"total":0.0000010038},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"taxa":{"comercial":0.0000195,"pura":0,"total":0.0000195741},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"taxa":{"comercial":0.000014,"pura":7.221e-7,"total":0.0000140532},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"taxa":{"comercial":0.000054,"pura":1e-10,"total":0.0000542052},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"taxa":{"comercial":0.000044,"pura":4e-10,"total":0.0000441672},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.0012,"pura":6.329e-7,"total":0.00120456},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"taxa":{"comercial":0.0022,"pura":0.0000011473,"total":0.00220836},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0002466666,"pura":4.3e-9,"total":0.000247604},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"taxa":{"comercial":0.00037,"pura":6.4e-9,"total":0.000371406},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"taxa":{"comercial":0.0000833333,"pura":1.4e-9,"total":0.00008365},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}],"coberturas":[{"iof":0.12,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-14.25}],"premio":{"comercial":33.25,"total":33.37,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.7}],"premio":{"comercial":1.64,"total":1.65,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.03}],"premio":{"comercial":0.08,"total":0.08,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.16}],"premio":{"comercial":0.39,"total":0.39,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.11}],"premio":{"comercial":0.28,"total":0.28,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.46}],"premio":{"comercial":1.08,"total":1.08,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.05}],"premio":{"comercial":0.12,"total":0.12,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.09}],"premio":{"comercial":0.22,"total":0.22,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.31}],"premio":{"comercial":0.74,"total":0.74,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.47}],"premio":{"comercial":1.11,"total":1.11,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-30,"monetario":-0.1}],"premio":{"comercial":0.25,"total":0.25,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"},{"opcao":0,"precificacao":{"encargos":0,"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"custoDeApolice":0,"juros":0,"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}],"contratantes":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"grupos":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"segurados":[{"iof":0.14,"descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-14.4}],"numero":1,"premio":{"comercial":43.38,"total":43.52,"puro":65.54},"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.834}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.649863}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.13589}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.633}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.4477}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.7434}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3601}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.1962}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.3556}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2019}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.7897}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.4065}}]}],"coberturas":[{"taxa":{"comercial":0.003563,"pura":0.000173658,"total":0.0035765394},"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"taxa":{"comercial":0.000021875,"pura":0.0000010684,"total":0.000022},"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"taxa":{"comercial":0.000001125,"pura":5.47e-8,"total":0.0000011292},"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"taxa":{"comercial":0.000021,"pura":0,"total":0.0000210798},"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"taxa":{"comercial":0.000015,"pura":7.221e-7,"total":0.000015057},"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"taxa":{"comercial":0.0000575,"pura":1e-10,"total":0.0000577185},"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"taxa":{"comercial":0.000048,"pura":4e-10,"total":0.0000481824},"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0013,"pura":6.329e-7,"total":0.00130494},"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"taxa":{"comercial":0.0024,"pura":0.0000011473,"total":0.00240912},"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.0002666666,"pura":4.3e-9,"total":0.00026768},"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"taxa":{"comercial":0.0003933333,"pura":6.4e-9,"total":0.000394828},"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"taxa":{"comercial":0.00009,"pura":1.4e-9,"total":0.000090342},"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}],"coberturas":[{"iof":0.13,"sigla":"DMHO","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-11.87}],"premio":{"comercial":35.63,"total":35.76,"puro":53.83}},{"iof":0.01,"sigla":"MAP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.58}],"premio":{"comercial":1.75,"total":1.76,"puro":2.65}},{"iof":0,"sigla":"IPA","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.03}],"premio":{"comercial":0.09,"total":0.09,"puro":0.14}},{"iof":0,"sigla":"TC","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.14}],"premio":{"comercial":0.42,"total":0.42,"puro":0.63}},{"iof":0,"sigla":"TM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.3,"total":0.3,"puro":0.45}},{"iof":0,"sigla":"RS","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.38}],"premio":{"comercial":1.15,"total":1.15,"puro":1.74}},{"iof":0,"sigla":"AFI","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"HAH","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.04}],"premio":{"comercial":0.13,"total":0.13,"puro":0.2}},{"iof":0,"sigla":"HAHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.07}],"premio":{"comercial":0.24,"total":0.24,"puro":0.36}},{"iof":0,"sigla":"RPR","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"RMF","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.26}],"premio":{"comercial":0.8,"total":0.8,"puro":1.2}},{"iof":0,"sigla":"AHP","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.39}],"premio":{"comercial":1.18,"total":1.18,"puro":1.79}},{"iof":0,"sigla":"AM","descontoAgravo":[{"tipo":"FPG","percentual":-25,"monetario":-0.09}],"premio":{"comercial":0.27,"total":0.27,"puro":0.41}}]}]},"numeroOrcamento":"00008730","numeroOferta":1699,"orcnum":"00008730"}],"retornoAceitacao":{"analises":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$400.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PARA ANALISAR","cliente":null,"representante":null}}],"recusas":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"avisos":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"pendencias":[{"severidade":null,"codigo":4,"descricao":"Capital da Cobertura superior a R$200.000,00","area":"UNI","procedimento":"","mensagens":{"interna":"PERMITIDO","cliente":null,"representante":null}}],"decisoes":[{"codigo":10055,"descricao":"Risco médio","tipo":"RISCO","acao":"QTNR_Completo"}]},"retornoIntegracoes":{}}]}', EmissaoTO.PayloadTO.class);

        Contract ctrOrig = new Contract(
            AlteraFormaPagto__c = false,
            AccountId = (Id) contaPF.Id,
            Oportunidade__c = (Id) orcamento1.Id,
            Origem__c = '18',
            NumeroProposta__c = '00006767',
            NumeroApolice__c = '000014419',
            Tipo__c = 'Novo',
            Status = 'Emitido',
            Endosso__c = '0',
            PremioTotal__c = 1300.00,
            VigenciaFinal__c = System.today().addDays(30),
            StatusRenovacao__c = 'Não Renovado',
            CodigoRamo__c = '1391',
            Produto__c = (Id) produtoComercial.id,
            ApolicePdfDownloadUrl__c = 'https://MestreChico.com',
            Empresa__c = '1',
            Sucursal__c = '1',
            Name = '1-1-1391-000014419-0'
        );
        insert ctrOrig;
        EmissaoTO.OfertasTO ofertateste = new EmissaoTO.OfertasTO();
        for (EmissaoTO.OfertasTO oferta : payloadTO.ofertas) {
            oferta.orcamento.vigenciaInicial = String.valueOf(System.today().addDays(1));
            oferta.orcamento.vigenciaFinal = String.valueOf(System.today().addDays(2));
            oferta.orcamento.dataCalculo = String.valueOf(System.today().addDays(1));
            oferta.orcamento.codigoProdutoVida = 'VI-PESSOAS'; 
            oferta.orcamento.IdProdutoSf = produtoComercial.Id; 
            EmissaoTO contratoOriginal = new EmissaoTO();
            contratoOriginal.vigenciaInicial = String.valueOf(System.today().addDays(1));
            contratoOriginal.vigenciaFinal = String.valueOf(System.today().addDays(2));
            contratoOriginal.remuneracoes = oferta.orcamento.remuneracoes;
            contratoOriginal.empresa = ctrOrig.Empresa__c;
            contratoOriginal.sucursal =  Integer.valueOf(ctrOrig.Sucursal__c);
            contratoOriginal.ramo =  Integer.valueOf(ctrOrig.CodigoRamo__c);
            contratoOriginal.apolice = ctrOrig.NumeroApolice__c;
            contratoOriginal.endosso = ctrOrig.Endosso__c;
            oferta.orcamento.contratoOriginal = contratoOriginal;
            ofertateste = oferta;
        }

        GravarOrcamentoRest.Request rs = new GravarOrcamentoRest.Request();
        rs.ofertas = payloadTO.ofertas;
        rs.ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.profissao = null;
		
        ServiceTO.ParcelamentoTO parcelamento = new ServiceTO.ParcelamentoTO();
        parcelamento.idFormaPagamento = 'condicao.FormaPagamento__c';
        parcelamento.juros = 10;
        parcelamento.iof = 10;
        parcelamento.encargos = 10;
        parcelamento.custoapolice = 0;
        parcelamento.descricao = 'condicao.FormaPagamento__r.Name';
        parcelamento.nomeFormaPagamento = 'condicao.NomeFormaPagamento__c';
        parcelamento.codigo = 10;
        parcelamento.agrupamento = 'condicao.TipoPagamento__c';
        parcelamento.descontoAgravo = 10;
        parcelamento.opcao = 10;
        parcelamento.antecipacaoComissao = true;
        Test.StartTest();
        GravarOrcamentoService gravarOrcamento = new GravarOrcamentoService(rs);
        gravarOrcamento.getcomplemento();
        Test.StopTest();
    }*/ //ANNVI-55 - FIM
    //FNPVVEP-83 FIM
}
//PLV-3649 - INICIO - Performance - Gravar Orçamentos