function checkBirthdate(e){if(""!=e){let t=new Date(e.split("/").reverse().join("-"));if(isNaN(t.getTime()))return"Data inválida.";if(t>new Date((new Date).toISOString().slice(0,10)))return"A data de nascimento não pode ser posterior à data de hoje."}return""}function birthdateChangeHandle(e){let t=checkBirthdate(e.target.value);e.target.classList.remove("invalid");let a=e.target.parentElement.querySelector("span.helper-text");a&&(a.dataset.error=t),""!=t&&e.target.classList.add("invalid")}
function initializeDatePicker(){const e=document.querySelectorAll(".datepicker");let t={format:"dd/mm/yyyy",language:"pt-BR",i18n:{weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],weekdaysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],weekdaysAbbrev:["D","S","T","Q","Q","S","S"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],cancel:"Cancelar",clear:"Limpar",done:"Ok"}};for(const l of e){var a=t,n=new Date((new Date).toISOString().slice(0,10));if("true"==l.getAttribute("data-block-future")&&(a.maxDate=n),l.getAttribute("data-default-date")){let e=l.getAttribute("data-default-date").replace("GMT","");a.defaultDate=new Date(e),a.setDefaultDate=!0}M.Datepicker.init(l,a),l.name.includes("birth")&&l.addEventListener("change",birthdateChangeHandle),VMasker(l).maskPattern("99/99/9999")}}function initializeDate(){const e=document.querySelectorAll(".date");function t(e){return e>9?e:"0"+e}for(const a of e)if(a.getAttribute("data-default-date")){let e=a.getAttribute("data-default-date").replace("GMT","");if(e){let n=new Date(e),l=t(n.getDate()),i=t(n.getMonth()+1),r=n.getFullYear();a.value=`${l}${i}${r}`}VMasker(a).maskPattern("99/99/9999"),a.addEventListener("change",birthdateChangeHandle)}}function initializeAutocomplete(){M.Autocomplete.init(document.querySelectorAll(".autocomplete"),{})}function initializeCollapsible(){M.Collapsible.init(document.querySelectorAll(".collapsible"),{})}function initializeSelecteds(){let e=document.querySelectorAll("select");for(const e of document.querySelectorAll("select")){let t=e.querySelectorAll("option[aria-selected=true]");t.length>0&&t[t.length-1].setAttribute("selected","")}M.FormSelect.init(e,{})}function initGarantiaEtapa1Personal(e){let t=document.querySelectorAll(".etapa1 [data-garantia-personalization]"),a={precision:2,separator:",",zeroCents:!1};for(let s of t){let t=s.querySelector(".switch input"),p=s.querySelector("input[type=number]"),g=s.querySelector("input[type=range]"),m=s.getAttribute("data-default-value")?parseFloat(s.getAttribute("data-default-value")).toFixed(2):null,f=s.getAttribute("data-capital-min")?parseFloat(s.getAttribute("data-capital-min")).toFixed(2):null,b=s.getAttribute("data-capital-max")?parseFloat(s.getAttribute("data-capital-max")).toFixed(2):null;function n(){"true"==t.getAttribute("data-switch-required")?(t.disabled=!0,t.checked=!0):(t.checked="true"==t.getAttribute("data-switch-checked"),t.addEventListener("change",i))}function l(){if(p.disabled=f==b,p.addEventListener("change",r),f==b)g.parentElement.innerHTML="",g=null;else{g.addEventListener("change",o);let e=g.parentElement.parentElement.querySelectorAll("span"),t=e[0],n=e[e.length-1];t&&(t.innerHTML="R$ "+VMasker.toMoney(f,a)),n&&(n.innerHTML="R$ "+VMasker.toMoney(b,a))}}function i(e){e.target.checked?c():u()}function r(e){d(e.target.value),g.value=e.target.value}function o(e){d(e.target.value)}function u(){p&&(p.disabled=!0,p.value=0),g&&(g.disabled=!0,g.value=0)}function c(){p&&(p.disabled=!1,d(m)),g&&(g.disabled=!1,g.value=m)}function d(e){e=parseFloat(e);let t=parseFloat(f),a=parseFloat(b);p.value=t>e?t.toFixed(2):e>a?a.toFixed(2):e.toFixed(2)}(!e||t&&p&&g&&!m&&!f&&!b)&&(n(),parseFloat(b)>0?l():(p.parentElement.innerHTML="",p=null,g.parentElement.innerHTML="",g=null),1==t.checked?c():u())}}function initializePercentInput(){const e=document.querySelectorAll("input[data-input-type=decimal]");for(const n of e){let e=parseFloat(n.getAttribute("data-minimum-value")),l=parseFloat(n.getAttribute("data-maximum-value")),i=n.value;function t(e){a(e.target.value)}function a(t){try{t=parseFloat(t)}catch(a){t=e}t<e||!t?t=e:t>l&&(t=l),t<10&&(t="0"+t),1==(t=VMasker.toPattern(t,"99.99")).split(".").length?n.value=t+".00":((t=t.split("."))[1]=1==t[1].length?t[1]+"0":t[1],n.value=t.join("."))}a(i&&""!=i?i:e),VMasker(n).maskPattern("99.99"),(e||l)&&n.addEventListener("change",t)}}
function setProfessionData(){let o=window.localStorage.getItem("jsonServicos");o=null!=o?JSON.parse(o):{};let e=document.querySelector("#etapa1-profession"),t=document.getElementById("jsonProfessionsData"),s=[],a=[];if(t.value&&(a=JSON.parse(t.value)),!o.DICIO_PROFISSAO){let e={DICIO_PROFISSAO:{}};e.DICIO_PROFISSAO.itens=[];for(let o in a)e.DICIO_PROFISSAO.itens.push({rotulo:a[o].NomeFantasia__c,codigo:a[o].CodigoProfissao__c});o=Object.assign(o,e),window.localStorage.setItem("jsonServicos",JSON.stringify(o))}for(const o of a)s[o.NomeFantasia__c]=null;M.Autocomplete.init(e,{data:s,limit:3})}
function showToast(s={message:null,title:null,type:"success"}){null!=s.message&&sforce.one.showToast({...s})}
document.addEventListener("DOMContentLoaded",()=>{document.querySelector("#etapa1-dataEndosso").setAttribute("data-default-date",new Date),initializeAutocomplete(),initializeCollapsible(),initializeDatePicker(),initializeDate(),initializeSelecteds(),initGarantiaEtapa1Personal(),initializePercentInput(),callServicos(),getFromStorage()});
function setLoader(){let e=document.querySelector(".modalLoaderErro");e.classList.add("on"),e.querySelector(".loader").classList.remove("hidden"),e.querySelector(".message").classList.add("hidden")}function removeLoader(){let e=document.querySelector(".modalLoaderErro");e.classList.remove("on"),e.querySelector(".loader").classList.add("hidden")}function getDataEtapa1(){let e=g(document.getElementById("etapa1-name"),"Erro ao recuperar informação: nome do segurado","Informe o nome do segurado"),o=function(){let e=document.getElementById("etapa1-birthdate");if(!e)return showToast({type:"error",message:"Erro ao recuperar informação: data de nascimento do segurado"}),null;let o=e.value;if(!o||""==o)return e.classList.add("invalid"),showToast({type:"error",message:"Informe a data de nascimento do segurado"});let a=checkBirthdate(o);if("Data inválida."==a)return showToast({type:"error",message:"Data de nascimento inválida"});if("A data de nascimento não pode ser posterior à data de hoje."==a)return showToast({type:"error",message:"A data de nascimento do segurado não pode ser posterior à data de hoje"});return new Date(o.split("/").reverse().join("-"))}(),a=function(){let e=document.getElementById("etapa1-dataEndosso");if(!e)return showToast({type:"error",message:"Erro ao recuperar informação: Data de Endosso"}),null;let o=e.value;if(!o||""==o)return e.classList.add("invalid"),showToast({type:"error",message:"Informe a data de Endosso"});if("Data inválida."==checkBirthdate(o))return showToast({type:"error",message:"Data de Endosso inválida"});return new Date(o.split("/").reverse().join("-"))}(),t=p(document.getElementById("etapa1-sex"),["FEM","MASC"],"Erro ao recuperar informaçao: sexo do segurado","Informe o sexo do segurado"),r=p(document.getElementById("etapa1-smoker"),["Não","Sim"],"Erro ao recuperar informação: Fumante","Informe se segurado é fumante");null!=r&&(r="Sim"==r);let i=document.getElementById("jsonProfessionsData"),n=[];i.value&&(n=JSON.parse(i.value));let c=g(document.getElementById("etapa1-profession"),"Erro ao recuperar informação: profissão do segurado","Informe a profissão do segurado");for(let e in n)n[e].NomeFantasia__c==c&&(c=n[e].CodigoProfissao__c||null);let l=isAPTLMKT()?document.getElementById("renda-aptlmkt").value:p(document.getElementById("etapa1-income"),["2500","4000","8000","12000","16000","20000","30000","89000"],"Erro ao recuperar informaçao: renda do segurado","Informe a renda do segurado"),d=p(document.getElementById("etapa1-workRegime"),["CLT","PROFISSIONAL_LIBERAL","FUNCIONARIO_PUBLICO"],"Erro ao recuperar informaçao: Forma de trabalho","Informe a forma de trabalho do segurado"),s=g(document.getElementById("etapa1-commission-percentage"),"Erro ao recuperar informação: Percentual da comissão","Informe o percentual da comissão do contrato");s&&(s=parseInt(s));let u=p(document.getElementById("etapa1-cicloVacinal"),["0","1","2","3"],"Erro ao recuperar informaçao: Ciclo Vacinal","Informe o desconto para o segurado");if(!validarCapitaisAPTLMKT())return void showToast({type:"error",message:"Os Capitais de Morte Acidental e Invalidez Permanente Total por Acidente devem ser os mesmos."});if(!function(){if(console.log("validating Data..."),null==e)return!1;if(null==o)return!1;if(null==t)return!1;if(null==c)return!1;if(!isAPTLMKT()){if(0!=r&&1!=r)return!1;if(null==d)return!1;if(null==s)return!1;if(null==l)return!1;if(null==a)return!1;if(null==u)return!1}return!0}())return void showToast({type:"error",message:"Erro ao executar operação"});setStorage("dadosEndossoProposta",{questionario:document.getElementById("questionario").value});const m={nome:e,dataNascimento:o,sexo:t,fumante:r,profissao:c,rendaMensal:l,regimeTrabalho:d,coberturas:function(){let e=[];const o=document.querySelectorAll(".etapa1 .coberturas [data-garantia-personalization]");for(let a of o){let o=a.getAttribute("data-garantia-personalization"),t=a.getAttribute("data-capital-min"),r=(a.getAttribute("data-capital-max"),a.getAttribute("data-coin")),i="true"==a.getAttribute("data-required"),n=a.querySelector('[type="checkbox"]');if(n=!!n&&n.checked,n||i){let i=a.querySelector(`#${o}-capital`);i=parseFloat(i?i.value:t).toFixed(2).toString();let c={sigla:o,valor:i,moeda:r,isActive:n,cotacaoMoeda:"1.0",quantidade:null,cobrado:null};e.push(c)}}return e}(),percentual:s,idContrato:document.getElementById("contractId").value,dataEndosso:a,manterParcelamento:"sim"==document.querySelector("#manterParcelamento:checked").value.toLowerCase(),cicloVacinal:u};function p(e,o,a,t){if(!e)return null;let r=e.parentElement.getElementsByTagName("input")[0];r&&r.classList.remove("invalid");let i=e.value;return i&&""!=i&&o.includes(i)?i:(r&&r.classList.add("invalid"),null)}function g(e,o,a){if(e.classList.remove("invalid"),!e)return e.classList.add("invalid"),null;let t=e.value;return t&&""!=t?t:(e.classList.add("invalid"),null)}setStorage("payload",m),setLoader(),callCalculoEndosso(JSON.stringify(m)),setInterval(()=>{removeLoader(),showToast({type:"error",message:"Tempo limite de redirecionamento atingido"})},12e4)}function setupLocalStorageData(e){let o=JSON.parse(localStorage.getItem("payload")),{nome:a,dataNascimento:t,sexo:r,fumante:i,profissao:n,rendaMensal:c,regimeTrabalho:l,coberturas:d,percentual:s,dataEndosso:u,cicloVacinal:m}=o,p=JSON.parse(document.getElementById("contractCompleto").value),g=JSON.parse(document.getElementById("beneficiarioscontrato").value),_=JSON.parse(document.getElementById("enderecosConta").value),f=JSON.parse(document.getElementById("remuneracoesContrato").value),I=JSON.parse(document.getElementById("dadoscorretores").value),S=p.contractInfo.Account,E=p.seguradoInfo;t=new Date(t.split("/").reverse().join("-")).toISOString().slice(0,10),u=new Date(u.split("/").reverse().join("-")).toISOString().slice(0,10),setStorage("conjuntosJson",{conjuntos:[{regrasSequencia:[{proximoConjunto:2,conteudo:null,operacao:null,idinformacao:null,sequencia:1}],informacoes:[{ordem:1,opcoes:[{ordem:1,rotulo:"Ver sugestões Porto",codigo:"OFERTAS"},{ordem:2,rotulo:"Para você",codigo:"VOCE"},{ordem:3,rotulo:"Personalizar oferta",codigo:"PERSONALIZAR"}],servico:null,obrigatorio:!0,tipo:"Opções fixas",descricao:null,nome:"Tipo do Contrato",id:"TIPOCONTRATO"}],subtitulo:"Para definir a melhor proteção, só precisamos de algumas informações.",titulo:"Encontre a proteção ideal para o seu cliente.",nome:"Tela de opções",id:1},{regrasSequencia:[],informacoes:[{ordem:1,opcoes:[],servico:null,obrigatorio:!0,tipo:"Texto",descricao:null,nome:"Nome Completo",id:"DICIO_NOME"},{ordem:2,opcoes:[],servico:null,obrigatorio:!0,tipo:"Data",descricao:null,nome:"Data de Nascimento",id:"DICIO_DATANASCIMENTO"},{ordem:3,opcoes:[{ordem:1,rotulo:"Feminino",codigo:"FEMININO"},{ordem:2,rotulo:"Masculino",codigo:"MASCULINO"}],servico:null,obrigatorio:!0,tipo:"Opções fixas",descricao:null,nome:"Sexo",id:"DICIO_SEXO"},{ordem:4,opcoes:[{ordem:1,rotulo:"Sim",codigo:"SIM"},{ordem:2,rotulo:"Não",codigo:"NAO"}],servico:null,obrigatorio:!0,tipo:"Opções fixas",descricao:null,nome:"Fumante",id:"DICIO_FUMANTE"},{ordem:5,opcoes:[],servico:"Consulta_Profissao",obrigatorio:!0,tipo:"Opções de servico",descricao:null,nome:"Ocupação Profissional Principal",id:"DICIO_PROFISSAO"},{ordem:6,opcoes:[{ordem:1,rotulo:"CLT",codigo:"CLT"},{ordem:2,rotulo:"Funcionário Público",codigo:"FUNCIONARIO_PUBLICO"},{ordem:3,rotulo:"Profissional Liberal | Autônomo",codigo:"PROFISSIONAL_LIBERAL"}],servico:null,obrigatorio:!0,tipo:"Opções fixas",descricao:null,nome:"Forma de Trabalho",id:"DICIO_REGIME_TRABALHO"},{ordem:7,opcoes:[{ordem:1,rotulo:"Até R$ 2.500,00",codigo:"2500"},{ordem:2,rotulo:"R$ 2.500,01 a R$ 4.000,00",codigo:"4000"},{ordem:3,rotulo:"R$ 4.000,01 a R$ 8.000,00",codigo:"8000"},{ordem:4,rotulo:"R$ 8.000,01 a R$ 12.000,00",codigo:"12000"},{ordem:5,rotulo:"R$ 12.000,01 a R$ 16.000,00",codigo:"16000"},{ordem:7,rotulo:"R$ 16.000,01 a R$ 20.000,00",codigo:"20000"},{ordem:8,rotulo:"R$ 20.000,01 a R$ 30.000,00",codigo:"30000"},{ordem:9,rotulo:"Acima de R$ 30.000,00",codigo:"30001"}],servico:null,obrigatorio:!0,tipo:"Opções fixas",descricao:null,nome:"Faixa de Renda",id:"DICIO_RENDA"},{ordem:8,opcoes:[{ordem:1,rotulo:"24 meses",codigo:"24"},{ordem:2,rotulo:"36 meses",codigo:"36"},{ordem:3,rotulo:"48 meses",codigo:"48"},{ordem:4,rotulo:"60 meses",codigo:"60"}],servico:null,obrigatorio:!0,tipo:"Opções fixas",descricao:null,nome:"Por quanto tempo gostaria de ter a renda protegida?",id:"DICIO_TEMPO_PROTECAO"},{ordem:9,opcoes:[{ordem:1,rotulo:"Não",codigo:"false"},{ordem:2,rotulo:"Sim",codigo:"true"}],servico:null,obrigatorio:!0,tipo:"Radiobutton",descricao:null,nome:"Tem dependentes financeiros?",id:"DICIO_DEPENDENTES"},{ordem:10,opcoes:[],servico:null,obrigatorio:!0,tipo:"Número inteiro",descricao:null,nome:"Informe o valor do comissionamento",id:"DICIO_CORRETAGEM"},{ordem:11,opcoes:[{ordem:1,rotulo:"0",codigo:"0"},{ordem:2,rotulo:"100",codigo:"100"},{ordem:4,rotulo:"200",codigo:"200"}],servico:null,obrigatorio:!0,tipo:"Opções fixas",descricao:null,nome:"Percentual de Agenciamento",id:"DICIO_AGENCIAMENTO"},{ordem:12,opcoes:[{ordem:1,rotulo:"Para você",codigo:"VOCE"},{ordem:2,rotulo:"Para sua família",codigo:"FAMILIA"},{ordem:3,rotulo:"Para eu e minha família",codigo:"TODOS"}],servico:null,obrigatorio:!0,tipo:"Opções fixas",descricao:null,nome:"Tipo de contrato",id:"TIPOCONTRATO"}],subtitulo:"Informe os dados do seu cliente:",titulo:"Orçamento Seguro de Vida Individual",nome:"Tela Inicial Vida Individual",id:2}],DICIO_RETENCAO:null,DICIO_AGENCIAMENTO:null,DICIO_CORRETAGEM:null,Cliente:!1,meioComercializacao:"Portal",canalDistribuicao:"COR",codigoOfertaConsultiva:isAPTLMKT()?"APTLMK":"VIDA_INDIVIDUAL",identificadorRepresentante:""}),setStorage("caminhoTomado",[0,1]),setStorage("entradaConsultivo",{consultivo:{segmento:"eds",canalDistribuicao:"COR",identificadorRepresentante:"",meioComercializacao:"Portal",entradaNegocio:"SFC",voltar:!1},acao:"CONTRATAR"});let C={apolice:p.contractInfo.Name,seguradoPrincipal:{},tipoBeneficiario:"",beneficiarios:[],corretagem:{}},O={cpf:"",documentos:{},empresa:"",renda:"",estadoCivil:"",nacionalidade:"",paisResidente:"",pep:"",pepRelacionamentoProximo:null,enderecos:{},email:"",periodocontato:"",telefoneResidencial:"",telefoneComercial:"",telefoneCelular:"",ramoAtividade:"",tipoEmpresa:"",numeroCnpj:"",qtdFuncionarios:""};O.cpf=S.Cpf__c,E.qtdFuncionarios__c&&""!==E.qtdFuncionarios__c&&(O.qtdFuncionarios=E.qtdFuncionarios__c),E.tipoEmpresa__c&&""!==E.tipoEmpresa__c&&(O.tipoEmpresa=E.tipoEmpresa__c),E.numeroCnpj__c&&""!==E.numeroCnpj__c&&(O.numeroCnpj=E.numeroCnpj__c),E.RamoAtividade__c&&""!==E.RamoAtividade__c&&(O.ramoAtividade=E.RamoAtividade__c),S.Rg__c&&""!==S.Rg__c&&(O.documentos.rg={num:S.Rg__c,orgaoExpeditor:S.OrgaoExpedidor__c||"",dataExpedicao:S.DataExpedicao__c||""}),S.Cnh__c&&""!==S.Cnh__c&&(O.documentos.cnh={num:S.Cnh__c,orgaoExpeditor:S.OrgaoExpedidor__c||"",dataExpedicao:S.DataExpedicao__c||""}),S.Rne__c&&""!==S.Rne__c&&(O.documentos.rne={num:S.CLASSE__c,orgaoExpeditor:S.OrgaoExpedidor__c||"",dataExpedicao:S.DataExpedicao__c||""}),S.CLASSE__c&&""!==S.CLASSE__c&&(O.documentos.classe={num:S.CLASSE__c,orgaoExpeditor:S.OrgaoExpedidor__c||"",dataExpedicao:S.DataExpedicao__c||""}),O.telefoneResidencial=S.PersonHomePhone,O.telefoneComercial=S.Phone,O.telefoneCelular=S.PersonMobilePhone;for(let e in _){let o=_[e];O.enderecos[o.TipoEndereco__c]={cep:o.CEP__c||"",logradouro:o.Logradouro__c||"",SN:!(""==o.Numero__c||!o.Numero__c),numero:o.Numero__c||"",complemento:o.Complemento__c||"",bairro:o.Bairro__c||"",cidade:o.Cidade__c||"",estado:o.Estado__c||""}}O.empresa=S.EmpresaTrabalhaSocio__c,O.email=S.PersonEmail,O.periodocontato=S.MelhorPeriodoContato__c,O.renda=S.Renda__c,O.nacionalidade=S.Nacionalidade__c.toUpperCase(),O.resideBrasil="brasil"===S.PaisResidencia__c.toLowerCase()||!1,O.paisResidente=S.PaisResidencia__c.replace(/\w\S*/g,e=>e.replace(/^\w/,e=>e.toUpperCase())),O.pep="Sim"==S.Pep__c?"Sim":"Não"==S.Pep__c?"Nao":"Relacionamento próximo"==S.Pep__c?"RelacionamentoProximo":"","RelacionamentoProximo"==O.pep&&(O.pepRelacionamentoProximo={nome:S.NomePessoaPep__c||"",cpf:S.CpfPep__c||"",parentesco:S.GrauParentescoPep__c||""}),O.estadoCivil=getEstadoCivil(S.EstadoCivil__c),C.seguradoPrincipal=O,null!=g&&g.length>0?1===g.length&&g[0].TipoBeneficiario__c.includes("792")?C.tipoBeneficiario="Herdeiros legais, conforme artigo 792 do código civil.":(g.forEach((e,o)=>{let a={numeroBeneficiario:o,nome:e.Nome__c,cpf:e.CpfCnpj__c,dataNascimento:e.Data_de_Nascimento__c,sexo:e.Sexo__c,percentual:e.PercentualIndenizacao__c,parentesto:e.GrauParentesco__c,imprimirApolice:e.ImprimirCertificadoSeguro__c};C.beneficiarios.push(a)}),C.tipoBeneficiario="Nome do beneficiário"):C.tipoBeneficiario="Herdeiros legais, conforme artigo 792 do código civil.";let A={AGENCIAMENTO:[],CORRETAGEM:[]};null!=f&&f.length>0&&f.forEach((e,o)=>{let a={nome:e.Conta__r.Name||"",codigoAgenciador:e.Conta__r.C_digo_do_Agenciador__c||"",lider:e.CorretorLider__c||!1,susep:"",percentual:e.Participacao__c||"0",antecipa:e.AntecipacaoComissao__c||!1,papel:e.Papel__c||"",documento:e.Conta__r.Cnpj__c?e.Conta__r.Cnpj__c:e.Conta__r.Cpf__c?e.Conta__r.Cpf__c:""};try{a.susep=e.Susep__c?e.Susep__c:I[e.Conta__c][0].Name?I[e.Conta__c][0].Name:""}catch(e){console.log(`Não encontrou a SUSEP do agenciador ${a.codigoAgenciador} `)}A[e.RemuneracaoContrato__r.TipoRemuneracao__r.Name.toUpperCase()].push(a)}),C.corretagem=A,o.contratoOriginal=C,setStorage("payload",o),e.ofertas[0].orcamento.rotulo=isAPTLMKT()?"ACIDENTES PESSOAIS TELEMARKETING":"VI - PESSOAS",setStorage("jsonResponseCalculo",e);let v=[{id:"DICIO_NOME",conteudo:a},{id:"DICIO_DATANASCIMENTO",conteudo:t},{id:"DICIO_SEXO",conteudo:"MASC"==r?"MASCULINO":"FEMININO"},{id:"DICIO_FUMANTE",conteudo:i?"SIM":"NAO"},{id:"DICIO_PROFISSAO",conteudo:n},{id:"DICIO_REGIME_TRABALHO",conteudo:isAPTLMKT()?"":l},{id:"DICIO_RENDA",conteudo:c},{id:"DICIO_TEMPO_PROTECAO",conteudo:"24"},{id:"DICIO_DEPENDENTES",conteudo:!1},{id:"DICIO_CORRETAGEM",conteudo:"10"},{id:"DICIO_AGENCIAMENTO",conteudo:"0"},{id:"DICIO_CICLOCOVID",conteudo:isAPTLMKT()?"0":m}];setStorage("dadosUsuario",v),setStorage("jsonEntradaCalculo",{orcamento:null,consultivo:{codigoOfertaConsultiva:isAPTLMKT()?"APTLMK":"VIDA_INDIVIDUAL",canalDistribuicao:"COR",identificadorRepresentante:"",meioComercializacao:"SFC",respostas:v}})}function getEstadoCivil(e){return"Solteiro (a)"==e?"SOLTEIRO":"Divorciado(a)"==e?"DIVORCIADO":"Viúvo(a)"==e?"VIUVO":"Desquitado(a)"==e?"DESQUITADO":"Casado (a)"==e?"CASADO":"Vive maritalmente"==e?"VIVEMARITALMENTE":""}function setStorage(e,o){window.localStorage.setItem(e,JSON.stringify(o))}function redirectToPortal(){let e=window.location.href.toLowerCase().includes("/lotusvida")?"/lotusvida":"/apex",o=JSON.parse(window.localStorage.getItem("entradaConsultivo"));o.consultivo.voltar=!0;let a=`https://${window.location.hostname}${e}/formularioSniper?dados=${JSON.stringify(o)}`;window.location.href=a}function geraOrcamento(){let e=document.getElementById("responseCalculo");""!=e.value&&(e=JSON.parse(e.value),e.message||(setupLocalStorageData(e),redirectToPortal()))}function getFromStorage(){let e=window.localStorage.getItem("payload"),o=document.querySelector("#contractId");if(o=null!=o?o.value:null!=document.querySelector("#contractS")?JSON.parse(document.querySelector("#contractS").value).Id:null,null!=e){if(o!=JSON.parse(e).idContrato)return;confirm("Existem modificações locais para este contrato, deseja utilizar?")&&recoverLocal()}}function clearLocal(){window.localStorage.removeItem("payload")}function convertDatetimeToUserDataIso(e){return e?new Date(e).toUTCString():""}function recoverLocal(){let e,o=JSON.parse(window.localStorage.getItem("payload")),a=JSON.parse(window.localStorage.getItem("jsonServicos")),t=new Map;document.querySelector("#etapa1-name").value=o.nome,document.querySelector("#etapa1-birthdate").setAttribute("data-default-date",convertDatetimeToUserDataIso(o.dataNascimento)),document.querySelector("#etapa1-dataEndosso").setAttribute("data-default-date",convertDatetimeToUserDataIso(o.dataEndosso)),document.querySelector("#etapa1-sex").value=o.sexo,document.querySelector("#etapa1-smoker").value=o.fumante?"Sim":"Não",document.querySelector("#etapa1-income").value=o.rendaMensal,document.querySelector("#renda-aptlmkt").value=o.rendaMensal,document.querySelector("#etapa1-workRegime").value=o.regimeTrabalho,document.querySelector("#etapa1-commission-percentage").value=o.percentual,null!=o.profissao&&""!=o.profissao&&(document.querySelector("#etapa1-profession").value=a.DICIO_PROFISSAO.itens.filter(e=>e.codigo==o.profissao).shift().rotulo),o.coberturas.forEach(e=>{t.set(e.sigla,e)});const r=document.querySelectorAll(".etapa1 .coberturas [data-garantia-personalization]");for(let o of r)t.has(o.getAttribute("data-garantia-personalization"))?(e=t.get(o.getAttribute("data-garantia-personalization")),0!=e.valor&&(o.setAttribute("data-default-value",e.valor),o.querySelector(`#${e.sigla}-capital`)&&(o.querySelector(`#${e.sigla}-capital`).value=e.valor),o.querySelector('[type="range"]').value&&(o.querySelector('[type="range"]').value=e.valor)),e.isActive&&(o.querySelector('[type="checkbox"]').checked=!0,o.querySelector('[type="checkbox"]').setAttribute("data-switch-checked","true"))):(o.querySelector('[type="checkbox"]').setAttribute("data-switch-checked","false"),o.querySelector('[type="checkbox"]').checked=!1);document.getElementById("etapa1-commission-percentage").value=o.percentual,initializeAutocomplete(),initializeCollapsible(),initializeDatePicker(),initializeDate(),initializeSelecteds(),initGarantiaEtapa1Personal(!0),initializePercentInput()}function isNumberKey(e){var o=e.which?e.which:event.keyCode;return!(o>31&&(o<48||o>57))}function isAPTLMKT(){return"APTLMKT"===document.querySelector(".main-title label").getAttribute("data-produto")}function validarCapitaisAPTLMKT(){if(isAPTLMKT()){const e=document.querySelector("#MAP-capital").value,o=document.querySelector("#IPA-capital").value;if(e&&o&&e!=o)return!1}return!0}function validarCoberturasAPTLMKT(){return isAPTLMKT(),!0}function handleRelacionados(e,o,a,t){if(console.info("Opção selecionada: "+t.target.checked),t.target.checked){if(e&&e.length>0){const o=e.replace("[","").replace("]","").split(",");o.map(e=>e.toString()),o.forEach(e=>{if(e){const o="#switch-"+e.trim();console.log("Selector: ",o+" - "+(t.target.checked?"ON":"OFF")),document.querySelector(o).checked=!0,document.querySelector(o).setAttribute("data-switch-checked","true")}})}if(o&&o.length>0){const e=o.replace("[","").replace("]","").split(",");e.map(e=>e.toString()),e.forEach(e=>{if(e){const o="#switch-"+e.trim();console.log("Selector: ",o+" - "+(t.target.checked?"OFF":"ON")),document.querySelector(o).checked=!1,document.querySelector(o).setAttribute("data-switch-checked","false")}})}}else if(a.length>0){const e=a.replace("[","").replace("]","").split(",");e.map(e=>e.toString()),e.forEach(e=>{if(e){const o="#switch-"+e.trim();console.log("Selector: ",o+" -> OFF"),document.querySelector(o).checked=!1,document.querySelector(o).setAttribute("data-switch-checked","false")}})}}