function setEndossoPage(){let e=JSON.parse(window.localStorage.getItem("payload"));if(!e)return;let{apolice:o,seguradoPrincipal:t,tipoBeneficiario:a,beneficiarios:n,corretagem:r}=e.contratoOriginal;document.querySelector("#formularioProposta > div:nth-child(1) > div.section.propPep > div:nth-child(1) > h1").innerHTML="Endosso contrato "+o;let l=document.getElementById("CPF");l&&(setPropostaInputValue("CPF",t.cpf),l.disabled=!0),setPropostaSeguradoPrincipalInfo(t),setBeneficiariosTypeProposta(a);for(const e of n)insertBeneficiarioProposta(e);setCorretagemProposta(r.CORRETAGEM),r.AGENCIAMENTO&&r.AGENCIAMENTO.length>0&&setAgenciamentoProposta(r.AGENCIAMENTO),document.querySelector("input[name=DICIO_NOME]").focus();let s=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].retornosCalculo[0].precificacao.premio.total;if(console.log("totalPremio: ",s),s<0){let e=document.querySelector(".formapagamento");e.setAttribute("hidden","hidden"),e.querySelectorAll("[required]").forEach(e=>{e.removeAttribute("required")});let o=document.querySelector(".resumoAzul");o.querySelector(".garantias").classList.add("hidden"),o.querySelector(".row.total .investimento").innerHTML="O valor a ser restituído é de: "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(parseFloat(Math.abs(s))),o.querySelector(".row.total .investimento").classList.remove("hidden")}else checkAlteracaoPremio()||setPerguntaParcelamento()}function setEndossoViagemPage(){let e=JSON.parse(window.localStorage.getItem("payload"));if(!e)return;let{apolice:o,seguradoPrincipal:t,tipoBeneficiario:a,beneficiarios:n,corretagem:r}=e.contratoOriginal;document.querySelector("#formularioPropostaViagem > div:nth-child(1) > div.section.propPep > h1").innerHTML="Endosso contrato "+o;let l=document.getElementById("CPF");l&&(l.value=t.cpf,l.disabled=!0),setPropostaSeguradoPrincipalInfoViagem(t),setPropostaInputValue("DICIO_CORRETAGEM",e.percentual),setCorretagemProposta(r.CORRETAGEM),r.AGENCIAMENTO&&r.AGENCIAMENTO.length>0&&setAgenciamentoProposta(r.AGENCIAMENTO),ReRunSelecteds(),MaskTel(),document.querySelector("input[name=DICIO_NOME]").focus();let s=window.localStorage.getItem("ofertaSelecionada"),c=JSON.parse(window.localStorage.getItem("jsonResponseCalculo"));ofertaSelecionada=c.ofertas.filter(e=>e.orcamento.numeroOrcamento==s).shift()||c.ofertas[0];let i=ofertaSelecionada.retornosCalculo[0].precificacao.premio.total;parseFloat(i)<0&&(document.getElementById("TIPOPAGAMENTO").closest(".col.s12.step").setAttribute("hidden","hidden"),document.getElementById("TIPOPAGAMENTO").removeAttribute("required"));let u=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].retornosCalculo[0].precificacao.premio.total;if(u<0){let e=document.querySelector(".formapagamento");e.setAttribute("hidden","hidden"),e.querySelectorAll("[required]").forEach(e=>{e.removeAttribute("required")});let o=document.querySelector(".resumoAzul");o.querySelector(".garantias").classList.add("hidden"),o.querySelector(".row.total .investimento").innerHTML="O valor a ser restituído é de: "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(parseFloat(Math.abs(u))),o.querySelector(".row.total .investimento").classList.remove("hidden")}else checkAlteracaoPremio()||setPerguntaParcelamento()}function MaskTel(){document.querySelectorAll(".telMask").forEach(e=>{masks=["(99) 9999-99999","(99) 99999-9999"];var o=e,t=o.value.replace(/\D/g,""),a=o.value.length>14?1:0;VMasker(o).unMask(),VMasker(o).maskPattern(masks[a]),o.value=VMasker.toPattern(t,masks[a])})}function ReRunSelecteds(){let e=document.querySelectorAll("select");for(const e of document.querySelectorAll("select")){let o=e.querySelectorAll("option[aria-selected=true]");o.length>0&&o[o.length-1].setAttribute("selected","")}M.FormSelect.init(e,{})}function setPropostaSeguradoPrincipalInfo(e){let{nomeSocial:o,documentos:t,empresa:a,renda:n,estadoCivil:r,nacionalidade:l,resideBrasil:s,paisResidente:c,enderecos:i,email:u,periodocontato:d,telefoneResidencial:p,telefoneComercial:m,telefoneCelular:E,ramoAtividade:P,tipoEmpresa:I,numeroCnpj:g,qtdFuncionarios:A}=e;t.rg?f("rg"):t.rne?f("rne"):t.cnh?f("cnh"):t.classe&&f("classe");const S=document.getElementById("TIPOEMPRESA"),C=document.getElementById("CNPJEMPRESA"),O=document.getElementById("MEIEMPRESA");if(P&&setPropostaInputValue("RAMOEMPRESA",P),I){setPropostaInputValue("TIPOEMPRESA",I.toLowerCase()),M.FormSelect.init(S)}if(g&&"cnpj"==S.value&&(setPropostaInputValue("CNPJEMPRESA",g),VMasker(C).maskPattern("99.999.999/9999-99"),S.dispatchEvent(new Event("change"))),g&&"mei"==S.value&&(setPropostaInputValue("MEIEMPRESA",g),VMasker(O).maskPattern("99.999.999/9999-99"),S.dispatchEvent(new Event("change"))),A&&setPropostaInputValue("QTDFUNCIONARIOS",A),u&&setPropostaInputValue("EMAIL",u),u&&setPropostaInputValue("EMAILCONFIRMATION",u),d&&setPropostaInputValue("MELHORPERIODO",d),p&&setPropostaInputValue("TELEFONECLIENTE",p),m&&setPropostaInputValue("TELOPCIONAL",m),E&&setPropostaInputValue("CELULARCLIENTE",E),i.Residencial&&_("Residencial"),i.Comercial&&_("Comercial"),a&&setPropostaInputValue("EMPRESATRABALHO",a),o&&setPropostaInputValue("DICIO_NOMESOCIAL",o),n&&setPropostaInputValue("RENDAMENSAL","R$ "+VMasker.toMoney((n+"").split(".")[0]+"00")),r&&setPropostaInputValue("ESTADOCIVIL",r),l&&setPropostaInputValue("NACIONALIDADE",l),null!=s&&null!=s&&(setPropostaInputValue("RESIDE_BRASIL",s?"SIM":"NÃO"),s)){setPropostaInputValue("PAISRESIDENTE",c);let e=document.getElementById("PAISRESIDENTE");e&&(e=e.parentNode.parentNode)}function f(e){let{num:o,orgaoExpeditor:a,dataExpedicao:n}=t[e];setPropostaInputValue("TIPODOCUMENTO",e),setPropostaInputValue("NUMERODOCUMENTO",o),setPropostaInputValue("ORGAOEMISSOR",a),setPropostaInputValue("DATAEXPEDICAO",n.split("-").reverse().join("/"))}function _(e){let{cep:o,logradouro:t,SN:a,numero:n,complemento:r,bairro:l,cidade:s,estado:c}=i[e];setPropostaInputValue("Residencial"==e?"CEPCLIENTE":"CEPCOMERCIAL",o?o.replace(/\D/g,"").replace(/(\d{5})?(\d{3})/,"$1-$2").slice(0,9):""),setPropostaInputValue("Residencial"==e?"LOGRADOUROCLIENTE":"LOGRADOUROCOMERCIAL",t||""),setPropostaInputValue("Residencial"==e?"SEMNUMERO":"SEMNUMEROCOMERCIAL",a?"SIM":"NAO"),setPropostaInputValue("Residencial"==e?"NUMEROCLIENTE":"NUMEROCOMERCIAL",n||""),setPropostaInputValue("Residencial"==e?"COMPLEMENTO":"COMPLEMENTOCOMERCIAL",r||""),setPropostaInputValue("Residencial"==e?"BAIRROCLIENTE":"BAIRROCOMERCIAL",l||""),setPropostaInputValue("Residencial"==e?"CIDADECLIENTE":"CIDADECOMERCIAL",s||""),setPropostaInputValue("Residencial"==e?"ESTADOCLIENTE":"ESTADOCOMERCIAL",c||""),selectedEndereco("Residencial"==e?"CEPCLIENTE":"CEPCOMERCIAL")}c&&""!=c&&setPropostaInputValue("PAISRESIDENTE",c)}function setPropostaSeguradoPrincipalInfoViagem(e){let{nomeSocial:o,documentos:t,empresa:a,renda:n,estadoCivil:r,nacionalidade:l,resideBrasil:s,paisResidente:c,pep:i,pepRelacionamentoProximo:u,enderecos:d,email:p,periodocontato:m,telefoneResidencial:E,telefoneComercial:P,telefoneCelular:I,nascimento:g,sexo:A,nomeContato:S,telefoneContato:C}=e;if(t.rg?O("rg"):t.rne?O("rne"):t.cnh?O("cnh"):t.classe&&O("classe"),o&&setPropostaInputValue("DICIO_NOMESOCIAL",o),p&&setPropostaInputValue("EMAIL",p),p&&setPropostaInputValue("EMAILCONFIRMATION",p),m&&setPropostaInputValue("MELHORPERIODO",m),E&&setPropostaInputValue("TELEFONE",E),P&&setPropostaInputValue("TELOPCIONAL",P),I&&setPropostaInputValue("CELULARCLIENTE",I),S&&setPropostaInputValue("NOMECLIENTEALTERNATIVOSEGURADO0",S),C&&setPropostaInputValue("TELCLIENTEALTERNATIVOSEGURADO0",C),A&&(A="MASC"==A.toUpperCase()||"MASCULINO"==A.toUpperCase()?"MASCULINO":"FEMININO",setPropostaInputValue("DICIO_SEXO",A)),g&&setPropostaInputValue("DICIO_DATANASCIMENTO",g),d.Comercial&&f("Comercial"),d.Residencial&&f("Residencial"),a&&setPropostaInputValue("EMPRESATRABALHO",a),n&&setPropostaInputValue("RENDAMENSAL","R$ "+VMasker.toMoney((n+"").split(".")[0]+"00")),r&&setPropostaInputValue("ESTADOCIVIL",r),l&&setPropostaInputValue("NACIONALIDADE",l),null!=s&&null!=s&&(setPropostaInputValue("RESIDE_BRASIL",s?"SIM":"NÃO"),s)){setPropostaInputValue("PAISRESIDENTE",c);let e=document.getElementById("PAISRESIDENTE");e&&(e=e.parentNode.parentNode)}function O(e){let{num:o,orgaoExpeditor:a,dataExpedicao:n}=t[e];setPropostaInputValue("TIPODOCUMENTO",e),setPropostaInputValue("NUMERODOCUMENTO",o),setPropostaInputValue("ORGAOEMISSOR",a),setPropostaInputValue("DATAEXPEDICAO",n.split("-").reverse().join("/"))}function f(e){let{cep:o,logradouro:t,SN:a,numero:n,complemento:r,bairro:l,cidade:s,estado:c}=d[e];o&&""!=o&&"null"!=o&&(setPropostaInputValue("CEP",o?o.replace(/\D/g,"").replace(/(\d{5})?(\d{3})/,"$1-$2").slice(0,9):""),setPropostaInputValue("LOGRADOUROCLIENTE",t||""),setPropostaInputValue("SEMNUMERO",a?"SIM":"NAO"),setPropostaInputValue("NUMEROCLIENTE",n||""),setPropostaInputValue("COMPLEMENTO",r||""),setPropostaInputValue("BAIRROCLIENTE",l||""),setPropostaInputValue("CIDADECLIENTE",s||""),setPropostaInputValue("ESTADOCLIENTE",c||""),setPropostaInputValue("TIPOENDERECO",e||""))}c&&""!=c&&setPropostaInputValue("PAISRESIDENTE",c)}function checkOfertaSelecionadaIsEndossoVI(){let e=getOfertaSelecionada();try{let o=e.orcamento.segmento,t=getPayloadEndosso();t.apolice;return!("Individual"!=o||!t||"EDS"!==e.orcamento.tipoSeguro.toUpperCase())}catch(e){}return!1}function checkOfertaSelecionadaIsEndossoViagem(){let e=getOfertaSelecionada();try{let o=e.orcamento.segmento;o&&(o=o.toUpperCase());let t=getPayloadEndosso();t.apolice;return!("VIAGEM"!=o||!t||"EDS"!==e.orcamento.tipoSeguro.toUpperCase())}catch(e){}return!1}function getOfertaSelecionada(){let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")),o=window.localStorage.getItem("ofertaSelecionada");return e.ofertas.filter(e=>e.orcamento.numeroOrcamento==o).shift()||e.ofertas[0]}function getPayloadEndosso(){return JSON.parse(window.localStorage.getItem("payload")).contratoOriginal||null}function setCorretagemProposta(e){let o=new Event("input",{bubbles:!0,cancelable:!0});for(let t=0;t<e.length;t++){t>0&&document.querySelector(".addCorretor").click();let{lider:a,susep:n,percentual:r}=e[t];document.querySelector("#LIDERFAV"+t).checked=a||!1;let l=document.querySelector("#SUSEPFAV"+t);l.removeAttribute("disabled"),l.value=n,l.className="valid";let s=document.querySelector("#PERCENTFAV"+t);s.value=r,s.dispatchEvent(o)}}function setAgenciamentoProposta(e){let o=document.querySelector("#blocoagenciamento"),t=document.querySelector("#AGENCIAMENTO_PARA"),a=document.querySelector("#AGENCIADOR"),n=document.querySelector("#SUSEP_AGENCIADOR"),r=document.querySelector("#CODIGO_AGENCIADOR"),l=document.querySelector("#CPF_AGENCIADOR"),s=document.querySelector("#NOME_AGENCIADOR"),c=document.querySelector("#btn_busca_agenciador");document.querySelectorAll("#blocoagenciamento > div div").forEach(e=>{e&&e.classList.contains("hidden")&&e.classList.remove("hidden")}),a.value=e[0].documento,l.value=e[0].documento,t.value=e[0].papel.toUpperCase()||"",n.value=e[0].susep||"",r.value=e[0].codigoAgenciador||"",o.classList.remove("hidden"),s.parentNode.classList.add("hidden"),c.parentNode.classList.add("hidden"),l.setAttribute("disabled","true"),t.setAttribute("disabled","true"),n.setAttribute("disabled","true"),r.setAttribute("disabled","true"),s.setAttribute("disabled","true");let i=document.createElement("option"),u=""!=r.value?r.value:"???";i.value=l.value,i.innerHTML=u+" - "+e[0].nome,i.selected=!0,a.appendChild(i),a.setAttribute("disabled","true")}function setBeneficiariosTypeProposta(e){setPropostaInputValue("BENEFICIARIOS",e),document.querySelector('#BENEFICIARIOS [value="'+e+'"]').selected=!0;document.getElementById("tbl-beneficiarios-tbody");if("Nome do beneficiário"==e){let e=document.querySelector(".section.listaBeneficiarios");e&&e.classList.add("on")}}function insertBeneficiarioProposta(e){let{nome:o,nomeSocial:t,cpf:a,dataNascimento:n,parentesto:r,percentual:l,imprimirApolice:s,sexo:c}=e;document.getElementById("nomeBeneficiario").value=o,document.getElementById("nomeSocialBeneficiario").value=t,document.getElementById("cpfBeneficiario").value=a,document.getElementById("nascimentoBeneficiario").value=n,document.getElementById("sexoBeneficiario").value=c,document.getElementById("grauParentescoBeneficiario").value=r,document.getElementById("percentualBeneficio").value=l,s?document.querySelector("input[name=imprimirApolice][value=Sim]").checked=!0:document.querySelector("input[name=imprimirApolice][value=Nao]").checked=!0,document.querySelector(".addBeneficiario").click(),document.documentElement.scrollTop=0,document.getElementById("sexoBeneficiario").value="MASCULINO"}function setPropostaInputValue(e,o){let t=document.getElementById(e);t&&(t.value=o,o&&t.nextElementSibling&&t.nextElementSibling.classList.add("active"))}function checkAlteracaoPremio(){let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.contratoOriginal.precificacao.premio.total,o=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.contratoOriginal.precificacao.descontoAgravo.filter(e=>"FPG"==e.tipo).shift(),t=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].retornosCalculo,a=!0;return o&&t.forEach(t=>{let n=t.precificacao.descontoAgravo.filter(e=>e.tipo==o.tipo).shift();o.percentual==n.percentual&&(a=t.precificacao.premio.total!=e)}),a}function setPerguntaParcelamento(){callDadosPagamento();let e=document.querySelector(".formapagamento :first-child"),o=document.createElement("div"),t=document.createElement("col");o.classList.add("row","manterParc"),t.classList.add("col","s12");let a=document.createElement("p");a.classList.add("title-field"),a.innerText="Deseja manter o plano de parcelamento atual?";let n=document.createElement("label"),r=document.createElement("label");n.innerHTML='<input checked="true" name="PLANOPARCELAMENTO" id="parc_SIM" type="radio" value="Sim"><span>Sim  </span> ',r.innerHTML='<input name="PLANOPARCELAMENTO" type="radio" id="parc_NAO" value="Nao"> <span> Não</span>',t.appendChild(a),t.appendChild(n),t.appendChild(r),o.appendChild(t),e.parentNode.insertBefore(o,e.nextSibling),document.querySelector('input[name="PLANOPARCELAMENTO"]')&&(document.querySelectorAll('input[name="PLANOPARCELAMENTO"]').forEach(e=>{e.addEventListener("change",(function(e){var o=e.target.value;let t=document.querySelector(".formapagamento");t&&("Sim"==o?(t.querySelectorAll(".row:not(.manterParc):not(:first-child)").forEach(e=>{e.setAttribute("hidden","hidden")}),t.querySelectorAll("[required]").forEach(e=>{e.removeAttribute("required"),e.setAttribute("requiredRemoved","true")})):(t.querySelectorAll(".row:not(.manterParc):not(:first-child)").forEach(e=>{e.removeAttribute("hidden")}),t.querySelectorAll("[requiredRemoved]").forEach(e=>{e.removeAttribute("requiredRemoved"),e.setAttribute("required","required")})))}))}),document.querySelector('input#parc_SIM[name="PLANOPARCELAMENTO"]').checked=!0,document.querySelector('input#parc_SIM[name="PLANOPARCELAMENTO"]').dispatchEvent(new Event("change")))}function callDadosPagamento(){let e=ofertaSelecionada.orcamento.contratoOriginal.apolice,o=ofertaSelecionada.orcamento.contratoOriginal.ramo,t=ofertaSelecionada.orcamento.contratoOriginal.empresa,a=ofertaSelecionada.orcamento.contratoOriginal.endosso,n=ofertaSelecionada.orcamento.contratoOriginal.sucursal;callDadosPagOriginal(t+"-"+n+"-"+o+"-"+e+"-"+a)}function objPagamentoManterParcelamento(){let e=JSON.parse(document.getElementById("retornoDadosPagamento").value),o=e.dadosPgt?e.dadosPgt:{},t=e.dadosSegurado?e.dadosSegurado:{},a=ofertaSelecionada.orcamento.contratoOriginal.contratantes[0].dadosPagamento;objPagamentos={opcao:null,codigoFormaPagamento:a.codigoFormaPagamento,quantidadeParcelas:a.quantidadeParcelas,cartaoCredito:null,dadosBancarios:null,formaPagamento:{codigo:a.codigo,descricao:a.descricao,idFormaPagamento:o.FormaPagamento__c?o.FormaPagamento__c:null,planoParcelamento:null},responsavelPagamento:null,tipoResponsavelPagamento:a.tipoResponsavelPagamento,vencimentoDemaisParcelas:a.vencimentoDemaisParcelas,vigenciaInicial:o.VigenciaInicial__c?o.VigenciaInicial__c:null};let n=document.querySelector('#TIPOPAGAMENTO option[value="'+a.codigoFormaPagamento+'"]');if(n)switch(n.dataset.layout){case"CartaoCredito":{let e=o.CartaoCredito__r;objPagamentos.dadosCartaoCredito={cartaoPorto:!1,cvv:e.CodigoSeguranca__c?e.CodigoSeguranca__c:"",nome:e.NomeTitular__c?e.NomeTitular__c:"",numero:e.NumeroCartao__c?e.NumeroCartao__c.replace(/\D/g,""):null,validade:e.Vencimento__c?e.Vencimento__c:null,bandeira:e.Bandeira__c?e.Bandeira__c.toLowerCase():"não identificado"};break}case"ADC":{let e=o.InformacaoBancaria__r,t=e.Agencia__c;objPagamentos.dadosBancarios={agencia:t?t.trim().split("-").length>1?t.split("-")[0]:t:null,banco:e.BancoNew__r?e.BancoNew__r.CodigoBanco__c:null,conta:e.NumeroConta__c?e.NumeroConta__c:null,digitoAgencia:t&&t.trim().split("-").length>1?t.split("-")[1]:null,digitoConta:e.Digito__c?e.Digito__c.trim():null,tipoPessoa:e.TipoPessoa__c,cpf:e.Conta__r&&e.Conta__r.Cpf__c?e.Conta__r.Cpf__c.replace(/\D/g,""):null};break}}objPagamentos.formaPagamento.planoParcelamento={idPlanoParcelamento:a.idPlanoParcelamento,quantidadeParcelas:a.quantidadeParcelas},"97"==a.codigo&&(objPagamentos.dadosCartaoCredito.cartaoPorto=!0);let r=!0,l=null;return t&&t.SeguradosContrato__r&&t.SeguradosContrato__r.records[0]&&null!=t.SeguradosContrato__r.records[0].ResponsavelFinanceiroSeguro__c&&(r=t.SeguradosContrato__r.records[0].ResponsavelFinanceiroSeguro__c,l=t.SeguradosContrato__r.records[0]),console.log("dadosResp",l),0==r?(objPagamentos.responsavelFinanceiro=!1,objPagamentos.responsavelFinanceiroSeguro={nome:l.NomeResponsavel__c?l.NomeResponsavel__c:null,cpf:l.CpfResponsavel__c?l.CpfResponsavel__c:null,vinculoComSegurado:l.vinculoComSegurado__c?l.vinculoComSegurado__c:null,email:l.ResponsavelPagamento__r.PersonEmail?l.ResponsavelPagamento__r.PersonEmail:null,dadosPessoaFisica:{digitoCpf:l.CpfResponsavel__c?l.CpfResponsavel__c.slice(0,9):null,numeroCpf:l.CpfResponsavel__c?l.CpfResponsavel__c.slice(9):null}},objPagamentos.responsavelFinanceiroSeguro.telefones=[],l.ResponsavelPagamento__r.PersonHomePhone&&objPagamentos.responsavelFinanceiroSeguro.telefones.push({tipoTelefone:"RES",numeroTelefone:l.ResponsavelPagamento__r.PersonHomePhone.replace(/[\( \s \) \-]/g,"").slice(2),dddTelefone:l.ResponsavelPagamento__r.PersonHomePhone.replace(/[\( \s \) \-]/g,"").slice(0,2)}),l.ResponsavelPagamento__r.Phone&&objPagamentos.responsavelFinanceiroSeguro.telefones.push({tipoTelefone:"PES",numeroTelefone:l.ResponsavelPagamento__r.Phone.replace(/[\( \s \) \-]/g,"").slice(2),dddTelefone:l.ResponsavelPagamento__r.Phone.replace(/[\( \s \) \-]/g,"").slice(0,2)}),l.ResponsavelPagamento__r.PersonMobilePhone&&objPagamentos.responsavelFinanceiroSeguro.telefones.push({tipoTelefone:"CEL",numeroTelefone:l.ResponsavelPagamento__r.PersonMobilePhone.replace(/[\( \s \) \-]/g,"").slice(2),dddTelefone:l.ResponsavelPagamento__r.PersonMobilePhone.replace(/[\( \s \) \-]/g,"").slice(0,2)}),objPagamentos.responsavelFinanceiroSeguro.enderecos=[],l.ResponsavelPagamento__r.Enderecos__r.records.forEach(e=>{objPagamentos.responsavelFinanceiroSeguro.enderecos.push({tipoEndereco:e.CEP__c||"",logradouro:e.Logradouro__c||"",numeroLogradouro:e.Numero__c||"",bairro:e.Bairro__c||"",cidade:e.Cidade__c||"",uf:e.Estado__c||"",cep:e.CEP__c.slice(0,5),complemento:e.Complemento__c||"",complementoCep:e.CEP__c.slice(5)})})):objPagamentos.responsavelFinanceiro=!0,objPagamentos}
"use strict";function inicializaSelectCanais(){carregamento.classList.remove("on");let e=document.getElementById("canalEntrada"),t=document.getElementById("dadosEntrada");if(t){e.innerHTML='<option disabled="true" selected="true" value="0">Selecione o canal de entrada</option>';let a=JSON.parse(t.value);a.canais&&a.canais.forEach(t=>{let a=document.createElement("option");a.value=t.sigla,a.innerHTML=t.nome,e.appendChild(a)}),inicializaSelects()}}function inicializaSelectsEntrada(){carregamento.classList.remove("on");document.getElementById("canalEntrada");let e=document.getElementById("codigoOfertas"),t=document.getElementById("dadosEntrada");if(document.querySelector(".identificado").classList.add("on"),document.querySelector("#acaoPortal").setAttribute("required","required"),t){let a=JSON.parse(t.value);e.innerHTML='<option disabled="true" selected="true" value="0">Selecione o código de oferta</option>',a.codigos&&a.codigos.forEach(t=>{let a=document.createElement("option");a.value=t,a.innerHTML=t,e.appendChild(a)}),inicializaSelects()}}window.addEventListener("load",e=>{const t=document.querySelector("#entradaConsultivo");if(t){t.querySelector("#susep").addEventListener("change",e=>{""!=e.target.value.replace(/\s/g,"")&&(carregamento.classList.add("on"),identificar(e.target.value))}),document.getElementById("acaoPortal").addEventListener("change",(function(e){document.querySelector(".CONTRATAR").classList.remove("on"),"CONTRATAR"===e.target.value&&(document.querySelector("."+e.target.value).classList.add("on"),document.querySelector("."+e.target.value).querySelectorAll("select, input").forEach(e=>e.setAttribute("required","required"))),t.querySelector("form input[type = submit]").classList.remove("disabled")})),document.querySelector("#canalEntrada").addEventListener("change",(function(e){"COR"!=e.target.value&&VMasker(document.querySelector("#susep")).maskPattern("999.999.999-99"),document.querySelector("#susep").removeAttribute("disabled")})),t.addEventListener("submit",e=>{if(function(){return t.querySelectorAll("[required]").every(e=>"0"!=e.value||""!=e.value)}){let e=document.getElementById("acaoPortal")?"0"==document.getElementById("acaoPortal").value?"":t.querySelector("#acaoPortal").value:"";const a={consultivo:{codigoOfertaConsultiva:document.getElementById("codigoOfertas")?"0"==document.getElementById("codigoOfertas").value?"":t.querySelector("#codigoOfertas").value:"",canalDistribuicao:document.getElementById("canalEntrada")?"0"==document.getElementById("canalEntrada").value?"":t.querySelector("#canalEntrada").value:"",identificadorRepresentante:(t.querySelector("#susep")?t.querySelector("#susep").value:"").toUpperCase(),meioComercializacao:"Portal",entradaNegocio:"SFC",voltar:!1},acao:e};let o=JSON.stringify(a);window.localStorage.setItem("entradaConsultivo",o),document.querySelector(".jsonResponse").value=o}else t.querySelectorAll("[required]").forEach(e=>{e.classList.remove("valid"),e.classList.add("invalid")})})}const a=document.querySelector("#consultaOfertas");(document.querySelector(".tbl-results")||document.querySelector(".messageConsulta"))&&document.querySelector(".listOfertas").classList.remove("hidden"),a&&a.addEventListener("submit",e=>{const t={numero:a.querySelector("#numOrcamento").value};let o=JSON.stringify(t);window.localStorage.setItem("consultaOferta",o),document.querySelector(".jsonResponse").value=o,carregamento.classList.add("on")}),inicializaSelectCanais()});
"use strict";var carregamento;let urlParams,caminho=[];const listaServicos=[];let tipoProtecoes=[],portalAdmin=!1,segmentoOfertas=null,arrCoberturaOrc=[],numOrcamentoPersonaliz=null,jsonOfertaAtual=null,voltarPersonaliz=!1,voltarPersonalizError=!1;const PERSONALIZAR_OFERTA_KEY="personalizarOfertaData",idCamposEspeciais=[],getOfertaPersonalizada=()=>JSON.parse(localStorage.getItem(PERSONALIZAR_OFERTA_KEY))||{};function inicializaSelects(){let e=document.querySelectorAll("select");M.FormSelect.init(e,{});e.forEach(e=>{})}function inicializaModal(){let e=document.querySelectorAll(".modalLoaderMore, .modalLoaderShare");M.Modal.init(e,{})}function inicializaMetadados(){window.jsonMdtGrupo&&window.localStorage.setItem("jsonMdtGrupo",window.jsonMdtGrupo.value)}function inicializaDatepicker(){let e=document.querySelectorAll(".datepicker");M.Datepicker.init(e,{format:"dd/mm/yyyy",language:"pt-BR",i18n:{weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],weekdaysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],weekdaysAbbrev:["D","S","T","Q","Q","S","S"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],cancel:"Cancelar",clear:"Limpar",done:"Ok"}})}function inicializaServicos(){if(document.querySelector("#jsonServicos")&&""!=document.querySelector("#jsonServicos").value){let e;e=window.localStorage.getItem("jsonServicos")?Object.assign(JSON.parse(window.localStorage.getItem("jsonServicos")),JSON.parse(document.querySelector("#jsonServicos").value)):JSON.parse(document.querySelector("#jsonServicos").value),window.localStorage.setItem("jsonServicos",JSON.stringify(e))}preencherCamposServico()}function preencherCamposServico(){if(null!==window.localStorage.getItem("jsonServicos")){let e=JSON.parse(window.localStorage.getItem("jsonServicos"));for(let t in e){let a={data:{}};if(e[t].constructor===String){try{e[t]=JSON.parse(e[t])}catch(e){continue}window.localStorage.setItem("jsonServicos",JSON.stringify(e))}let o=e[t],n=document.querySelectorAll("input#"+t);"DICIO_PROFISSAO"==t||"PROFISSAOLABEL"==t?(o.itens.forEach(e=>a.data[""+e.rotulo]=null),n.forEach(e=>{e.addEventListener("change",t=>{let a=o.itens.filter(e=>e.rotulo==t.target.value);e.dataset.valor=a.length>0?a[0].codigo:"0"})})):"ADCBANCO"==t?(e[t].constructor===String&&(e[t]=JSON.parse(e[t]),window.localStorage.setItem("jsonServicos",JSON.stringify(e))),null==o.data.descricaoErro&&o.data.Bancos.length>0&&(o.data.Bancos.forEach(e=>a.data[""+e.nomeBanco]=null),n.forEach(e=>{e.addEventListener("change",t=>{let a=o.data.Bancos.filter(e=>e.nomeBanco.toLowerCase()==t.target.value.toLowerCase());e.dataset.valor=a.length>0?a[0].codigoBanco:"empty"})}))):"PAISRESIDENTE"==t&&document.querySelectorAll(".reside-brasil").forEach(e=>{e.addEventListener("change",e=>{let t=closestByClass(e.target,"section").querySelector('input[name="PAISRESIDENTE"]');t&&("SIM"==e.target.value?(t.focus(),t.value="Brasil",t.parentNode.classList.remove("invalid"),t.classList.add("disabled"),t.removeAttribute("required"),t.classList.remove("invalid")):(t.focus(),t.classList.remove("disabled"),o.records.forEach(e=>a.data[""+e.Label]=null),t.addEventListener("change",e=>{let a=o.records.filter(t=>t.Label==e.target.value);t.dataset.valor=a.length>0?a[0].codigo:"0"}),t.setAttribute("required",""),M.Autocomplete.init(t,a)))})}),M.Autocomplete.init(n,a)}}}function inicializaProtecoes(){tipoProtecoes={Família:"COBERTURAS PARA FAMÍLIA",Imprevistos:"COBERTURAS PARA O SEGURADO",Doenças:"DOENÇAS",Renda:"RENDA"}}function inicializaProtecoesAptlmk(){tipoProtecoes={Família:"COBERTURAS PARA FAMÍLIA",Imprevistos:"COBERTURAS PARA O SEGURADO",Renda:"RENDA"}}function inicializaPassageiros(){let e=document.querySelector("#formulario #DICIO_QTD_JOVENS");!e&&document.querySelector("#formularioPropostaViagem #DICIO_QTD_JOVENS");let t=document.querySelector("#formulario #DICIO_QTD_IDOSOS");!t&&document.querySelector("#formularioPropostaViagem #DICIO_QTD_IDOSOS"),e&&t&&(atualizaQtdPassageiros(),e.addEventListener("change",e=>{atualizaQtdPassageiros()}),t.addEventListener("change",e=>{atualizaQtdPassageiros()})),vidaOnHidePassageiros()}function atualizaQtdPassageiros(){let e=document.querySelector("#formulario #DICIO_QTD_JOVENS");!e&&document.querySelector("#formularioPropostaViagem #DICIO_QTD_JOVENS");let t=document.querySelector("#formulario #DICIO_QTD_IDOSOS");if(!t&&document.querySelector("#formularioPropostaViagem #DICIO_QTD_IDOSOS"),e&&t){let n=0,l=0;e&&null!=e.value&&""!=e.value&&"nulloption"!=e.value&&(n=e.value),t&&null!=t.value&&""!=t.value&&"nulloption"!=t.value&&(l=t.value);let r=parseInt(n)+parseInt(l),i=8-parseInt(r);var a=parseInt(n)+parseInt(i),o=parseInt(l)+parseInt(i);let s=document.querySelectorAll("#DICIO_QTD_JOVENS option");for(let e=0;e<s.length;e++)s[e].value>a?s[e].setAttribute("disabled","disabled"):s[e].removeAttribute("disabled");s=document.querySelectorAll("#DICIO_QTD_IDOSOS option");for(let e=0;e<s.length;e++)s[e].value>o?s[e].setAttribute("disabled","disabled"):s[e].removeAttribute("disabled");let c=document.querySelectorAll("#DICIO_QTD_JOVENS, #DICIO_QTD_IDOSOS");M.FormSelect.init(c,{});let d=e.closest(".select-wrapper"),u=t.closest(".select-wrapper");d&&d.querySelectorAll("li.disabled").forEach(e=>{e.classList.add("hidden")}),u&&u.querySelectorAll("li.disabled").forEach(e=>{e.classList.add("hidden")})}}window.addEventListener("DOMContentLoaded",inicializaSelects),document.addEventListener("DOMContentLoaded",inicializaModal),document.addEventListener("DOMContentLoaded",inicializaMetadados),window.addEventListener("DOMContentLoaded",inicializaDatepicker),window.addEventListener("DOMContentLoaded",inicializaPassageiros);let closestByClass=function(e,t){for(;!e.classList.contains(t);)if(!(e=e.parentNode))return null;return e};function irPasso(e,t){let a=document.querySelectorAll("header.navigate .dot"),o=document.querySelector("header.navigate .front"),n=document.getElementById("formulario");n&&n.classList.add("ovhide");for(let e=0;e<a.length;e++)e<=t?a[e].classList.add("on"):a[e].classList.remove("on");e>t?o.classList.add("backward"):o.classList.remove("backward")}function changeStep(e){let t=document.querySelectorAll("section.step");for(let e=0;e<t.length;e++)t[e].classList.remove("on"),t[e].classList.remove("off");for(let a=0;a<e;a++)t[a].classList.add("off");t[e].classList.add("on"),caminho.splice(-1,1)}function geraProdutos(e,t){console.log("salvarLocalStorage ",e,"portalAdmNode ",t);const a=document.querySelector(".modalLoaderErro");a&&(null==t||null!=t&&2!=t.tarefa)&&a.classList.remove("on");let o,n=document.querySelectorAll(".personalize-oferta-container");if(0==n.length){let e=document.createElement("div");e.className="personalize-oferta-container",document.querySelector("body").appendChild(e)}else n[0].innerHTML="";if(irPasso(0,1),voltarPersonaliz&&(document.querySelector("#OfertaPersonalizada").value=jsonOfertaAtual,voltarPersonaliz=!1),document.getElementById("Ofertas").value?o=document.getElementById("Ofertas").value:(o=window.localStorage.getItem("jsonResponseCalculo"),document.getElementById("Ofertas").value=o),validaIntegracao(o)){let a=document.querySelector("#formulario");document.querySelector(".produtos.prodPerson")&&document.querySelector(".produtos.prodPerson").remove();let o=document.querySelector("section.step:last-of-type"),n=0,l=[];for(let e=0,t=o.parentNode.children;e<t.length;e++)if(l.push(t[e]),o==t[e]){n=e;break}for(let e=0;e<l.length;e++)l[e].classList.remove("on"),l[e].classList.add("off");let r,s=document.querySelector("#OfertaPersonalizada").value;if(""==s)r=document.querySelector("#Ofertas").value,window.localStorage.setItem("dadosUsuario",JSON.stringify(JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")).consultivo.respostas));else{if(!validaIntegracao(s))return window.localStorage.removeItem("jsonEntradaCalculo"),carregamento.classList.add("on"),carregamento.querySelector(".loader").classList.add("hidden"),carregamento.querySelector(".message").classList.remove("hidden"),void(carregamento.querySelector(".message p").innerHTML=[...new Set(JSON.parse(s).message.split(".,"))].filter(e=>""!=e.trim()).join("<br>"));r=s}let c=document.createElement("section");c.classList.add("produtos"),c.classList.add("step"),c.classList.add("on"),c.id="etapa"+(parseInt(o.id.match(/[0-9]/g))+1);let d=document.createElement("h1");d.innerHTML="Confira as ofertas para o seu cliente.";let u=document.createElement("h2");u.innerHTML="";let m=document.createElement("hgroup");m.appendChild(d),m.appendChild(u),c.appendChild(m);let p=document.createElement("button");p.classList.add("change-step"),p.classList.add("btnPortoSuccess"),p.innerHTML="ELABORAR PROPOSTA",p.addEventListener("click",e=>{carregamento.classList.add("on");let t=document.querySelector('input[name="inputOferta"]:checked');if(t){JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas.filter(e=>e.orcamento.numeroOrcamento==t.value).shift();window.localStorage.setItem("ofertaSelecionada",t.value),setTimeout((function(){carregamento.classList.remove("on"),irPasso(1,2),redirecionarTela()}),1e3)}else carregamento.classList.remove("on"),alert("Selecione uma oferta")});let g=document.createElement("button");g.classList.add("change-step"),g.classList.add("btnPortoSuccessB"),g.innerHTML="Voltar",g.dataset.destino="null",g.addEventListener("click",e=>{console.log("voltar teste "),null!==localStorage.getItem("personalizacaoOferta")&&localStorage.removeItem("personalizacaoOferta"),null!==localStorage.getItem("personalizarOfertaData")&&localStorage.removeItem("personalizarOfertaData"),arrCoberturaOrc=[];let t=null===window.localStorage.getItem("entradaConsultivo")?null:JSON.parse(window.localStorage.getItem("entradaConsultivo")),a=null===window.localStorage.getItem("payload")?null:JSON.parse(window.localStorage.getItem("payload"));if(void 0===voltarPersonalizError){}if(null!=numOrcamentoPersonaliz&&1==voltarPersonalizError){numOrcamentoPersonaliz=null,voltarPersonalizError=null,document.querySelectorAll(".produtos").forEach(e=>{e.classList.contains("off")&&(e.innerHTML="")}),voltarPersonaliz=!0,geraProdutos(!1,null)}else null!=t&&null!=a&&"eds"==t.consultivo.segmento?"VIAGEM"==t.consultivo.codigoOfertaConsultiva?redirecionaEndossoViagem(a.idContrato):redirecionaEndosso(a.idContrato):(irPasso(1,0),changeStep(caminho[caminho.length-1]))});let f=document.createElement("div");f.classList.add("btnUp"),f.classList.add("containerButtons"),f.appendChild(g),f.appendChild(p);let h=JSON.parse(r);h.ofertas.forEach((e,t)=>{e.regras&&e.regras.coberturas&&"INDIVIDUAL"==e.orcamento.segmento.toUpperCase()&&e.regras.coberturas.forEach(e=>{"IPA"==e.sigla&&(e.nome+=" Plus")})}),r=JSON.stringify(h),window.localStorage.setItem("jsonResponseCalculo",r),console.log("Inicial: ",r),r=tratamentoOfertas(window.localStorage.getItem("jsonResponseCalculo"));let S=JSON.parse(r),v=document.createElement("div");v.className="responsePlanos",void 0!==S.ofertas&&S.ofertas.length>0&&(segmentoOfertas=S.ofertas[0].orcamento.segmento),1==S.ofertas.length&&(d.innerHTML="Confira a sua oferta personalizada",u.innerHTML="",v.classList.add("center-align"));let E=window.localStorage.getItem("entradaConsultivo");null!=E&&(E=JSON.parse(E).consultivo.codigoOfertaConsultiva,"VIAGEM_VIDA_ON"==E&&(u.innerHTML='<p class="vidaOnWarningMessage">Benefício seguro Porto Vida ON - Prêmio pago integralmente pela Porto Seguro</p>'));let C=document.createElement("div"),O=!1,I=!1,L=[];if(S.ofertas.forEach((e,t)=>{let a=e.retornoAceitacao.recusas,o=e.orcamento.customizavel;a.length?a.forEach(e=>{e.codigo&&e.mensagens&&(L[e.codigo+""]=e.mensagens.cliente)}):O=!0,o&&0==a.length&&(I=!0)}),console.log("temOfertaValida?: ",O),O){window.localStorage.setItem("CallPersonalizeFirstTime","yes");let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo"));const a=new Map([]);if(e.ofertas.forEach((e,t)=>{a.set(e.orcamento.numeroOrcamento,e)}),S.ofertas.forEach((e,o)=>{let n=e.retornoAceitacao.pendencias,l=e.retornoAceitacao.recusas,r=e.retornoAceitacao.analises;if(l.length)return;let s=document.createElement("input");s.type="radio",s.name="inputOferta",s.id="oferta"+(o+1)+"_"+e.orcamento.numeroOrcamento.toString(),s.value=e.orcamento.numeroOrcamento.toString();let c=document.createElement("label");c.setAttribute("for","oferta"+(o+1)+"_"+e.orcamento.numeroOrcamento.toString());let d=document.createElement("span");if(d.className="content",n.length||l.length||r.length){let e=[];d.style.pointerEvents="none",s.setAttribute("disabled","true");let t=document.createElement("div");t.classList.add("tooltip-error"),t.classList.add("wrap-aceitacao");let a=document.createElement("i");a.classList.add("aceitacao"),a.classList.add("fas"),a.classList.add("fa-exclamation"),l.length>0?l.forEach(t=>{e.push(t.mensagens.cliente)}):r.length>0?r.forEach(t=>{e.push(t.mensagens.cliente)}):n.length>0&&n.forEach(t=>{e.push(t.mensagens.cliente)}),t.dataset.descricao=e.join("\n"),t.appendChild(a),d.insertBefore(t,d.querySelector("*:first-child"))}else s.checked=!0;let u=document.createElement("ul");u.classList.add("conteudoOferta");let m=document.createElement("strong"),p=window.localStorage.getItem("personalizacaoOferta");m.innerHTML=p?"Vida do Seu Jeito":e.orcamento.rotulo;let g=document.createElement("span");g.classList.add("center-align"),g.innerHTML=e.orcamento.numeroOrcamento.toString();let f=document.createElement("li");f.className="liPrecoTotal";let h=document.createElement("ul");h.classList.add("lPrecoTotal"),"Viagem"!=e.orcamento.segmento&&h.classList.add("no-border");let S=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].retornosCalculo[0].precificacao.premio.total;if(S<0){let e=document.createElement("strong");e.innerHTML="O valor a ser restituído: "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(parseFloat(Math.abs(S))),h.appendChild(e)}else{let t=document.createElement("p");if(t.innerHTML="PRÊMIO E FORMAS DE PAGAMENTO:",h.appendChild(t),"Viagem"==e.orcamento.segmento){const t=a.get(e.orcamento.numeroOrcamento);let o=0,n=0;const l=t.retornosCalculo;l.length>=1&&l.forEach(e=>{e.precificacao.descontoAgravo.forEach(e=>{o="CUP"==e.tipo?e.monetario:o,n="CUP"==e.tipo?e.percentual:n})}),0!==o&&0!==n&&createPrecoElement(h,o)}let o={};if(e.parcelamentos.forEach(e=>{o[e.nomeFormaPagamento]||(o[e.nomeFormaPagamento]=[]),o[e.nomeFormaPagamento].push(e)}),"Individual"==e.orcamento.segmento){let{numeroOrcamento:t}=e.orcamento,a=window.localStorage.getItem("jsonResponseCalculo")?JSON.parse(window.localStorage.getItem("jsonResponseCalculo")):null;a.ofertas=a.ofertas.filter((function(e){return e.orcamento.numeroOrcamento===t}));let o={mensal:0,anual:0};calcularTotaisPremios(a.ofertas[0].retornosCalculo,o);let n="<strong>{title}: </strong><span>{value}</span>",l=document.createElement("li");l.className="precoTotal",l.innerHTML=n.replace("{title}","Prêmio Anual").replace("{value}",Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(parseFloat(o.anual.toFixed(2)))),h.appendChild(l),l=document.createElement("li"),l.className="precoTotal",l.innerHTML=n.replace("{title}","Prêmio Mensal").replace("{value}",Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(parseFloat(o.mensal.toFixed(2)))),h.appendChild(l);let r=document.createElement("p");r.innerHTML="Descontos por formas de pagamento:",h.appendChild(r),l=document.createElement("li"),l.className="precoTotal",l.innerHTML="<strong>Cartão Porto Seguro (desconto de 10%)</strong>",h.appendChild(l),l=document.createElement("li"),l.className="precoTotal",l.innerHTML="<strong>Cartão de Crédito (desconto de 5%)</strong>",h.appendChild(l),l=document.createElement("li"),l.className="precoTotal",l.innerHTML="<strong>Pagamento à vista ou em até 4 vezes desconto de 5%</strong>",h.appendChild(l)}else Object.entries(o).forEach(([e,t])=>{let a=document.createElement("li");a.className="precoTotal",a.innerHTML="<strong>"+e+": </strong>";let o=1e32,n=null;for(let e in t){let a=t[e],l=parseFloat(a.valorPrimeiraParcela);l=1===a.qtdParcelas?l:l+(a.qtdParcelas-1)*parseFloat(a.valorDemaisParcelas),l=l,l<o&&(o=l,n=a)}o&&(a.innerHTML+="<span>",a.innerHTML+=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(parseFloat(o.toFixed(2))),a.innerHTML+="</span>"),h.appendChild(a)})}f.appendChild(h);let E=e.regras.coberturas.map(e=>[e.prioridade,e.sigla]).sort((e,t)=>e[0]-t[0]),C=[];E.forEach((t,a)=>{C[a]=e.orcamento.garantiasAtuais.filter(e=>e.sigla==t[1]).shift()}),C=C.filter(e=>e);let O=void 0===C[0].tipoprotecao;if(C.forEach((t,a)=>{e.retornosCalculo[0].coberturas.filter(e=>t.sigla==e.sigla).shift();let o=e.regras.coberturas.filter(e=>t.sigla==e.sigla).shift();if(o){let e=document.createElement("li");e.className="cobertura",e.setAttribute("tipo",t.tipoprotecao);let a=document.createElement("strong");a.innerHTML=o?o.nome:"Nome não encontrado no JSON",o.descricao&&(a.classList.add("tooltip"),a.dataset.descricao=o.descricao,a.innerHTML+='<i class="fas fa-question-circle"></i>');let n=document.createElement("span");n.innerHTML=null!==t.valor?Intl.NumberFormat("pt-BR",{style:"currency",currency:t.moeda?t.moeda:"BRL"}).format(t.valor):"Sim",e.appendChild(a),e.appendChild(n),u.appendChild(e)}}),"Individual"==e.orcamento.segmento)if(O){let e=Array(...u.querySelectorAll(".cobertura"));u.innerHTML="",e.forEach(e=>{u.appendChild(e)})}else{let e=window.localStorage.getItem("jsonEntradaCalculo");e=JSON.parse(e).consultivo.codigoOfertaConsultiva,"APTLMK"==e&&inicializaProtecoesAptlmk(),"APTLMK"!=e&&inicializaProtecoes();let t=Array(...u.querySelectorAll(".cobertura"));console.log("coberturas: ",t),console.log("lista: ",u),u.innerHTML="",Object.entries(tipoProtecoes).forEach(([e,t])=>{let a=document.createElement("li");a.innerHTML+="<p><h6>"+t+"</h6></p>",a.className="tipoprotecao";let o=document.createElement("ul");o.setAttribute("tipo",e),a.appendChild(o),u.appendChild(a)}),t.forEach(e=>{let t=e.getAttribute("tipo"),a=u.querySelectorAll(".tipoprotecao [tipo='"+t+"']")[0];a&&a.appendChild(e)})}else{let e=document.createElement("ul");e.setAttribute("class","listaCobert");let t=Array(...u.querySelectorAll(".cobertura")).slice(0,3);u.innerHTML="",t.forEach(t=>{e.appendChild(t)}),u.appendChild(e)}if(d.appendChild(m),d.appendChild(g),e.regras.coberturas.length>3&&"Individual"!=e.orcamento.segmento){let t=document.createElement("div");t.classList.add("center-align");let a=document.createElement("i");a.classList.add("material-icons"),a.classList.add("left"),a.innerText="add_circle";let o=document.createTextNode("Coberturas"),n=document.createElement("a");n.href="#loaderMore",n.appendChild(a),n.appendChild(o),n.classList.add("modal-trigger"),n.classList.add("btn-flat"),n.classList.add("btnPortoSimple"),t.appendChild(n),u.appendChild(t),n.addEventListener("click",(function(t){let a=document.createElement("ul"),o=document.createElement("li");o.className="titleCobertura";let n=document.createElement("strong");n.innerHTML="Cobertura";let l=document.createElement("span");l.innerHTML="Capital",o.appendChild(n),o.appendChild(l),a.appendChild(o),C.forEach((t,o)=>{e.retornosCalculo[0].coberturas.filter(e=>t.sigla==e.sigla).shift();let n=e.regras.coberturas.filter(e=>t.sigla==e.sigla).shift();if(n){let e=document.createElement("li");e.className="cobertura";let o=document.createElement("strong");o.innerHTML=n?n.nome:"Nome não encontrado no JSON",n.descricao&&(o.classList.add("tooltip"),o.dataset.descricao=n.descricao,o.innerHTML+='<i class="fas fa-question-circle"></i>');let l=document.createElement("span");l.innerHTML=null!==t.valor?Intl.NumberFormat("pt-BR",{style:"currency",currency:t.moeda?t.moeda:"BRL"}).format(t.valor):"Sim",e.appendChild(o),e.appendChild(l),a.appendChild(e)}}),document.querySelector("#loaderMore .modal-content").innerHTML="",document.querySelector("#loaderMore .modal-content").appendChild(a)}))}let I=document.createElement("a");I.href="#loaderShare",I.innerText="Compartilhar",I.classList.add("modal-trigger"),I.classList.add("btnPortoSuccess"),I.classList.add("hidden"),I.setAttribute("id",o),u.appendChild(f);let L=0,y=document.createElement("div");if(y.classList.add("row"),e.orcamento.customizavel){let a=document.createElement("button");a.innerHTML="Personalizar",a.classList.add("btnPortoDefaultB","col","s12"),null!=t&&1==t.tarefa?paginaPersonalizar(a,e.orcamento.numeroOrcamento.toString(),t.numOrcamento):paginaPersonalizar(a,e.orcamento.numeroOrcamento.toString(),numOrcamentoPersonaliz),y.appendChild(a),L++}let b=document.querySelectorAll('div[sigla="TELEMED"]');for(let e=0;e<b.length;e++)b[e].style.display="none";let A=document.querySelectorAll(".moneyMask");for(i=0;i<A.length;i++)A[i].value=VMasker.toMoney(A[i].value);if(e.orcamento.gerarDocumento){let{segmento:t}=e.orcamento;if(t){let a=document.createElement("a");if("Viagem"==t){let t=JSON.parse(window.localStorage.getItem("dadosUsuario")),{numeroOrcamento:o}=e.orcamento,n=window.localStorage.getItem("jsonResponseCalculo")?JSON.parse(window.localStorage.getItem("jsonResponseCalculo")):null;n.ofertas=n.ofertas.filter((function(e){return e.orcamento.numeroOrcamento===o}));let l="",r="",i="",s=[];n.ofertas[0].parcelamentos.forEach(e=>{console.log("p.qtdParcelas "+e.qtdParcelas);let t={};t.opcao=e.opcao,t.qtdParcelas=e.qtdParcelas,t.valorPrimeiraParcela=e.valorPrimeiraParcela,t.valorDemaisParcelas=e.valorDemaisParcelas,s.push(t)}),console.log("arrParcelamento "+JSON.stringify(s)),obterCoberturas(n),console.log("coberturas arrCoberturaOrc - qtd "+arrCoberturaOrc.length),console.log(JSON.stringify(arrCoberturaOrc)),t.forEach(e=>{"DICIO_NOME"==e.id&&(l=e.conteudo.trim()),"DICIO_NOMESOCIAL"==e.id&&(r=e.conteudo?e.conteudo.trim():""),"ORIGEM"==e.id&&(i=e.conteudo.trim())}),a.addEventListener("click",t=>{t.preventDefault();let a="/apex/OrcamentoPage?numeroOrcamento="+e.orcamento.numeroOrcamento,o=document.createElement("form");o.action=a,o.method="POST",o.style.display="none",o.target="_blank";let c=document.createElement("input");c.name="nomePDF",c.value=l,o.appendChild(c);let d=document.createElement("input");d.name="nomeSocialPDF",d.value=r,o.appendChild(d);let u=document.createElement("input");u.name="origemPDF",u.value=i,o.appendChild(u);let m=document.createElement("input");m.name="cotacaoPDF",m.value="BRL"==n.ofertas[0].orcamento.resultadoIntegracoes.IndiceMonetario.ItensCotacao[0].moedaOrigem?"-":n.ofertas[0].orcamento.resultadoIntegracoes.IndiceMonetario.ItensCotacao[0].cotacao,o.appendChild(m);let p=document.createElement("input");p.name="moedaOrigem",p.value="BRL"!=n.ofertas[0].orcamento.resultadoIntegracoes.IndiceMonetario.ItensCotacao[0].moedaOrigem?n.ofertas[0].orcamento.resultadoIntegracoes.IndiceMonetario.ItensCotacao[0].moedaOrigem:"",o.appendChild(p);let g=document.createElement("input");g.name="parcelamentoPDF",g.value=JSON.stringify(s),o.appendChild(g);let f=document.createElement("input");f.name="coberturasPDF",f.value=JSON.stringify(arrCoberturaOrc),o.appendChild(f);let h={};e.parcelamentos.forEach(e=>{e.codigo>=0&&!h[e.codigo]&&(h[e.codigo]=[]),h[e.codigo].push(e)});for(let e in h){let t=null;for(const a of h[e]){let e=parseFloat(a.valorPrimeiraParcela);1!==a.qtdParcelas&&(e+=(a.qtdParcelas-1)*parseFloat(a.valorDemaisParcelas)),(!t||e<t)&&(t=e,parcelaMenorForma=a)}if(t){let a=document.createElement("input");a.name=camelCase(e),a.value=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(parseFloat(t.toFixed(2))),o.appendChild(a)}}document.querySelector("body").appendChild(o),o.submit()})}else if("Individual"==t){a.setAttribute("href","/apex/OrcamentoVidaPage?numeroOrcamento="+e.orcamento.numeroOrcamento);let t=JSON.parse(window.localStorage.getItem("dadosUsuario")),o="",n="",l="",r="",i="",s="",c="",d="",u="";for(let e of t)"DICIO_NOME"==e.id&&(o=e.conteudo.trim()),"DICIO_NOMESOCIAL"==e.id&&(n=e.conteudo?e.conteudo.trim():""),"DICIO_SEXO"==e.id&&(l=e.conteudo.trim()),"DICIO_DATANASCIMENTO"==e.id&&(s=e.conteudo.trim()),"DICIO_FUMANTE"==e.id&&(c=e.conteudo.trim()),"DICIO_PROFISSAO"==e.id&&(i=e.conteudo.trim()),"DICIO_RENDA"==e.id&&(r=e.conteudo.trim()),"DICIO_REGIME_TRABALHO"==e.id&&(u=e.conteudo.trim()),"DICIO_DEPENDENTES"==e.id&&(d=e.conteudo);a.addEventListener("click",t=>{t.preventDefault();let a="/apex/OrcamentoVidaPage?numeroOrcamento="+e.orcamento.numeroOrcamento,m=document.createElement("form");m.action=a,m.method="POST",m.style.display="none",m.target="_blank";let p=document.createElement("input");p.name="nomeSeguradoPDF",p.value=o,m.appendChild(p);let g=document.createElement("input");g.name="nomeSocialSeguradoPDF",g.value=n,m.appendChild(g);let f=document.createElement("input");f.name="sexoSeguradoPDF",f.value=l,m.appendChild(f);let h=document.createElement("input");h.name="rendaSeguradoPDF",h.value=r,m.appendChild(h);let S=document.createElement("input");S.name="ocupacaoSeguradoPDF",S.value=i,m.appendChild(S);let v=document.createElement("input");v.name="nascimentoSeguradoPDF",v.value=s,m.appendChild(v);let E=document.createElement("input");E.name="fumanteSeguradoPDF",E.value=c,m.appendChild(E);let C=document.createElement("input");C.name="dependenteSeguradoPDF",C.value=d,m.appendChild(C);let O=document.createElement("input");O.name="formaTrabalhoSeguradoPDF",O.value=u,m.appendChild(O),document.querySelector("body").appendChild(m),m.submit()})}a.setAttribute("target","_blank");let o=document.createElement("button");o.innerHTML="Gerar PDF - orçamento",o.classList.add("btnPortoDefaultB","col","s12"),a.appendChild(o),y.appendChild(a),L++}}2==L&&u.classList.add("doisBotoes"),d.appendChild(u),d.appendChild(document.createElement("br")),d.appendChild(y),d.appendChild(I),c.appendChild(d),v.appendChild(s),v.appendChild(c),inicializaModal()}),numOrcamentoPersonaliz=null,null!=segmentoOfertas&&"Individual"!=segmentoOfertas){C=document.createElement("div"),C.classList.add("containerInformativo"),C.classList.add("center-align");let e=document.createElement("a");e.href="https://www.portoseguro.com.br/seguro-viagem",e.innerText="Condições Gerais e Manual de Assistência Emergencial",e.setAttribute("target","_blank");let t=document.createElement("p");t.innerHTML="<b>Importante</b>: As coberturas de seguro e serviços de assistência possuem restrições para indenização e/ou prestação de serviços, com riscos excluídos. Consulte as "+e.outerHTML+" do plano escolhido.";let a=document.createElement("ol"),o=document.createElement("li");o.innerHTML="Valores calculados em reais, considerando o câmbio do dia da cotação.";let n=document.createElement("li");n.innerHTML="Orçamento válido somente para a data da cotação",a.appendChild(o),a.appendChild(n),C.appendChild(t),C.appendChild(a)}}else d.innerHTML="Não foi possível encontrar ofertas, confira os motivos e realize as correções necessárias",L.forEach(e=>{let t=document.createElement("span");t.classList.add("label-error"),t.classList.add("col"),t.classList.add("s12"),t.innerHTML=e,v.appendChild(t)}),window.localStorage.removeItem("personalizacaoOferta"),voltarPersonalizError=!0;let y=document.createElement("div");y.classList.add("containerButtons");let b=document.createElement("button");b.classList.add("change-step"),b.classList.add("btnPortoSuccessB"),b.innerHTML="Voltar",b.dataset.destino="null",b.addEventListener("click",e=>{console.log("voltar tela de confirmação da proposta: "),null!==localStorage.getItem("personalizacaoOferta")&&localStorage.removeItem("personalizacaoOferta"),null!==localStorage.getItem("personalizarOfertaData")&&localStorage.removeItem("personalizarOfertaData"),arrCoberturaOrc=[];let t=null===window.localStorage.getItem("entradaConsultivo")?null:JSON.parse(window.localStorage.getItem("entradaConsultivo")),a=null===window.localStorage.getItem("payload")?null:JSON.parse(window.localStorage.getItem("payload"));if(void 0===voltarPersonalizError){}if(null!=numOrcamentoPersonaliz&&1==voltarPersonalizError){console.log("numOrcamentoPersonaliz",numOrcamentoPersonaliz),console.log("voltarPersonalizError",voltarPersonalizError),numOrcamentoPersonaliz=null,voltarPersonalizError=null,document.querySelectorAll(".produtos").forEach(e=>{e.classList.contains("off")&&(e.innerHTML="")}),voltarPersonaliz=!0,geraProdutos(!1,null)}else null!=t&&null!=a?"eds"==t.consultivo.segmento?"VIAGEM"==t.consultivo.codigoOfertaConsultiva?redirecionaEndossoViagem(a.idContrato):redirecionaEndosso(a.idContrato):(console.log("caiu else 1"),irPasso(1,0),changeStep(caminho[caminho.length-1])):(console.log("caiu else 2"),irPasso(1,0),changeStep(caminho[caminho.length-1]))});let A=document.createElement("button");A.classList.add("change-step"),A.classList.add("btnPortoSuccess"),A.innerHTML="ELABORAR PROPOSTA",A.addEventListener("click",e=>{carregamento.classList.add("on");let t=document.querySelector('input[name="inputOferta"]:checked');if(t){JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas.filter(e=>e.orcamento.numeroOrcamento==t.value).shift();window.localStorage.setItem("ofertaSelecionada",t.value),setTimeout((function(){carregamento.classList.remove("on"),irPasso(1,2),redirecionarTela()}),1e3)}else carregamento.classList.remove("on"),alert("Selecione uma oferta")}),O?(y.appendChild(b),y.appendChild(A),c.appendChild(v),c.appendChild(C),c.appendChild(y),c.prepend(f)):(b.innerHTML="Voltar para corrigir",y.appendChild(b),c.appendChild(v),c.appendChild(y),null==numOrcamentoPersonaliz&&window.localStorage.removeItem("jsonEntradaCalculo")),a.appendChild(c),e&&gerarJsonCompleto(),null!=t&&2==t.tarefa&&(window.localStorage.setItem("ofertaSelecionada",t.numOrcamento),setTimeout((function(){irPasso(1,2),redirecionarTela(),setTimeout((function(){carregamento.classList.remove("on"),carregamento.querySelector(".loader").classList.remove("hidden"),carregamento.querySelector(".message").classList.add("hidden"),carregamento.querySelector(".message p").innerHTML=""}),1e3)}),1e3))}else window.localStorage.removeItem("jsonEntradaCalculo"),a.classList.add("on"),carregamento.querySelector(".loader").classList.add("hidden"),carregamento.querySelector(".message").classList.remove("hidden"),carregamento.querySelector(".message p").innerHTML=[...new Set(JSON.parse(document.getElementById("Ofertas").value).message.split(".,"))].filter(e=>""!=e.trim()).join("<br>");ajustarAreaCoberturas()}function createPrecoElement(e,t){let a=-1*t,o=document.createElement("li");o.className="precoTotal",o.innerHTML="<strong> Cupom de Desconto:</strong>"+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a),e.appendChild(o)}function obterCoberturas(e){try{let t="",a="",o=new Map,n=new Map,l=new Map,r=new Map;if(null!=e&&("individual"==e.ofertas[0].orcamento.segmento.toLowerCase()||"viagem"==e.ofertas[0].orcamento.segmento.toLowerCase())){console.log("segmento "+e.ofertas[0].orcamento.segmento.toLowerCase());let i=[];e.ofertas.forEach(e=>{i.push(e.orcamento.numeroOrcamento),n.set(e.orcamento.numeroOrcamento,e.orcamento.rotulo)}),e.ofertas.forEach(e=>{e.retornosCalculo.forEach(t=>{let a=!1;t.precificacao.descontoAgravo.forEach(e=>{console.log("tipo "+e.tipo+" - "+e.percentual),"FPG"==e.tipo&&0==e.percentual&&(a=!0)}),a?l.set(e.orcamento.numeroOrcamento,t.precificacao.premio.total):l.has(e.orcamento.numeroOrcamento)||l.set(e.orcamento.numeroOrcamento,null)})}),i.forEach(n=>{console.log("numeTestNovo "+n);let l=e.ofertas.find(e=>e.orcamento.orcnum==n);l&&(console.log("achou orcamento "+l.orcamento.rotulo),l.orcamento.contratantes[0].grupos[0].coberturas.forEach(e=>{r.set(n,e.moeda),console.log("item "+e.sigla+" "+e.moeda+" "+e.valor+" "+e.tipoGarantia),"Assistência"==e.tipoGarantia?t="Sim":(t=e.valor,a=null!=e.valor?e.valor.toLocaleString("pt-br",{minimumFractionDigits:2}):0);let l=[];o.has(n)?(l=o.get(n),l.push({sigla:e.sigla,moeda:e.moeda,selecionado:!1,valor:t,valorFormatado:a}),o.set(n,l)):(l.push({sigla:e.sigla,moeda:e.moeda,selecionado:!1,valor:t,valorFormatado:a}),o.set(n,l))}))}),console.log("size map "+o.size),i.forEach(e=>{console.log(e);let t=o.get(e);arrCoberturaOrc.push({orcamento:e,rotulo:n.get(e),selecionado:!1,premioTotal:r.get(e)+" "+l.get(e),coberturas:t})})}return arrCoberturaOrc}catch(e){return console.error("error-> "+e),"error"}}function gerarJsonCompleto(){let e=window.localStorage.getItem("jsonResponseCalculo")?JSON.parse(window.localStorage.getItem("jsonResponseCalculo")):null;if(null!=e&&("individual"==e.ofertas[0].orcamento.segmento.toLowerCase()||"viagem"==e.ofertas[0].orcamento.segmento.toLowerCase())){let t=window.localStorage.getItem("entradaConsultivo")?JSON.parse(window.localStorage.getItem("entradaConsultivo")):null,a=window.localStorage.getItem("jsonMdtGrupo")?JSON.parse(window.localStorage.getItem("jsonMdtGrupo")):null,o=window.localStorage.getItem("conjuntosJson")?JSON.parse(window.localStorage.getItem("conjuntosJson")):null,n=window.localStorage.getItem("jsonServicos")?JSON.parse(window.localStorage.getItem("jsonServicos")):null,l=window.localStorage.getItem("jsonEntradaCalculo")?JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")):null,r=window.localStorage.getItem("caminhoTomado")?JSON.parse(window.localStorage.getItem("caminhoTomado")):null,i=window.localStorage.getItem("dadosUsuario")?JSON.parse(window.localStorage.getItem("dadosUsuario")):null,s=[];e.ofertas.forEach(e=>{s.push(e.orcamento.numeroOrcamento)});let c={entradaConsultivo:t,jsonMdtGrupo:a,conjuntosJson:o,jsonServicos:n,jsonEntradaCalculo:l,jsonResponseCalculo:e,caminhoTomado:r,dadosUsuario:i};callGravaJson(JSON.stringify(c),JSON.stringify(s))}}function paginaPersonalizar(e,t,a){const o=C();let n=window.localStorage.getItem("CallPersonalizeFirstTime"),l=function(){let e=document.createElement("section");e.classList.add("personalize-orcamento"),e.id="personalizar-orcamento-"+t,e.innerHTML="<h2 class='Header-personalizar-orcamento1'> Personalize Sua Oferta </h2> <h2 class='Header-personalizar-orcamento2' hidden> Personalizar - "+o.orcamento.rotulo+"</h2>";let a=document.createElement("div");a.className="personalizar-orcamento-headers";let n=document.createElement("div");n.className="personalizar-orcamento-headers-name",n.innerHTML="<h3>Cobertura</h3>";let l=document.createElement("div");return l.className="personalizar-orcamento-headers-itens",l.innerHTML="<h3>Capital</h3>",a.appendChild(n),a.appendChild(l),e.appendChild(a),e}();const r=function(){var{garantiasAtuais:e}=o.orcamento;null!=e&&null!=e||(e=[]);var t={};const a=getOfertaPersonalizada();return e.forEach(e=>{const{sigla:o,caracteristicaespecialvalor:n}=e,l=a[o]??e.valor;t[o]={valor:l,caracteristicaespecialvalor:n},console.log("sigla",o)}),t}(),s=[];null!=a&&t==a&&(l.classList.add("show"),document.documentElement.scrollTop=0,document.querySelector("body").classList.add("no-scroll"));let c=window.localStorage.getItem("CallPersonalize"),d=window.localStorage.getItem("personalizacaoOferta");"True"!=c||d||"yes"!=n||(l.classList.add("show"),document.documentElement.scrollTop=0,document.querySelector("body").classList.add("no-scroll"),window.localStorage.setItem("CallPersonalizeFirstTime","No")),e.onclick=()=>{let e=document.querySelectorAll(".Header-personalizar-orcamento1"),t=document.querySelectorAll(".Header-personalizar-orcamento2");e.forEach(e=>{e.classList.add("hidden")}),t.forEach(e=>{e.removeAttribute("hidden")}),l.classList.add("show"),document.documentElement.scrollTop=0,document.querySelector("body").classList.add("no-scroll")};let u=o.regras.coberturas.map(e=>[e.prioridade,e.sigla]).sort((e,t)=>e[0]-t[0]),m=[];u.forEach((e,t)=>{m[t]=o.regras.coberturas.filter(t=>t.sigla==e[1]).shift()}),m.forEach((e,a)=>{let o=!!r[e.sigla],n=O({...e},o);if(s.push(n),l.appendChild(n),null!=e.franquias&&e.franquias.length>0&&"DIH"!=e.sigla){let a={idCampo:`select-franquia-${e.sigla}-${t}`,canDisable:!1,titulo:"Franquia: ",descricao:null,tipo:"select-option",obrigatorio:!1,opcoes:[]};e.franquias.forEach(e=>{a.opcoes.push({rotulo:e.descricao,valor:e.valor,selecionado:e.selecionado})}),l.appendChild(L(a))}if(null!=e.caracteristicaespecial){const a=`range-caracteristicaespecial-${e.sigla}-${t}`,o="personalize-"+a;idCamposEspeciais.push(o);const n=JSON.parse(localStorage.getItem(PERSONALIZAR_OFERTA_KEY))||{},i=n[o],s=r[e.sigla]?r[e.sigla].caracteristicaespecialvalor:e.caracteristicaespecial.limiteMinimo,c=i??s;setTimeout(()=>{document.querySelectorAll('[id^="personalize-swithcher"]').forEach(e=>{const{id:t}=e;if(t in n){e.checked=n[t];const a=new Event("change");e.dispatchEvent(a)}})});let d={idCampo:a,canDisable:!1,titulo:"Caracteristica Especial: ",descricao:null,tipo:"range",obrigatorio:!1,range:{simbolo:e.caracteristicaespecial.tipo+" ",step:null,limiteMinimo:e.caracteristicaespecial.limiteMinimo,limiteMaximo:e.caracteristicaespecial.limiteMaximo,valor:c}};console.log("garantiasValueSugestions",r),console.log("cobertura.sigla",e.sigla),l.appendChild(L(d))}});let p=document.createElement("div");p.className="personalizar-orcamento-headers";let g=document.createElement("div");g.className="personalizar-orcamento-headers-full",g.innerHTML="<h3>Comissionamento</h3>",p.appendChild(g),l.appendChild(p);let f=JSON.parse(window.localStorage.getItem("jsonResponseCalculo"));f=f.ofertas.filter(e=>e.orcamento.numeroOrcamento==t).shift();let h={nome:"range-comissao-"+t,descricao:"Qual o percentual do comissionamento (máx. 40%): ",limiteMaximo:40,limiteMinimo:0,opcoes:null};l.appendChild(I(h));let S=f.orcamento.remuneracoes.filter(e=>"AGENCIAMENTO"==e.tipoRemuneracao).shift(),v=0;if(null!=S){v=S.percentual;let e={nome:"select-agenciamento-"+t,descricao:"Selecione o percentual do agenciamento:",limiteMaximo:null,limiteMinimo:null,opcoes:[]};e.opcoes.push({rotulo:"0",valor:0,selecionado:0==v}),e.opcoes.push({rotulo:"100",valor:100,selecionado:100==v}),e.opcoes.push({rotulo:"200 (Comissão máxima 35%)",valor:200,selecionado:200==v}),l.appendChild(I(e))}return l.appendChild(function(){let e=document.createElement("button");e.className="btnPortoDefault",e.innerHTML="Ofertas da Porto",e.onclick=()=>{document.documentElement.scrollTop=0,l.classList.remove("show"),document.querySelector("body").classList.remove("no-scroll");for(let t=0;t<s.length;t++){let a=s[t].querySelector("input[type=checkbox]"),o=s[t].querySelector("input[type=number]"),n=s[t].querySelector("input[type=range]");s[t].getAttribute("fieldSugestionValue");var e=a.id.split("-");e.shift(),e.join("-"),checkboxSigla=e[1],a.checked=!!r[checkboxSigla],o&&(o.value=parseFloat(s[t].getAttribute("fieldSugestionValue")).toFixed(2),o.disabled=o.getAttribute("min")==o.getAttribute("max"),o.classList.remove("invalid")),n&&(n.value=parseFloat(s[t].getAttribute("fieldSugestionValue")).toFixed(2),n.disabled=n.getAttribute("min")==n.getAttribute("max"))}};const o=(e,t)=>{const a=getOfertaPersonalizada();a[e]=t,localStorage.setItem(PERSONALIZAR_OFERTA_KEY,JSON.stringify(a))};let n=document.createElement("button");n.className="btnPortoDefault",n.innerHTML="Calcular",n.onclick=()=>{document.querySelector("body").classList.remove("no-scroll");let e=0,n=0,r=[],i=[],c=[];for(let t=0;t<s.length;t++){var d=s[t],u=d.getAttribute("caracteristica"),m=d.getAttribute("nome"),p=d.querySelector("#"+d.id),g=p?p.getAttribute("min"):0,f=p?p.getAttribute("max"):0;let a=d.getAttribute("checkboxStatus"),l=document.getElementById(a).checked;if("Principal"==u&&(r.push(m),n+=1,l||(e+=1)),l){let e=0;null!=p&&(e=p.value.replaceAll(".",""),e=e.replaceAll(",","."),e=parseInt(e)),e>=parseInt(g)&&e<=parseInt(f)?i.push({caracteristica:u,limitemaximo:f,limiteminimo:g,moeda:"BRL",sigla:d.getAttribute("sigla"),valor:e?"valueInputPayload":0}):c.push(m),o(d.getAttribute("sigla"),e),console.log("valueInputPayload",e),console.log("categoryName",m),console.log("sigla",d.getAttribute("sigla"))}}idCamposEspeciais.forEach(e=>{try{const t=document.getElementById(e).value;o(e,t)}catch(e){console.error}});if(document.querySelectorAll('[id^="personalize-swithcher"]').forEach(e=>{const{id:t,checked:a}=e;o(t,a)}),0!=c.length){let e="As garantias abaixo estão com o valor de capital fora do limite permitido: <br/><ul>";for(let t=0;t<c.length;t++)e+="<li>• "+c[t]+"</li>";return e+="</ul>",E(e)}if(n==e){let e="Ao menos 1 das garantias/coberturas deve ser selecionada: <br/><ul>";for(let t=0;t<r.length;t++)e+="<li>• "+r[t]+"</li>";return e+="</ul>",E(e)}l.classList.remove("show");let h,S,v=window.localStorage.getItem("jsonResponseCalculo");document.getElementById("Ofertas").value=v,h=JSON.parse(v),null!=a?(S=h.ofertas.filter(e=>e.orcamento.numeroOrcamento==a).shift(),void 0===S&&(S=h.ofertas[0])):(S=h.ofertas.filter(e=>e.orcamento.numeroOrcamento==t).shift(),void 0===S&&(S=h.ofertas[0])),S.consultivo=null,delete S.retornosCalculo,delete S.parcelamentos,delete S.regras,delete S.retornoAceitacao,delete S.orcamento.versoesCalculos,delete S.orcamento.resultadoIntegracoes,delete S.orcamento.numeroOferta,delete S.orcamento.numeroOrcamento,delete S.orcamento.orcnum;try{"Individual"==S.orcamento.segmento&&delete S.orcamento.precificacao}catch(e){}if(S.orcamento.contratantes[0].grupos[0].coberturas=i,"Viagem"==S.orcamento.segmento){let e,a=S.orcamento.contratantes[0].grupos[0].coberturas;for(e=a.length-1;e>=0;--e){let o=document.querySelector("#personalize-input-"+a[e].sigla+"-"+t);if(o){if(o.querySelector("#personalize-swithcher-"+a[e].sigla+"-"+t).checked){let n=document.querySelector("#personalize-select-franquia-"+a[e].sigla+"-"+t),l=document.querySelector("#personalize-range-caracteristicaespecial-"+a[e].sigla+"-"+t);if(o){let t=o.children[2].children[1].value.replaceAll(".","");t=t.replaceAll(",","."),a[e].valor=o.children[2].children[1]?t:0}n&&(a[e].franquia=n.children[0]?n.children[0].value:0),l&&(a[e].caracteristicaespecialvalor=l.value,a[e].caracteristicaespecialtipo=l.parentElement.textContent.trim())}else a.splice(e,1)}else a.splice(e,1)}S.orcamento.contratantes[0].grupos[0].coberturas=a}else{let e,a=i;for(e=a.length-1;e>=0;--e){let o=document.querySelector("#personalize-input-"+a[e].sigla+"-"+t);if(o){if(o.querySelector("#personalize-swithcher-"+a[e].sigla+"-"+t).checked){let n=document.querySelector("#personalize-select-franquia-"+a[e].sigla+"-"+t),l=document.querySelector("#personalize-range-caracteristicaespecial-"+a[e].sigla+"-"+t);if(o){let t=o.children[2].children[1].value.replaceAll(".","");t=t.replaceAll(",","."),a[e].valor=o.children[2].children[1]?t:0}n&&(a[e].franquia=n.value),l&&(a[e].caracteristicaespecialvalor=l.value,a[e].caracteristicaespecialtipo=l.parentElement.textContent.trim())}else a.splice(e,1)}else a.splice(e,1)}S.orcamento.contratantes[0].grupos[0].segurados[0].coberturas=a,console.log("json Personalizar",S)}let C=JSON.parse(window.localStorage.getItem("dadosUsuario"));S.orcamento.remuneracoes.forEach(e=>{if("CORRETAGEM"==e.tipoRemuneracao){let a=document.querySelector("#personalize-input-comissao-"+t);e.percentual=parseInt(a.value),null!=C&&(C.find(e=>"DICIO_CORRETAGEM"==e.id).conteudo=a.value)}else if("AGENCIAMENTO"==e.tipoRemuneracao){let a=document.querySelector("#personalize-select-agencia-"+t);e.percentual=parseInt(a.value),null!=C&&(C.find(e=>"DICIO_AGENCIAMENTO"==e.id).conteudo=a.value)}}),null!=C&&window.localStorage.setItem("dadosUsuario",JSON.stringify(C));const O=document.querySelector(".modalLoaderErro");O&&O.classList.add("on"),numOrcamentoPersonaliz=t,jsonOfertaAtual=window.localStorage.getItem("jsonResponseCalculo"),window.localStorage.setItem("personalizacaoOferta",JSON.stringify(S)),callOfertaPersonalizada(JSON.stringify(S))};let i=document.createElement("div");return i.className="btn-container",i.appendChild(e),i.appendChild(n),i}()),document.querySelector(".personalize-oferta-container").appendChild(l),o.regras.coberturas.forEach(e=>{let a=document.getElementById("personalize-swithcher-"+e.sigla+"-"+t);if(a&&a.checked){var o=new Event("change");a.dispatchEvent(o)}}),void inicializaSelects();function E(e){let t=document.querySelector(".modalLoaderErro");t.classList.add("on"),t.querySelector(".message").classList.add("on"),t.querySelector(".message").classList.remove("hidden"),t.querySelector(".loader").classList.add("hidden"),t.querySelector(".message p").innerHTML=e,t.querySelector(".message .close").addEventListener("click",e=>{t.classList.remove("on"),t.querySelector(".loader").classList.remove("hidden"),t.querySelector(".message").classList.add("hidden"),t.querySelector(".message p").innerHTML=""})}function C(){return JSON.parse(window.localStorage.getItem("jsonOfertasMin")).ofertas.filter(e=>e.orcamento.numeroOrcamento==t).shift()}function O(e={nome:null,descricao:null,obrigatorio:null,sigla:null,limiteMaximo:null,limiteMinimo:null,caracteristica:null},a){const{nome:o,descricao:n,obrigatorio:l,sigla:s,limiteMinimo:c,limiteMaximo:d,caracteristica:u}=e,m=r[s]?r[s].valor:null,p=document.createElement("div");p.className="container-input",p.setAttribute("id","personalize-input-"+s+"-"+t),p.setAttribute("caracteristica",u),p.setAttribute("nome",o),p.setAttribute("sigla",s),p.setAttribute("obrigatorio","personalize-obrigatorio-"+l),p.setAttribute("fieldSugestionValue",m||d),p.setAttribute("checkboxStatus","personalize-swithcher-"+s+"-"+t);const g=function(e){const a=document.createElement("div");a.className="switch";const o=document.createElement("label"),n=document.createElement("input");n.setAttribute("type","checkbox"),n.id=`personalize-swithcher-${s}-${t}`,n.checked=e,n.disabled=l,0==l&&(n.onchange=()=>function(e){let t=f.querySelector("input"),a=h.querySelector("input"),o=s,n=C(),l=n.orcamento.numeroOrcamento;const u=[],p=[];if(n.regras.coberturas.forEach(e=>{e.sigla==o&&(e.includentes&&u.push(e.includentes),e.excludentes&&p.push(e.excludentes))}),e){for(i=0;i<u.length;i++){let e=document.getElementById("personalize-swithcher-"+u[i]+"-"+l),t=document.querySelector("#personalize-input-"+u[i]+"-"+l),a=r[u[i]]?r[u[i]].valor:null;e&&(e.checked=!0,handlePersonalizeInput(t,a,!0))}for(i=0;i<p.length;i++){let e=document.getElementById("personalize-swithcher-"+p[i]+"-"+l),t=document.querySelector("#personalize-input-"+p[i]+"-"+l);e&&(e.checked=!0,handlePersonalizeInput(t,null,!1))}}else{for(i=0;i<u.length;i++){let e=document.getElementById("personalize-swithcher-"+u[i]+"-"+l),t=document.querySelector("#personalize-input-"+u[i]+"-"+l);e&&["IPA","BAS"].includes(u[i])&&(e.checked=!1,handlePersonalizeInput(t,null,!1))}n.regras.coberturas.forEach(e=>{if(e.includentes.includes(o)){let t=document.getElementById("personalize-swithcher-"+e.sigla+"-"+l),a=document.querySelector("#personalize-input-"+e.sigla+"-"+l);t&&"BAS"!=e.sigla&&(t.checked=!1,handlePersonalizeInput(a,null,!1))}})}n.regras.coberturas.forEach(t=>{t.excludentes.includes(o)&&1==e&&(document.getElementById("personalize-swithcher-"+t.sigla+"-"+l).checked=!1)}),t&&(t.classList.remove("invalid"),e?(t.value=parseFloat(m||d).toFixed(2),//!OK
t.value=VMasker.toMoney(t.value),t.disabled=c==d):(t.value=0,t.disabled=!0));a&&(e?(a.value=m||d,a.disabled=c==d):(a.value=0,a.disabled=!0))}(n.checked));const u=document.createElement("span");return u.className="lever",o.appendChild(n),o.appendChild(u),a.appendChild(o),a}(a),f=function(e){const a=document.createElement("div");if(a.className="input-field",null==c||null==d)return a;const o=document.createElement("i");o.className="prefix",o.innerHTML="R$ ";const n=document.createElement("input");n.setAttribute("type","text"),n.setAttribute("min",c),n.setAttribute("max",d),n.id=`personalize-input-${s}-${t}`,n.disabled=!e,n.classList.add("moneyMask"),n.value=n.disabled?0:c==d?d:m||d;let l=document.createElement("span");return l.className="helper-text",l.setAttribute("data-error","Valor fora dos limites permitidos"),l.setAttribute("data-success",""),n.onkeyup=()=>function(e,t){let a=f.querySelector("input"),o=a.selectionStart,n=h.querySelector("input"),l=VMasker.toMoney(t),r=l.split("."),i=!1,s=!1;8==e.keyCode?3==r[0].length&&(s=!0):1==r[0].length&&(i=!0);let u=l.replaceAll(".","");u=u.replaceAll(",","."),u=parseFloat(u),u<c||u>d?a.classList.add("invalid"):(a.classList.remove("invalid"),n.value=u);if(a.value=l,e.keyCode>=37&&e.keyCode<=40)return;i?a.setSelectionRange(o+1,o+1):s?a.setSelectionRange(o-1,o-1):a.setSelectionRange(o,o)}(this.event,n.value),a.appendChild(o),a.appendChild(n),a.appendChild(l),a}(a),h=function(e){const a=document.createElement("div");if(a.className="range-field",null==c||null==d)return a;const o=document.createElement("input");o.id=`personalize-range-${s}-${t}`,o.setAttribute("type","range"),o.setAttribute("min",c),o.setAttribute("max",d),o.disabled=!e,o.value=o.disabled?0:m||d,o.onchange=()=>function(e){let t=f.querySelector("input");e=VMasker.toMoney(e+"00"),t&&(t.classList.remove("invalid"),t.value=e)}(o.value);let n=document.createElement("span");n.className="range-limite-legend-min",n.innerHTML="R$ "+c.toLocaleString("pt-br",{minimumFractionDigits:2});let l=document.createElement("span");return l.className="range-limite-legend-max",l.innerHTML="R$ "+d.toLocaleString("pt-br",{minimumFractionDigits:2}),a.appendChild(n),a.appendChild(l),a.appendChild(o),a}(a);return p.appendChild(g),p.appendChild(function(){let e=document.createElement("strong");e.innerHTML=o,n&&(e.classList.add("tooltip"),e.dataset.descricao=n,e.innerHTML+='<i class="fas fa-question-circle"></i>');let t=document.createElement("div");return t.className="header-input",t.appendChild(e),t}()),p.appendChild(f),p.appendChild(h),p}function I(e={nome:null,descricao:null,limiteMaximo:null,limiteMinimo:null,opcoes:[]}){const{nome:a,descricao:o,limiteMinimo:n,limiteMaximo:l,opcoes:r}=e,i=document.createElement("div");i.className="container-input",i.setAttribute("id",a),i.appendChild(function(){const e=document.createElement("div");e.className="switch";const a=document.createElement("label"),o=document.createElement("input");o.setAttribute("type","checkbox"),o.id="personalize-swithcher-COMISSAO-"+t,o.checked=!0,o.disabled=!0;const n=document.createElement("span");return n.className="lever",a.appendChild(o),a.appendChild(n),e.appendChild(a),e}()),i.appendChild(function(e){let t=document.createElement("strong");t.innerHTML=e;let a=document.createElement("div");return a.className="header-input",a.appendChild(t),a}(o));var s=null,c=null;if(null!=n&&null!=l){let e=f.orcamento.remuneracoes.filter(e=>"CORRETAGEM"==e.tipoRemuneracao).shift();s=function(e,a,o){const n=document.createElement("div");n.className="input-field";const l=document.createElement("i");l.className="prefix",l.innerHTML=" ";const r=document.createElement("input");r.setAttribute("type","number"),r.setAttribute("min",e),r.setAttribute("max",a),r.id="personalize-input-comissao-"+t,r.disabled=!1,r.value=r.disabled?0:e==a?a:o||a;let i=document.createElement("span");return i.className="helper-text",i.setAttribute("data-error","Valor fora dos limites permitidos"),i.setAttribute("data-success",""),r.onchange=()=>d(r.value),n.appendChild(l),n.appendChild(r),n.appendChild(i),n}(n,l,e.percentual),c=function(e,a,o){const n=document.createElement("div");if(n.className="range-field",null==e||null==a)return n;const l=document.createElement("input");l.id="personalize-range-COMISSAO-"+t,l.setAttribute("type","range"),l.setAttribute("min",e),l.setAttribute("max",a),l.disabled=!1,l.value=l.disabled?0:o||a,l.onchange=()=>function(e){let t=s.querySelector("input");t&&(t.classList.remove("invalid"),t.value=e)}(l.value);let r=document.createElement("span");r.className="range-limite-legend-min",r.innerHTML="% "+e;let i=document.createElement("span");return i.className="range-limite-legend-max",i.innerHTML="% "+a,n.appendChild(r),n.appendChild(i),n.appendChild(l),n}(n,l,e.percentual),i.appendChild(s),i.appendChild(c)}else{const e=function(){let e=document.createElement("div");e.classList.add("input-field"),e.classList.add("sub-input-field-sm");let a=document.createElement("i");a.className="prefix",e.appendChild(a);let o=document.createElement("select");return o.id="personalize-select-agencia-"+t,r.forEach(e=>{let t=document.createElement("option");t.value=e.valor,t.text=e.rotulo||e.valor,t.selected=e.selecionado,o.appendChild(t)}),e.appendChild(o),e}();i.appendChild(e);let a=document.createElement("div");a.className="range-field",i.appendChild(a)}return i;function d(e){e=e.split(".")[0];let t=s.querySelector("input"),a=c.querySelector("input");t.value=e,e<n||e>l?t.classList.add("invalid"):(t.classList.remove("invalid"),a&&(a.value=e)),e=e.split(".")[0]}}function L(e={idCampo:null,canDisable:!1,titulo:null,descricao:null,tipo:null,obrigatorio:null,opcoes:[{rotulo:null,valor:null,selecionado:!1}],range:{simbolo:"",step:null,limiteMinimo:null,limiteMaximo:null,valor:null}}){const{obrigatorio:t=null,canDisable:a=!1,idCampo:o=null,titulo:n=null,descricao:l=null,tipo:r=null,opcoes:i=null,range:s=null}=e,c=document.createElement("div");c.className="sub-container-input",a&&c.appendChild(function(){const e=document.createElement("div");e.className="switch";const a=document.createElement("label"),n=document.createElement("input");n.setAttribute("type","checkbox"),n.id="personalize-"+o,n.checked=!0,n.disabled=t,0==t&&(n.onchange=()=>function(e){let t=u.querySelector("input"),a=m.querySelector("input");t&&(t.classList.remove("invalid"),e?(t.value=s.valor?s.valor>s.limiteMaximo?s.limiteMaximo:s.valor:s.limiteMaximo,t.disabled=!1):(t.value=0,t.disabled=!0));a&&(e?(a.value=s.valor?s.valor>s.limiteMaximo?s.limiteMaximo:s.valor:s.limiteMaximo,a.disabled=!1):(a.value=0,a.disabled=!0))}(n.checked));const l=document.createElement("span");return l.className="lever",a.appendChild(n),a.appendChild(l),e.appendChild(a),e}());const d=document.createElement("div");d.className="switch",c.appendChild(d),c.appendChild(function(){let e=document.createElement("strong");e.innerHTML=n,l&&(e.classList.add("tooltip"),e.dataset.descricao=l,e.innerHTML+='<i class="fas fa-question-circle"></i>');let t=document.createElement("div");return t.className=a?"header-input":"header-input-noswitch",t}());var u=null,m=null;return"select-option"==r?c.appendChild(function(){let e=document.createElement("div");e.classList.add("input-field"),e.classList.add("sub-input-field");let t=document.createElement("p");t.className="rotuloDIT",t.innerHTML="Escolha o tipo e franquia: ";let a=document.createElement("select");a.id="personalize-"+o,i.forEach(e=>{let t=document.createElement("option");t.value=e.valor,t.text=e.rotulo||e.valor,t.selected=e.selecionado,a.appendChild(t)}),e.appendChild(a),"DIT"==o.split("-")[2]&&e.prepend(t);return e}()):"range"==r&&(u=function(){const e=document.createElement("div");if(e.className="input-field",null==s.limiteMinimo||null==s.limiteMaximo)return e;const t=document.createElement("i");t.className="prefix",t.innerHTML=s.simbolo+" ";const a=document.createElement("input");a.setAttribute("type","number"),a.setAttribute("min",s.limiteMinimo),a.setAttribute("max",s.limiteMaximo),a.setAttribute("step",s.step||1),a.id="personalize-"+o,a.value=s.valor?s.valor>s.limiteMaximo?s.limiteMaximo:s.valor:s.limiteMaximo;let n=document.createElement("span");n.className="helper-text",n.setAttribute("data-error","Valor fora dos limites permitidos"),n.setAttribute("data-success",""),s.limiteMinimo==s.limiteMaximo?a.disabled=!0:a.onchange=()=>function(e){e=e.split(".")[0];let t=u.querySelector("input"),a=m.querySelector("input");t.value=e,e<s.limiteMinimo||e>s.limiteMaximo?t.classList.add("invalid"):(t.classList.remove("invalid"),a&&(a.value=e))}(a.value);return e.appendChild(t),e.appendChild(a),e.appendChild(n),e}(),m=function(){const e=document.createElement("div");if(e.className="range-field",null==s.limiteMinimo||null==s.limiteMaximo)return e;const t=document.createElement("input");t.id="personalize-"+o,t.setAttribute("type","range"),t.setAttribute("min",s.limiteMinimo),t.setAttribute("max",s.limiteMaximo),t.setAttribute("step",s.step||1),t.value=s.valor?s.valor>s.limiteMaximo?s.limiteMaximo:s.valor:s.limiteMaximo,t.onchange=()=>function(e){let t=u.querySelector("input");t&&(t.classList.remove("invalid"),t.value=e)}(t.value);let a=document.createElement("span");a.className="range-limite-legend-min",a.innerHTML=`${s.simbolo} ${s.limiteMinimo}`;let n=document.createElement("span");return n.className="range-limite-legend-max",n.innerHTML=`${s.simbolo} ${s.limiteMaximo}`,e.appendChild(a),e.appendChild(n),e.appendChild(t),e}(),c.appendChild(u),c.appendChild(m)),c}}function preencheFormulario(){let e=JSON.parse(window.localStorage.getItem("dadosUsuario")),t=document.querySelectorAll(".step");console.log("caminho ",caminho),caminho.forEach(a=>{e.forEach(e=>{let o=t[a].querySelector("#"+e.id);if(o)if("checkbox"==o.type)o.checked=e.conteudo;else if("SELECT"==o.tagName)o.querySelectorAll("option").forEach(e=>{e.removeAttribute("selected")}),o.querySelector('option[value="'+e.conteudo+'"]')&&o.querySelector('option[value="'+e.conteudo+'"]').setAttribute("selected","selected"),o.M_FormSelect._handleSelectChangeBound();else if("DICIO_PROFISSAO"==o.id){let t=window.localStorage.getItem("jsonServicos")?JSON.parse(window.localStorage.getItem("jsonServicos")):{};if(t[o.id]){let a=t[o.id].itens.filter(t=>t.codigo==e.conteudo);o.dataset.valor=a.length>0?a[0].codigo:"0",o.value=a.length>0?a[0].rotulo:""}}else o.value=e.conteudo,o.classList.contains("data")&&(o.value=e.conteudo.split("-").reverse().join("/")),M.updateTextFields();else{t[a].querySelectorAll("input[name="+e.id+"]").forEach(t=>{t.id.includes(e.conteudo)&&(t.checked=!0)})}})})}function setLocalStorage(e){let t=document.getElementById("localStorage");if(t&&""!=e&&""!=t.value){let o=JSON.parse(t.value);for(var a in window.localStorage.clear(),o)if(null!=o[a])if("caminhoTomado"!=a&&window.localStorage.setItem(a,JSON.stringify(o[a])),"jsonEntradaCalculo"==a)window.localStorage.setItem("dadosUsuario",JSON.stringify(o[a].consultivo.respostas));else if("jsonResponseCalculo"==a)resetOfertas(o[a]);else if("caminhoTomado"==a)caminho=[],o[a].forEach(e=>{caminho.push(+e)}),window.localStorage.setItem(a,JSON.stringify(caminho));else if("jsonServicos"==a){let e=document.getElementById("jsonServicos");e&&(e.value=JSON.stringify(o[a]))}let n=JSON.parse(e);n.numOrcamento&&n.tarefa&&(1==n.tarefa&&(carregamento.classList.remove("on"),carregamento.querySelector(".loader").classList.remove("hidden"),carregamento.querySelector(".message").classList.add("hidden"),carregamento.querySelector(".message p").innerHTML=""),portalAdmin=!0,geraProdutos(!1,n),preencheFormulario())}else carregamento.classList.remove("on"),carregamento.querySelector(".loader").classList.remove("hidden"),carregamento.querySelector(".message").classList.add("hidden"),carregamento.querySelector(".message p").innerHTML=""}function acaoContinuar(){if(document.querySelector("#formulario")){let e=JSON.parse(urlParams.get("dados")).consultivo.portalAdm;if(e){let t=/^\d+$/;if([1,2].includes(e.tarefa)&&t.test(e.numOferta)){console.log("AÇÃO CONTINUAR.........................");let t={numOrcamento:e.numOferta,tarefa:e.tarefa};portalAdmin=!0,carregamento.classList.add("on"),carregamento.querySelector(".loader").classList.remove("hidden"),carregamento.querySelector(".message").classList.add("hidden"),carregamento.querySelector(".message p").innerHTML="",callReturnLocalStorage(JSON.stringify(t))}}}}function acaoVoltar(){if(document.querySelector("#formulario")){let e=JSON.parse(urlParams.get("dados")).consultivo.voltar;console.log("PARAMETRO VOLTAR:",e);let t=JSON.parse(urlParams.get("dados")).consultivo.portalAdm;console.log("portalAdm:",t),t||(e?(console.log("AÇÃO VOLTAR........................."),caminho=window.localStorage.getItem("caminhoTomado").replace(/\[|\]/g,"").split(","),document.getElementById("Ofertas").value=window.localStorage.getItem("jsonResponseCalculo"),geraProdutos(!1,null),preencheFormulario()):window.localStorage.getItem("jsonEntradaCalculo")&&window.localStorage.removeItem("jsonEntradaCalculo"))}}function isNumberKey(e){var t=e.which?e.which:event.keyCode;return!(t>31&&(t<48||t>57))}function handlePersonalizeInput(e,t,a){if(a){let a=e.querySelectorAll("[disabled]");for(i=0;i<a.length;i++)a[i].value=VMasker.toMoney(t)||VMasker.toMoney(a[i].max),a[i].removeAttribute("disabled")}else{let t=e.querySelectorAll("input");for(i=1;i<t.length;i++)t[i].value=0,t[i].setAttribute("disabled","true")}}function vidaOnHidePassageiros(){let e=window.localStorage.getItem("entradaConsultivo"),t=window.localStorage.getItem("ofertaSelecionada");null!=e&&null==t&&(e=JSON.parse(e).consultivo.codigoOfertaConsultiva,"VIAGEM_VIDA_ON"==e&&(document.querySelector("#DICIO_QTD_JOVENS").parentElement.classList.add("hidden"),document.querySelector("#DICIO_QTD_IDOSOS").parentElement.classList.add("hidden"),document.querySelector("#DICIO_QTD_JOVENS").labels[0].innerHTML="",document.querySelector("#DICIO_QTD_IDOSOS").labels[0].innerHTML=""))}function vidaOnPassageirosAtribuicao(){let e=window.localStorage.getItem("entradaConsultivo");null!=e&&(e=JSON.parse(e).consultivo.codigoOfertaConsultiva,"VIAGEM_VIDA_ON"==e&&(document.querySelector("#DICIO_QTD_JOVENS").value=1,document.querySelector("#DICIO_QTD_IDOSOS").value=0))}function vidaONPreencherCampos(){if("VIAGEM_VIDA_ON"==JSON.parse(window.localStorage.getItem("entradaConsultivo")).consultivo.codigoOfertaConsultiva){let e=JSON.parse(document.querySelector("#jsonLTM").value);if(!e.message){let t=document.querySelector("#DICIO_CPFVOUCHER"),a=document.querySelector("#DICIO_VOUCHER");t.value=e.document,t.focus(),t.classList.add("disabled");let o=document.querySelectorAll("#DICIO_CPFVOUCHER");VMasker(o).maskPattern("999.999.999-99"),a.value=e.voucher,a.classList.add("disabled"),a.focus()}}}function ajustarAreaCoberturas(){if("Viagem"==segmentoOfertas){var e=document.querySelectorAll(".listaCobert");if(e.length<=1)return;var t=0;e.forEach(e=>{e.clientHeight>t&&(t=e.clientHeight)}),e.forEach(e=>{e.style.height=t+10+"px"})}else if("Individual"==segmentoOfertas){var a=0,o=0,n=0,l=0,r=0,i=0,s=document.querySelectorAll("label[for^='oferta']");s.forEach(e=>{let t=window.localStorage.getItem("jsonEntradaCalculo");if(t=JSON.parse(t).consultivo.codigoOfertaConsultiva,"APTLMK"==t){if(null==e.querySelector("ul[tipo='Família']")||null==e.querySelector("ul[tipo='Imprevistos']")||null==e.querySelector("ul[tipo='Renda']"))return}else if(null==e.querySelector("ul[tipo='Família']")||null==e.querySelector("ul[tipo='Imprevistos']")||null==e.querySelector("ul[tipo='Doenças']")||null==e.querySelector("ul[tipo='Renda']"))return;let s=e.querySelector("span[class='content']").firstElementChild.clientHeight,c=e.querySelector("ul[tipo='Família']").parentElement.clientHeight,d=e.querySelector("ul[tipo='Imprevistos']").parentElement.clientHeight,u=e.querySelector("ul[tipo='Doenças']")?e.querySelector("ul[tipo='Doenças']").parentElement.clientHeight:null,m=e.querySelector("ul[tipo='Renda']").parentElement.clientHeight,p=e.querySelector("li[class='liPrecoTotal']").clientHeight;a<s&&(a=s),o<c&&(o=c),n<d&&(n=d),l<c&&(l=u),r<m&&(r=m),i<p&&(i=p)}),s.forEach(e=>{e.querySelector("span[class='content']").firstElementChild.style.height=a+"px",e.querySelector("ul[tipo='Família']").parentElement.style.height=o+10+"px",e.querySelector("ul[tipo='Imprevistos']").parentElement.style.height=n+10+"px",e.querySelector("ul[tipo='Doenças']")&&(e.querySelector("ul[tipo='Doenças']").parentElement.style.height=l+10+"px"),e.querySelector("ul[tipo='Renda']").parentElement.style.height=r+10+"px",e.querySelector("li[class='liPrecoTotal']").style.height=i+"px"})}}function calcularTotaisPremios(e,t){for(let t=0;t<e.length;t++)if("0"==e[t].opcao){dadosCalculo=e[t];break}t.anual=calcularPremioAnual(dadosCalculo),t.mensal=calcularPremioMensal(dadosCalculo)}function calcularPremioAnual(e){return e.precificacao.premio.total}function calcularPremioMensal(e){let t=e.precificacao.coberturas,a=0;for(let e=0;e<t.length;e++)a+=t[e].premio.total;return a/12}function formatDate(e){const t=e.split("-");return`${t[2]}/${t[1]}/${t[0]}`}function fillDependentes(e){"true"===e?document.getElementById("DICIO_DEPENDENTES_true")&&(document.getElementById("DICIO_DEPENDENTES_true").checked="true"):document.getElementById("DICIO_DEPENDENTES_false")&&(document.getElementById("DICIO_DEPENDENTES_false").checked="true")}document.addEventListener("DOMContentLoaded",(function(){window.localStorage.getItem("jsonEntradaCalculo");let e=document.querySelector("#formulario");if((carregamento=document.querySelector(".modalLoaderErro")).querySelector(".message .close").addEventListener("click",e=>{carregamento.classList.remove("on"),carregamento.querySelector(".loader").classList.remove("hidden"),carregamento.querySelector(".message").classList.add("hidden"),carregamento.querySelector(".message p").innerHTML=""}),e){try{urlParams=new URLSearchParams(window.location.search)}catch(e){carregamento.classList.add("on"),carregamento.querySelector(".loader").classList.add("hidden"),carregamento.querySelector(".message").classList.remove("hidden"),carregamento.querySelector(".message p").innerHTML="Página iniciada sem os parâmetros necessários"}const t=document.querySelector("#Conjuntos").value;window.localStorage.setItem("conjuntosJson",t),document.querySelector("#Conjuntos").value="";const a=document.querySelector("#Segmento").value;window.localStorage.setItem("segmento",a);const o=JSON.parse(window.localStorage.getItem("conjuntosJson"));if(o.conjuntos.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0})),o.conjuntos.forEach((function(e){e.informacoes.sort((function(e,t){return e.ordem<t.ordem?-1:e.ordem>t.ordem?1:0})),e.informacoes.forEach((function(e){e.opcoes.sort((function(e,t){return e.ordem<t.ordem?-1:e.ordem>t.ordem?1:0}))}))})),window.localStorage.setItem("conjuntosJson",JSON.stringify(o)),validaIntegracao(window.localStorage.getItem("conjuntosJson"))){const t=window.localStorage.getItem("segmento");!function(){console.log("ENTROU"),o.conjuntos.forEach((a,o,n)=>{let l=document.createElement("section");l.className="step",l.id="etapa"+a.id;let r=document.createElement("h1");r.innerHTML=a.titulo;let i=document.createElement("h2");i.innerHTML=a.subtitulo;let s=document.createElement("hgroup");s.appendChild(r),s.appendChild(i),l.appendChild(s),a.informacoes.length>1&&l.classList.add("multiple");const c=JSON.parse(window.localStorage.getItem("entradaConsultivo"));a.informacoes.forEach((e,t)=>{if("DICIO_CORRETAGEM"==e.id&&c.consultivo.Cliente){let t=document.createElement("input");return t.setAttribute("type","hidden"),t.setAttribute("readonly","readonly"),t.setAttribute("value",c.consultivo.DICIO_CORRETAGEM?c.consultivo.DICIO_CORRETAGEM:"25"),t.id=e.id,void l.appendChild(t)}let a="select"==translationsTypeInputs[e.tipo]?document.createElement("select"):document.createElement("input");if(a.setAttribute("type","select"!=translationsTypeInputs[e.tipo]?"text":""),e.obrigatorio&&a.setAttribute("required",""),a.id=e.id,"Número inteiro"==e.tipo&&a.setAttribute("onkeypress","return isNumberKey(event)"),"select"==translationsTypeInputs[e.tipo]){let t=document.createElement("label");t.setAttribute("for",e.id),t.innerText=e.nome;let o=document.createElement("div");if(o.className="select-wrapper","Opção fixa painel"==e.tipo)a=document.createElement("div"),a.classList.add("content"),a.classList.add("choices"),e.opcoes.forEach(t=>{let o=document.createElement("input");o.setAttribute("type","radio"),o.setAttribute("name",e.id),o.setAttribute("value",t.codigo),o.setAttribute("id","input"+t.codigo),o.setAttribute("required",1==e.obrigatorio?"true":"");let n=document.createElement("span");n.innerHTML='<i class="fas fa-user"></i>',n.innerHTML+=`<strong>${t.rotulo}</strong>`;let l=document.createElement("label");l.setAttribute("for","input"+t.codigo),l.appendChild(n),a.appendChild(o),a.appendChild(l)}),l.appendChild(a),a.addEventListener("change",e=>{l.querySelector(".message").innerHTML=""});else{let n=document.createElement("option");n.innerHTML=e.nome,n.setAttribute("value","nulloption"),n.setAttribute("selected","true"),n.setAttribute("disabled","true"),a.appendChild(n),e.opcoes.forEach(e=>{let t=document.createElement("option");t.setAttribute("value",e.codigo),t.setAttribute("id",e.codigo),t.innerHTML=e.rotulo,e.default&&t.setAttribute("selected",!0),a.appendChild(t)}),o.appendChild(a),o.appendChild(t),l.appendChild(o),a.addEventListener("change",e=>{e.target.parentNode.classList.remove("invalid"),e.target.parentNode.querySelector(".message")&&(e.target.parentNode.querySelector(".message").innerHTML="")})}}else if("checkbox"==translationsTypeInputs[e.tipo]){a.setAttribute("type","checkbox");let t=document.createElement("div");t.classList.add("switch"),t.classList.add("input-field");let o=document.createElement("span");o.innerHTML=e.nome;let n=document.createElement("label");n.innerHTML='Não <span class="lever"></span> Sim',t.appendChild(o),n.insertBefore(a,n.firstChild),t.appendChild(n),l.appendChild(t)}else if("radio"==translationsTypeInputs[e.tipo]){let t=document.createElement("div");t.classList.add("select-wrapper"),t.innerHTML='<p class="title-field">'+e.nome+"</p>",e.opcoes.forEach(a=>{let o=document.createElement("label");o.setAttribute("for",e.id+"_"+a.codigo);let n=document.createElement("input"),l=document.createElement("span");l.innerText=a.rotulo,n.setAttribute("type","radio"),n.setAttribute("value",a.codigo),n.setAttribute("name",e.id),n.setAttribute("checked","true"!==a.codigo?"true":"false"),n.setAttribute("id",e.id+"_"+a.codigo),o.appendChild(n),o.appendChild(l),t.appendChild(o)}),l.appendChild(t)}else{let t=document.createElement("div");t.className="input-field";let n=document.createElement("label");n.setAttribute("for",e.id),n.innerText=e.nome;let r,i=document.createElement("span");if(i.classList.add("helper-text"),"DataCalendario"==e.tipo){let e=document.createElement("i");e.classList.add("material-icons"),e.classList.add("suffix"),e.innerHTML="date_range",t.append(e),VMasker(a).maskPattern("99/99/9999"),a.classList.add("data"),a.classList.add("datepicker")}else if("Data"==e.tipo){let e=document.createElement("i");e.classList.add("material-icons"),e.classList.add("suffix"),e.innerHTML="date_range",t.append(e),VMasker(a).maskPattern("99/99/9999"),a.classList.add("data")}if("Texto"==e.tipo&&a.setAttribute("maxlength","120"),"CPF"==e.id&&(VMasker(a).maskPattern("999.999.999-99"),i.dataset.error="CPF inválido"),"DICIO_CPFVOUCHER"==e.id&&(VMasker(a).maskPattern("999.999.999-99"),i.dataset.error="CPF inválido"),"DICIO_NOME"==e.id){r=document.createElement("p"),r.classList.add("pnomesocial");const e=document.createElement("label"),t=document.createElement("input");t.setAttribute("type","checkbox"),t.setAttribute("id","cboxnomesocial"+o),t.classList.add("filled-in"),t.classList.add("cboxnomesocial");let n=document.createElement("span"),l=document.createElement("a");l.classList.add("tooltipped"),l.setAttribute("data-position","bottom"),l.setAttribute("data-tooltip","Nome social é o nome pelo qual a pessoa travesti <br>ou trans se identifica e é socialmente reconhecida");let s=document.createElement("i");s.classList.add("tiny"),s.classList.add("material-icons"),s.innerText="info",n.innerText="Cliente tem nome social",e.appendChild(t),e.appendChild(n),l.appendChild(s),e.appendChild(l),r.append(e),i.dataset.error="",a.addEventListener("input",e=>{e.target.value.match(/[0-9]/g)&&(e.target.value=e.target.value.replace(/[0-9]/g,""))})}if("DICIO_NOMESOCIAL"==e.id&&(t.setAttribute("id","divnomesocial"+o),t.classList.add("hide"),i.classList.add("helpernsocial"),i.innerHTML='<i class="tiny material-icons">info</i>O nome social será utilizado para identificar o(a) cliente Porto. Como Corretor(a), é sua responsabilidade incluir as alterações necessárias em  apólices, documentos, contratos vigentes e equivalentes.'),"DICIO_DATA_SAIDA"==e.id&&(a.addEventListener("focus",()=>{document.querySelector("body").removeAttribute("style"),M.Datepicker.getInstance(a).options.minDate=new Date((new Date).toISOString().slice(0,10))}),a.addEventListener("change",e=>{let t=document.querySelector("#DICIO_DATA_RETORNO"),o=M.Datepicker.getInstance(t);o.el.value="";let n=a.value.split("/").reverse().join("-");o.options.minDate=new Date(new Date(n).toISOString().slice(0,10)),o.options.defaultDate=new Date(new Date(n).toISOString().slice(0,10));let l=validaDataSaida(a);"ok"!=l?(i.dataset.error=l,e.target.classList.add("invalid")):i.dataset.error=""})),"DICIO_DATA_RETORNO"==e.id&&a.addEventListener("change",e=>{let t=validaDataRetorno(e.target);"ok"!=t?(i.dataset.error=t,e.target.classList.add("invalid")):i.dataset.error=""}),"DICIO_DATANASCIMENTO"==e.id&&a.addEventListener("change",e=>{let t=validaDataNascimento(e.target);"ok"!=t?(i.dataset.error=t,e.target.classList.add("invalid")):i.dataset.error=""}),"Opções de servico"==e.tipo){listaServicos.push({id:e.id,servico:e.servico,body:null,metodo:"GET"});let t={bancosConveniados:"true"};listaServicos.push({id:"ADCBANCO",servico:"Consulta_Banco",body:JSON.stringify(t),metodo:"POST"}),listaServicos.push({id:"PAISRESIDENTE",servico:"paises",body:null,metodo:"GET"}),a.classList.add("servico"),a.setAttribute("autocomplete","off")}a.addEventListener("input",e=>{e.target.parentNode.querySelector(".invalid")&&e.target.parentNode.querySelector(".invalid").classList.remove("invalid")}),t.append(a),t.append(n),t.append(i),"DICIO_NOME"==e.id&&r&&t.appendChild(r),l.appendChild(t)}});let d=document.createElement("div");d.classList.add("containerButtons");let u=document.createElement("button");u.classList.add("change-step"),u.classList.add("btnPortoSuccessB"),u.innerHTML="Voltar",u.dataset.destino=null,u.addEventListener("click",e=>{console.log("voltar???? "),null!==localStorage.getItem("personalizacaoOferta")&&localStorage.removeItem("personalizacaoOferta"),null!==localStorage.getItem("personalizarOfertaData")&&localStorage.removeItem("personalizarOfertaData")});let m=document.createElement("button");m.classList.add("change-step"),m.classList.add("validar"),m.classList.add("btnPortoSuccess"),m.dataset.destino=a.regrasSequencia.length>0&&a.regrasSequencia[0].proximoConjunto?a.regrasSequencia[0].proximoConjunto-1:null,m.innerHTML="null"!=m.dataset.destino?"Próxima etapa":"Personalizar oferta","null"==m.dataset.destino&&m.classList.remove("change-step"),"null"==m.dataset.destino&&(m.classList.remove("change-step"),m.classList.add("submit"),m.addEventListener("click",(function(e){if(callPerzonalize=!0,e.preventDefault(),validarInputsAtuais(l)){carregamento.classList.add("on"),carregamento.querySelector(".loader").classList.remove("hidden"),carregamento.querySelector(".message").classList.add("hidden"),caminho.push(o);let e=geraJsonComRespostas();if(validaEntradaConsultivoDuplicada(e,JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")||"{}"))){caminho.push(o),carregamento.classList.remove("on"),irPasso(0,1),changeStep(document.querySelectorAll(".step").length-1),window.localStorage.setItem("CallPersonalize","True");let e=document.querySelector(".personalize-orcamento");e&&(e.classList.add("show"),document.documentElement.scrollTop=0,document.querySelector("body").classList.add("no-scroll"))}else document.querySelector(".produtos")&&(document.querySelector(".produtos").remove(),document.querySelector("#Ofertas").setAttribute("value","")),window.localStorage.removeItem("jsonEntradaCalculo"),window.localStorage.setItem("jsonEntradaCalculo",JSON.stringify(e)),window.localStorage.setItem("caminhoTomado",JSON.stringify(caminho).replace(/['"]+/g,"")),callPagOfertas(JSON.stringify(e)),window.localStorage.setItem("CallPersonalize","True")}}))),m.style.marginRight="50px";let p=document.createElement("button");p.classList.add("change-step"),p.classList.add("validar"),p.classList.add("btnPortoSuccess"),p.dataset.destino=a.regrasSequencia.length>0&&a.regrasSequencia[0].proximoConjunto?a.regrasSequencia[0].proximoConjunto-1:null;let g=JSON.parse(window.localStorage.getItem("entradaConsultivo")).consultivo.codigoOfertaConsultiva;if(p.innerHTML="Individual"==t?"null"!=p.dataset.destino?"Próxima etapa":"Ofertas da Porto":"null"!=p.dataset.destino?"Próxima etapa":"Enviar","null"==p.dataset.destino&&p.classList.remove("change-step"),"null"==p.dataset.destino&&(p.classList.remove("change-step"),p.classList.add("submit"),p.addEventListener("click",(function(e){if(callPerzonalize=!1,e.preventDefault(),validarInputsAtuais(l)){carregamento.classList.add("on"),carregamento.querySelector(".loader").classList.remove("hidden"),carregamento.querySelector(".message").classList.add("hidden"),caminho.push(o);let e=geraJsonComRespostas();if(validaEntradaConsultivoDuplicada(e,JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")||"{}"))){window.localStorage.setItem("CallPersonalize","False"),caminho.push(o),carregamento.classList.remove("on"),irPasso(0,1),changeStep(document.querySelectorAll(".step").length-1),document.querySelector(".vidaOnWarningMessage").classList.add("hidden")}else{document.querySelector(".produtos")&&(document.querySelector(".produtos").remove(),document.querySelector("#Ofertas").setAttribute("value","")),window.localStorage.removeItem("jsonEntradaCalculo"),window.localStorage.setItem("jsonEntradaCalculo",JSON.stringify(e)),window.localStorage.setItem("caminhoTomado",JSON.stringify(caminho).replace(/['"]+/g,"")),console.log("ANTES DO PAGOFERTAS"),callPagOfertas(JSON.stringify(e)),console.log("DEPOIS DO PAGOFERTAS"),window.localStorage.setItem("CallPersonalize","False"),document.querySelector(".vidaOnWarningMessage").classList.add("hidden")}}}))),0!=o?d.appendChild(u):d.classList.add("first"),"Individual"==t&&"APTLMK"!=g&&d.appendChild(m),d.appendChild(p),1==a.id){let e=document.createElement("div");e.classList.add("message"),e.classList.add("center-align"),l.appendChild(e)}l.appendChild(d),e.appendChild(l)});const a=document.querySelectorAll(".cboxnomesocial");var n=document.querySelector("#modalnomesocial"),l=M.Modal.init(n);a.forEach(e=>{e.addEventListener("change",(function(){const t=document.getElementById("divnomesocial"+this.id.substring(14,15));this.checked?l.open():(t.firstElementChild.value="",t.classList.add("hide"));document.getElementById("modalNomeSocialSim").addEventListener("click",(function(){t.classList.remove("hide"),l.close(),t.firstElementChild.focus()}));document.getElementById("modalNomeSocialNao").addEventListener("click",(function(){e.checked=!1,t.classList.add("hide"),l.close()}))}))}),function(){let e=document.querySelectorAll("section.step"),t=document.querySelectorAll(".change-step"),a=JSON.parse(window.localStorage.getItem("conjuntosJson")),o=a.conjuntos,n=document.getElementById("formulario");a.conjuntos.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0})),a.conjuntos.forEach((function(e){e.informacoes.sort((function(e,t){return e.ordem<t.ordem?-1:e.ordem>t.ordem?1:0})),e.informacoes.forEach((function(e){e.opcoes.sort((function(e,t){return e.ordem<t.ordem?-1:e.ordem>t.ordem?1:0}))}))})),window.localStorage.setItem("conjuntosJson",JSON.stringify(a)),e[0].classList.add("on");let l=0;for(let a=0;a<t.length;a++){let r=t[a];r.addEventListener("click",(function(t){if(n.classList.add("ovhide"),setTimeout(e=>{n.classList.remove("ovhide")},800),r.classList.contains("validar")){if(validarInputsAtuais(closestByClass(r,"step")))if(1!=o[l].regrasSequencia.length&&t.target.classList.contains("btnPortoSuccess")){let t,a=0,n=1/0,r=[],i=[];o[l].regrasSequencia.forEach(e=>{i.push(e.sequencia)}),i.sort((function(e,t){return e.sequencia<t.sequencia?-1:e.sequencia>t.sequencia?1:0})),i.forEach(e=>{let i=o[l].regrasSequencia.filter(t=>e==t.sequencia).shift(),s=document.querySelector(".step.on #"+i.idinformacao).value;r.includes(!0)?i.sequencia<=n&&i.idinformacao!=t&&("="==i.operacao?a=s==i.conteudo?i.proximoConjunto-1:null:"<>"==i.operacao?a=s!=i.conteudo?i.proximoConjunto-1:null:"<="==i.operacao?a=parseInt(s)<=parseInt(i.conteudo)?i.proximoConjunto-1:null:">="==i.operacao?a=parseInt(s)>=parseInt(i.conteudo)?i.proximoConjunto-1:null:">"==i.operacao?a=parseInt(s)>parseInt(i.conteudo)?i.proximoConjunto-1:null:"<"==i.operacao&&(a=parseInt(s)<parseInt(i.conteudo)?i.proximoConjunto-1:null)):("="==i.operacao?a=s==i.conteudo?i.proximoConjunto-1:null:"<>"==i.operacao?a=s!=i.conteudo?i.proximoConjunto-1:null:"<="==i.operacao?a=parseInt(s)<=parseInt(i.conteudo)?i.proximoConjunto-1:null:">="==i.operacao?a=parseInt(s)>=parseInt(i.conteudo)?i.proximoConjunto-1:null:">"==i.operacao?a=parseInt(s)>parseInt(i.conteudo)?i.proximoConjunto-1:null:"<"==i.operacao&&(a=parseInt(s)<parseInt(i.conteudo)?i.proximoConjunto-1:null),null!=a?(r.push(!0),n=i.sequencia,t=i.idinformacao):r.push(!1))});for(let t=0;t<=l;t++)e[t].classList.remove("on"),e[t].classList.add("off");e[a].classList.add("on"),caminho.push(l),l=a}else{let a=parseInt(t.target.dataset.destino);for(let t=0;t<=l;t++)e[t].classList.remove("on"),e[t].classList.add("off");e[a].classList.add("on"),caminho.push(l),l=a}}else if("null"==t.target.dataset.destino){let t=parseInt(caminho[caminho.length-1]);for(let t=0;t<e.length;t++)e[t].classList.remove("on"),e[t].classList.remove("off");for(let a=0;a<t;a++)e[a].classList.add("off");e[t].classList.add("on"),l=t,caminho.splice(-1,1)}}))}}(),inicializaSelects(),inicializaDatepicker()}(),callServicos(JSON.stringify(listaServicos))}else carregamento.classList.add("on"),carregamento.querySelector(".loader").classList.add("hidden"),carregamento.querySelector(".message").classList.remove("hidden"),carregamento.querySelector(".message p").innerHTML=o.message;let n=window.localStorage.getItem("entradaConsultivo");null!=n&&(n=JSON.parse(n).consultivo.codigoOfertaConsultiva,"VIAGEM_VIDA_ON"==n&&vidaOnPassageirosAtribuicao())}})),window.addEventListener("load",acaoContinuar),window.addEventListener("load",acaoVoltar),window.addEventListener("DOMContentLoaded",vidaONPreencherCampos),document.addEventListener("DOMContentLoaded",()=>{"Viagem"!=window.localStorage.getItem("segmento")&&callReutilizarDados()});const formatRenda=e=>+e>2e4?"39000":e;function formatFormValue(e,t){var a;if(t)switch(e){case"DICIO_DATANASCIMENTO":case"DICIO_DATAEXPEDICAO":return formatDate(t);case"DICIO_SEXO":return"MASC"===t?"MASCULINO":"FEMININO";case"DICIO_FUMANTE":return"true"===t?"SIM":"NAO";case"DICIO_AGENCIAMENTO":return""+ +t;case"DICIO_FAIXARENDA":return+(a=t)>2e4?"39000":a;default:return t}}function reaproveitarDados(e){console.log("reaproveitarDados"),console.log(JSON.parse(e));const t=JSON.parse(e);if(!t.DICIO_ORIGEM)return void window.localStorage.removeItem("dadosProposta");window.localStorage.setItem("dadosProposta",e);const a=Object.entries(t),o=window.localStorage.getItem("dadosUsuario");a.forEach(([e,t])=>{if("DICIO_RENDA"===e||!t)return;const a="DICIO_FAIXARENDA"===e?"DICIO_RENDA":e,n=document.getElementById(a);if(console.log(a,t),n){const a=o&&JSON.parse(o).find(t=>t.id===e),l=a&&a.conteudo||t,r=formatFormValue(e,l);if("DICIO_PROFISSAO"===e){const e=setInterval(()=>{const a=window.localStorage.getItem("jsonServicos");if(null!==a){clearInterval(e);const o=JSON.parse(a).DICIO_PROFISSAO.itens.filter(e=>e.codigo===t)[0],{rotulo:l,codigo:r}=o;n.dataset.valor=r,n.value=l,M.updateTextFields()}},100)}else n.value=r;"SELECT"===n.tagName&&(n.M_FormSelect._handleSelectChangeBound(),n.querySelector('option[value="'+r+'"]')&&(n.querySelector('option[value="'+r+'"]').setAttribute("selected","selected"),n.querySelector('option[value="'+r+'"]').removeAttribute("disabled")))}"DICIO_DEPENDENTES"===e&&fillDependentes(t)}),a.length&&M.updateTextFields()}
"use strict";let ofertaSelecionada,cepAtualizado,parcelamentoAtual,parcelamentoAtualEscolhidoPeloUsuario,camposIdade,endosso=!1,viagem=!1,individual=!1,vg=!1,segmento="",antecipaComissaoTransmissao=0,agenciamento=0,listBeneficiarios=[],stringOrchestrator="";function salvaDadosProposta(e){e.preventDefault();let t=[{id:"DICIO_NOME",conteudo:document.getElementById("DICIO_NOME")?document.getElementById("DICIO_NOME").value:null},{id:"DICIO_NOMESOCIAL",conteudo:document.getElementById("DICIO_NOMESOCIAL")?document.getElementById("DICIO_NOMESOCIAL").value:null},{id:"EMAIL",conteudo:document.getElementById("EMAIL")?document.getElementById("EMAIL").value:null},{id:"CPF",conteudo:document.getElementById("CPF")?document.getElementById("CPF").value:null},{id:"DICIO_DATANASCIMENTO",conteudo:document.getElementById("DICIO_DATANASCIMENTO")?document.getElementById("DICIO_DATANASCIMENTO").value:null},{id:"DICIO_SEXO",conteudo:document.getElementById("DICIO_SEXO")?document.getElementById("DICIO_SEXO").value:null},{id:"RESIDE_BRASIL",conteudo:document.getElementById("RESIDE_BRASIL")?document.getElementById("RESIDE_BRASIL").value:null},{id:"TIPO_VIAGEM",conteudo:document.getElementById("TIPO_VIAGEM")?document.getElementById("TIPO_VIAGEM").value:null},{id:"PAISRESIDENTE",conteudo:document.getElementById("PAISRESIDENTE")?document.getElementById("PAISRESIDENTE").value:null},{id:"DICIO_DATA_SAIDA",conteudo:document.getElementById("DICIO_DATA_SAIDA")?document.getElementById("DICIO_DATA_SAIDA").value:null},{id:"DICIO_DATA_RETORNO",conteudo:document.getElementById("DICIO_DATA_RETORNO")?document.getElementById("DICIO_DATA_RETORNO").value:null},{id:"DICIO_CORRETAGEM",conteudo:document.getElementById("DICIO_CORRETAGEM")?document.getElementById("DICIO_CORRETAGEM").value:null},{id:"DICIO_AVENTURA",conteudo:document.getElementById("DICIO_AVENTURA")?document.getElementById("DICIO_AVENTURA").value:null},{id:"DICIO_MOTOCICLETA",conteudo:document.getElementById("DICIO_MOTOCICLETA")?document.getElementById("DICIO_MOTOCICLETA").value:null},{id:"TELEFONE",conteudo:document.getElementById("TELEFONE")?document.getElementById("TELEFONE").value:null},{id:"CEP",conteudo:document.getElementById("CEP")?document.getElementById("CEP").value:null},{id:"TIPOENDERECO",conteudo:document.getElementById("TIPOENDERECO")?document.getElementById("TIPOENDERECO").value:null},{id:"LOGRADOUROCLIENTE",conteudo:document.getElementById("LOGRADOUROCLIENTE")?document.getElementById("LOGRADOUROCLIENTE").value:null},{id:"SEMNUMEROCLIENTE",conteudo:document.getElementById("SEMNUMEROCLIENTE")?document.getElementById("SEMNUMEROCLIENTE").value:null},{id:"NUMEROCLIENTE",conteudo:document.getElementById("NUMEROCLIENTE")?document.getElementById("NUMEROCLIENTE").value:null},{id:"COMPLEMENTO",conteudo:document.getElementById("COMPLEMENTO")?document.getElementById("COMPLEMENTO").value:null},{id:"BAIRROCLIENTE",conteudo:document.getElementById("BAIRROCLIENTE")?document.getElementById("BAIRROCLIENTE").value:null},{id:"CIDADECLIENTE",conteudo:document.getElementById("CIDADECLIENTE")?document.getElementById("CIDADECLIENTE").value:null},{id:"ESTADOCLIENTE",conteudo:document.getElementById("ESTADOCLIENTE")?document.getElementById("ESTADOCLIENTE").value:null},{id:"NOMECLIENTEALTERNATIVOSEGURADO0",conteudo:document.getElementById("NOMECLIENTEALTERNATIVOSEGURADO0")?document.getElementById("NOMECLIENTEALTERNATIVOSEGURADO0").value:null},{id:"TELCLIENTEALTERNATIVOSEGURADO0",conteudo:document.getElementById("TELCLIENTEALTERNATIVOSEGURADO0")?document.getElementById("TELCLIENTEALTERNATIVOSEGURADO0").value:null}],a=document.querySelectorAll("#formProposta .listaSegurados .segurado"),o=[];window.localStorage.setItem("qtdSeguradosProposta",a.length),a.length>0&&a.forEach((e,t)=>{o=o.concat([{id:"NOMESEGURADO"+(t+1),conteudo:document.getElementById("NOMESEGURADO"+(t+1)).value},{id:"NOMESOCIALSEGURADO"+(t+1),conteudo:document.getElementById("NOMESOCIALSEGURADO"+(t+1)).value},{id:"CPFSEGURADO"+(t+1),conteudo:document.getElementById("CPFSEGURADO"+(t+1)).value},{id:"DATANASCIMENTOSEGURADO"+(t+1),conteudo:document.getElementById("DATANASCIMENTOSEGURADO"+(t+1)).value},{id:"SEXOSEGURADO"+(t+1),conteudo:document.getElementById("SEXOSEGURADO"+(t+1)).value},{id:"RESIDEBRASILSEGURADO"+(t+1),conteudo:document.getElementById("RESIDEBRASILSEGURADO"+(t+1)).value},{id:"TELEFONESEGURADO"+(t+1),conteudo:document.getElementById("TELEFONESEGURADO"+(t+1)).value},{id:"NOMECLIENTEALTERNATIVOSEGURADO"+(t+1),conteudo:document.getElementById("NOMECLIENTEALTERNATIVOSEGURADO"+(t+1)).value},{id:"TELCLIENTEALTERNATIVOSEGURADO"+(t+1),conteudo:document.getElementById("TELCLIENTEALTERNATIVOSEGURADO"+(t+1)).value},{id:null,name:"PEPUSUARIOSEGURADO"+(t+1),conteudo:[...document.querySelectorAll('[name="PEPUSUARIOSEGURADO'+(t+1)+'"]')].find(e=>e.checked).value},{id:"NOMEPESSOAEXPOSTASEGURADO"+(t+1),conteudo:document.getElementById("NOMEPESSOAEXPOSTASEGURADO"+(t+1)).value},{id:"CPFPEPSEGURADO"+(t+1),conteudo:document.getElementById("CPFPEPSEGURADO"+(t+1)).value},{id:"GRAUPARENTESCOPEPSEGURADO"+(t+1),conteudo:document.getElementById("GRAUPARENTESCOPEPSEGURADO"+(t+1)).value}])}),window.localStorage.setItem("dadosSegurados",JSON.stringify(o)),window.localStorage.setItem("dadosTelaProposta",JSON.stringify(t)),window.location.replace(e.target.href)}document.addEventListener("DOMContentLoaded",async e=>{console.log("DOMContentLoaded 1"),M.AutoInit();let t=0;if(formatacaoFormularioAPTLMK1(),formatacaoFormularioPortoVidaON2(),document.querySelector("#formProposta")){let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")),C=window.localStorage.getItem("ofertaSelecionada");ofertaSelecionada=e.ofertas.filter(e=>e.orcamento.numeroOrcamento==C).shift()||e.ofertas[0],console.log("Lucas ofertaSelecionada",ofertaSelecionada);let f=[];ofertaSelecionada.retornosCalculo.forEach(e=>{ofertaSelecionada.parcelamentos.forEach(t=>{e.opcao==t.opcao&&f.push(t)})}),segmento=ofertaSelecionada.orcamento.segmento.toLowerCase(),endosso="eds"==ofertaSelecionada.orcamento.tipoSeguro.toLowerCase()||!1;let A=!1,L=0;if(endosso){let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].retornosCalculo[0].precificacao.premio.total;e<0&&(A=!0,L=Math.abs(e)),checkEndossoPgmt()}function a(){function e(e,t,a){var o=a.target,r=o.value.replace(/\D/g,""),n=o.value.length>t?1:0;VMasker(o).unMask(),VMasker(o).maskPattern(e[n]),o.value=VMasker.toPattern(r,e[n])}function t(e){console.log("value "+e.target.value),e.target.value=function(e){console.log("size "+e.length);var t=e.substring(0,3),a=e.replace(/\D/g,"");if(console.log("r "+t),console.log("m "+a.length),a.length<12)return(e=e.replace(/\D/g,"")).padEnd(7," "),e;if(e.length<16){if("55"==e.substring(0,2)&&a.length<14){var o=e.replace(/\D/g,"");if((o=(o=o.replace(/^(\d{2})(\d)/g,"($1) $2")).replace(/(\d)(\d{4})$/,"$1-$2")).length>=16&&o.length<20)return 12==(o=(o=(o=(o=o.replace(/\D/g,"")).replace(/^(\d)/,"+$1")).replace(/(.{3})(\d)/,"$1 ($2")).replace(/(.{7})(\d)/,"$1) $2")).length?o=o.replace(/(.{1})$/,"-$1"):13==o.length?o=o.replace(/(.{2})$/,"-$1"):14==o.length?o=o.replace(/(.{3})$/,"-$1"):(15==o.length||o.length>15)&&(o=o.replace(/(.{4})$/,"-$1")),o}return e}return e.length>=16&&e.length<20&&a.length<16?(12==(e=(e=(e=(e=e.replace(/\D/g,"")).replace(/^(\d)/,"+$1")).replace(/(.{3})(\d)/,"$1 ($2")).replace(/(.{7})(\d)/,"$1) $2")).length?e=e.replace(/(.{1})$/,"-$1"):13==e.length?e=e.replace(/(.{2})$/,"-$1"):14==e.length?e=e.replace(/(.{3})$/,"-$1"):(15==e.length||e.length>15)&&(e=e.replace(/(.{4})$/,"-$1")),"+55"==e.substring(0,3)?e:e=e.replace(/\D/g,"")):e=(e.length,e.replace(/\D/g,""))}(e.target.value),function(e){try{let t=e.includes("+")?e.slice(0,8):e.slice(0,2),a=e.includes("+")?e.split(" ")[2]:e.slice(2);console.log("ddd-> "+t+" tel-> "+a),document.querySelector("#ddd").value=t,document.querySelector("#tele").value=a}catch(e){console.error("err "+e)}}(e.target.value),console.log("value length "+e.target.value.length)}document.querySelectorAll(".dataMask").forEach(e=>{e.addEventListener("focusout",t=>{let a=""!=e.value&&"undefined"!=e.value&&/^(?:(?:31(\/|-|\.)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|-|\.)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/|-|\.)(?:0?2)\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|-|\.)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/.test(e.value),o=e.value;new Date(o.split("/").reverse().join("-"))<=new Date((new Date).toISOString().slice(0,10))&&1==a?(e.classList.remove("invalid"),e.classList.add("valid"),resetHelper(e),console.log("ENTROU")):(console.log("data invalida",e),"nascimentoBeneficiario"!=e.id&&(e.classList.remove("valid"),e.classList.add("invalid"),buildHelper(e,"Data inválida")))})}),document.querySelectorAll(".telMask").forEach(t=>{t.addEventListener("input",e.bind(void 0,["(99) 9999-99999","(99) 99999-9999"],14),!1),t.addEventListener("focusout",e=>{let t=e.target.name.toString(),a=e.target.value.replace(/[\( \s \) \-]/g,"");t.includes("TELOPCIONAL")?a.toString().length>=10?(e.target.classList.remove("invalid"),e.target.classList.add("valid")):0==a.toString().length?e.target.classList.remove("invalid"):(e.target.classList.remove("valid"),e.target.classList.add("invalid"),buildHelper(e.target,"Telefone inválido")):"CELULARCLIENTE"==t||"CELULARRESPFIN"==t?11==a.length&&9==parseInt(a.substring(2,3))?(e.target.classList.remove("invalid"),e.target.classList.add("valid")):(e.target.classList.remove("valid"),e.target.classList.add("invalid"),buildHelper(e.target,"Formato correto: (xx) 9xxxx-xxxx")):a.toString().length>=10?(e.target.classList.remove("invalid"),e.target.classList.add("valid")):(e.target.classList.remove("valid"),e.target.classList.add("invalid"),buildHelper(e.target,"Telefone inválido"))})}),document.querySelectorAll(".emergencyContact").forEach(e=>{e.setAttribute("title","Para números nacionais, iniciar com '55' e DDD."),e.setAttribute("size","30"),e.setAttribute("placeholder","xx (xx) xxxxx-xxxx"),e.addEventListener("input",t,!1),e.addEventListener("blur",e=>{console.log("valuex "+e.target.value),e.target.value.includes("+")||(" "!==e.target.value.slice(-1)&&""!==e.target.value?e.target.value=e.target.value+" ":console.log("não adiciona novamente"))})});let a=document.querySelectorAll(".cepMask");VMasker(a).maskPattern("99999-999");let o=document.querySelectorAll(".cpfMask");VMasker(o).maskPattern("999.999.999-99");let r=document.querySelectorAll(".cnpjMask");VMasker(r).maskPattern("99.999.999/9999-99");let n=document.querySelectorAll(".meiMask");VMasker(n).maskPattern("99.999.999/9999-99"),document.querySelectorAll(".rgMask:not(#NUMERODOCUMENTO)").forEach(e=>{e.addEventListener("input",e=>{e.target.value.match(/[0-9]|\.|x|\-|\X/g).length!=e.target.value.length&&(e.target.value=e.target.value.substring(0,e.target.value.length-1))})});let l=document.querySelectorAll(".rneMask");VMasker(l).maskPattern("A999999d-A");let i=document.querySelectorAll(".dataMask");VMasker(i).maskPattern("99/99/9999");let c=document.querySelectorAll(".numberMask");VMasker(c).maskNumber();let s=document.querySelectorAll(".ddiMask");VMasker(s).maskPattern("+ 99");let d=document.querySelectorAll(".dddMask");VMasker(d).maskPattern("99"),document.querySelectorAll(".textMask").forEach(e=>{e.addEventListener("input",e=>{e.target.value.match(/[`!@#$^&*()_|+\-=?;:"<>\{\}\[\]\\\/]/gi)&&(e.target.value=e.target.value.replace(/[`!@#$&*()_|+\-=?;:"<>\{\}\[\]\\\/]/gi,"")),e.target.value=e.target.value.toUpperCase()})}),document.querySelectorAll(".alfaMask").forEach(e=>{e.addEventListener("input",e=>{(null==e.target.value.match(/[0-9]|[A-Z]|\-/gi)||e.target.value.match(/[0-9]|[A-Z]|\-/gi).length!=e.target.value.length)&&(e.target.value=e.target.value.substring(0,e.target.value.length-1))}),e.addEventListener("blur",e=>{e.target.value=e.target.value.slice(0,5),e.target.value=e.target.value.replace(/[^0-9]+/,"")})});let u=document.querySelectorAll(".moneyMask");VMasker(u).maskMoney({precision:2,separator:",",delimiter:".",unit:"R$",zeroCents:!0}),document.querySelectorAll(".percentMask").forEach(e=>{e.addEventListener("input",e=>{e.target.value.match(/[a-z]/g)&&(e.target.value=e.target.value.replace(/[a-z]/g,"").replace(/\%/g,"")),parseInt(e.target.value)>100&&(e.target.value=100),e.target.value=e.target.value.match(/\%/g)?e.target.value.replace("%","").concat("%"):e.target.value.concat("%")})})}function o(){let e=JSON.parse(window.localStorage.getItem("jsonServicos")),t=document.getElementById("PROFISSAOLABEL");if(""==window.localStorage.getItem("jsonServicos")||void 0===JSON.parse(window.localStorage.getItem("jsonServicos")).PROFISSAOLABEL){if(t&&(listaServicos.push({id:"PROFISSAOLABEL",servico:"Consulta_Profissao",body:null,metodo:"GET"}),new Promise((e,t)=>{Promise.all([callServicosProposta(JSON.stringify(listaServicos))])})),console.log("length serviços: ",Object.keys(e).length),Object.keys(e).length>0){let t={data:{}},a=null==e.DICIO_PROFISSAO?e.PROFISSAOLABEL:e.DICIO_PROFISSAO;if(console.log("profissão serviço2: ",a),a&&a.itens){a.itens.forEach(e=>t.data[""+e.rotulo]=null);let e=document.querySelectorAll(".profissaoInput");e.forEach(e=>{e.addEventListener("change",t=>{let o=a.itens.filter(e=>e.rotulo==t.target.value);e.dataset.valor=o.length>0?o[0].codigo:"0"})}),M.Autocomplete.init(e,t)}}}else inicializaServicos()}var r;"viagem"==segmento?(document.getElementById("formularioProposta").remove(),document.getElementById("formularioPropostaViagem").classList.remove("hidden"),viagem=!0):"individual"==segmento?(document.getElementById("formularioPropostaViagem").remove(),document.querySelector(".configSeguroViagem").remove(),individual=!0):"vg"==segmento&&(vg=!0),irPasso(0,2),a(),function(){let e=document.getElementById("TIPODOCUMENTO");e&&e.addEventListener("change",t=>{let a=document.getElementById("NUMERODOCUMENTO");if("rg"==e.value){let e=a.cloneNode(!0);e.value="",e.addEventListener("input",(function(e){e.target.value.trim()&&e.target.value.match(/[0-9]|\.|x|\-|\X/g)&&e.target.value.match(/[0-9]|\.|x|\-|\X/g).length!=e.target.value.length&&(e.target.value=e.target.value.substring(0,e.target.value.length-1))})),a.parentNode.replaceChild(e,a)}else if("rne"==e.value){let e=a.cloneNode(!0);e.value="",VMasker(e).maskPattern("A999999-A"),a.parentNode.replaceChild(e,a)}else if("cnh"==e.value){let e=a.cloneNode(!0);e.value="",VMasker(e).maskPattern("99999999999"),a.parentNode.replaceChild(e,a)}else{let e=a.cloneNode(!0);e.value="",e.addEventListener("input",e=>{}),a.parentNode.replaceChild(e,a)}})}(),function(){let e=document.getElementById("TIPOEMPRESA");e&&e.addEventListener("change",e=>{let t=document.querySelector("#MEIEMPRESA"),a=document.querySelector("#CNPJEMPRESA");t&&a&&("mei"==e.target.value?(t.parentNode.classList.remove("hidden"),a.parentNode.classList.add("hidden"),!t.hasAttribute("required")&&t.setAttribute("required","true"),a.hasAttribute("required")&&a.removeAttribute("required")):"cnpj"==e.target.value?(a.parentNode.classList.remove("hidden"),t.parentNode.classList.add("hidden"),t.hasAttribute("required")&&t.removeAttribute("required"),!a.hasAttribute("required")&&a.setAttribute("required","true")):(t.parentNode.classList.add("hidden"),a.parentNode.classList.add("hidden"),t.hasAttribute("required")&&t.removeAttribute("required"),a.hasAttribute("required")&&a.removeAttribute("required")))})}(),o();const h=2e3;function n(e,t,o=!1){let n=null;ofertaSelecionada&&endosso&&null!=ofertaSelecionada.orcamento.susep&&(n=ofertaSelecionada.orcamento.susep);let m=null!=n?n:JSON.parse(window.localStorage.getItem("conjuntosJson")).identificadorRepresentante,E=JSON.parse(window.localStorage.getItem("entradaConsultivo")).consultivo.Cliente,p=new Event("input",{bubbles:!0,cancelable:!0}),g=document.querySelectorAll(".corretorFavorecido").length,v=0,I=document.querySelectorAll('.corretorFavorecido input[type="range"]'),S=[];I.length>0&&I.forEach(e=>{S.push(e.value),v+=parseInt(e.value)});let C=document.querySelectorAll(".agenteFavorecido").length,f=0,A=document.querySelectorAll('.agenteFavorecido input[type="range"]'),L=[];function y(t,a,o,r,n){let l=document.createElement("div");l.classList.add("row"),l.classList.add("corretorFavorecido"),l.classList.add(""+t);let i=document.createElement("div");i.classList.add("col"),i.classList.add("s3"),i.classList.add("input-field");let c=document.createElement("div");c.classList.add("switch"),c.classList.add("input-field");let s=document.createElement("input");s.type="checkbox",s.checked=a,s.disabled=!0;let d=document.createElement("div");d.classList.add("col"),d.classList.add("s5"),d.classList.add("input-field");let u=document.createElement("input");u.type="text";let m=document.createElement("label");m.innerHTML="Susep Corretor",u.value=r,u.disabled=!0;let E=document.createElement("div");E.classList.add("col"),E.classList.add("s4"),E.classList.add("input-field"),E.classList.add("percentagem");const p=document.createElement("label");p.setAttribute("for","PERCET"),p.textContent="Percentual do favorecido";let g=document.createElement("input");g.id="PERCET",g.name="percentName",g.type="range",g.min=1,g.max=100,g.value=n,g.disabled=!0;let v=document.createElement("div");v.classList.add("indicator"),v.textContent=n+"%",v.style.left=`calc(${n}% - 5px)`;let I=document.createElement("span");I.innerHTML="Corretor lider?";let S=document.createElement("label");S.innerHTML='Não <span class="lever"></span> Sim',c.appendChild(I),S.insertBefore(s,S.firstChild),c.appendChild(S),i.appendChild(c),l.appendChild(i),d.appendChild(m),d.appendChild(u),l.appendChild(d),E.appendChild(p),E.appendChild(g),E.appendChild(v),l.appendChild(E),e.insertBefore(l,e.querySelector(`.row:last-child:not(.${t})`))}if(A.forEach(e=>{L.push(e.value),f+=parseInt(e.value)}),document.querySelector(".warningAddFavorecido")&&document.querySelector(".warningAddFavorecido").remove(),document.querySelector(".warningPercentualFavorecido")&&document.querySelector(".warningPercentualFavorecido").remove(),ofertaSelecionada.regras.cocorretagem&&"VI-PESSOAS"===ofertaSelecionada.orcamento.codigoProdutoVida){const e=ofertaSelecionada.regras.cocorretagem[0];y("cocorretagem",e.transmissaoLider,0,e.susepTransmissao,e.percentualTransmissao),y("cocorretagem",e.corretagemLider,0,e.coCorretagem,e.percentualCoCorretagem)}else if("CORRETAGEM"==t){let t=document.createElement("div");t.classList.add("row"),t.classList.add("corretorFavorecido"),o&&t.classList.add("obrigatorio");let n=document.createElement("div");n.classList.add("col"),n.classList.add("s5"),n.classList.add("input-field");let s=document.createElement("input");s.type="text",s.id="SUSEPFAV"+g,s.name="SUSEPFAV"+g,s.value=o?m:"",(E||o)&&s.setAttribute("disabled","true");let I=document.createElement("label");I.setAttribute("for","SUSEPFAV"+g),I.innerHTML="Susep Corretor",s.addEventListener("keyup",(function(e){clearTimeout(r),r=setTimeout((function(){i(e.target)}),h);const t=e.target;t.value=t.value.toUpperCase()})),s.addEventListener("keydown",(function(){clearTimeout(r)})),s.addEventListener("blur",(function(e){clearTimeout(r),i(e.target)}));let S=document.createElement("span");S.classList.add("helper-text"),S.setAttribute("data-error","Susep não localizada");let C=document.createElement("div");C.classList.add("col"),C.classList.add("s4"),C.classList.add("input-field"),C.classList.add("percentagemFavorecido");let f=document.createElement("input");if(f.type="range",f.id="PERCENTFAV"+g,f.name="PERCENTFAV"+g,f.min=1,f.max=100,E&&f.setAttribute("disabled","true"),f.addEventListener("input",d),f.addEventListener("input",u),0==g)f.value=100;else{if(v>=100)return c(e),!1;f.value=100-v}let A=document.createElement("label");A.setAttribute("for","PERCENTFAV"+g),A.innerHTML="Percentual do favorecido";let L=document.createElement("div");L.classList.add("indicator");let y=document.createElement("div");y.classList.add("col"),y.classList.add("s3"),y.classList.add("input-field");let O=document.createElement("div");O.classList.add("switch"),O.classList.add("input-field");let N=document.createElement("input");N.type="checkbox",N.id="LIDERFAV"+g,N.name="LIDERFAV"+g,N.checked=!!o,E&&N.setAttribute("disabled","true"),N.addEventListener("change",e=>{if(e.target.checked){let t=document.querySelectorAll('.listacorretores .row.corretorFavorecido input[type="checkbox"]');[].forEach.call(t,t=>{t!=e.target&&t.checked&&(t.checked=!1)})}else e.target.checked=!0});let b=document.createElement("span");b.innerHTML="Corretor lider?";let T=document.createElement("label");if(T.innerHTML='Não <span class="lever"></span> Sim',O.appendChild(b),T.insertBefore(N,T.firstChild),O.appendChild(T),y.appendChild(O),!e.querySelector(".botaoRemover")&&!o){let t=document.createTextNode("Remover favorecido"),a=document.createElement("a");a.classList.add("botaoRemover"),a.classList.add("btn-flat"),a.classList.add("btnPortoSimple"),a.setAttribute("href","#"),a.appendChild(t),a.addEventListener("click",l);let o=document.createElement("i");o.classList.add("material-icons"),o.classList.add("left"),o.innerText="cancel",a.appendChild(o),e.querySelector(".row:last-child:not(.corretorFavorecido) .col").appendChild(a)}n.appendChild(s),n.appendChild(I),n.appendChild(S),C.appendChild(f),C.appendChild(A),C.appendChild(L),t.appendChild(y),t.appendChild(n),t.appendChild(C),e.insertBefore(t,e.querySelector(".row:last-child:not(.corretorFavorecido)"));let R=e.querySelectorAll(".corretorFavorecido, .agenteFavorecido");R[R.length-1].querySelector('input[type="range"]').dispatchEvent(p),a(),inicializaSelects()}else{let t=document.createElement("div");t.classList.add("row"),t.classList.add("agenteFavorecido");let o=document.createElement("div");o.classList.add("col"),o.classList.add("s4"),o.classList.add("input-field"),o.classList.add("percentagemFavorecido");let r=document.createElement("input");if(r.type="range",r.id="PERCENTAGEFAV"+C,r.name="PERCENTAGEFAV"+C,r.min=1,r.max=100,r.addEventListener("input",d),r.addEventListener("input",u),0==C)r.value=100;else{if(f>=100)return c(e),!1;r.value=100-f}let n=document.createElement("label");n.setAttribute("for","PERCENTAGEFAV"+C),n.innerHTML="Percentual do favorecido";let i=document.createElement("div");i.classList.add("indicator");let m=document.createElement("div");m.classList.add("col"),m.classList.add("s4"),m.classList.add("input-field");let E=' <option disabled="true" selected="true">Selecione</option>\n                                <option value="FIS">Pessoa Física</option>\n                                <option value="JUR">Pessoa Juridica</option>',g=document.createElement("select");g.id="TIPOAGEFAV"+C,g.name="TIPOAGEFAV"+C,g.innerHTML=E;let v=document.createElement("label");if(v.setAttribute("for","TIPOAGEFAV"+C),v.innerHTML="Tipo de favorecido",g.addEventListener("change",s),!e.querySelector(".botaoRemover")){let t=document.createElement("a");t.classList.add("botaoRemover"),t.setAttribute("href","#"),t.innerHTML="Remover favorecido",t.addEventListener("click",l),e.querySelector(".row:last-child:not(.corretorFavorecido) .col").appendChild(t)}o.appendChild(r),o.appendChild(n),o.appendChild(i),m.appendChild(g),m.appendChild(v),t.appendChild(m),t.appendChild(o),e.insertBefore(t,e.querySelector(".row:last-child:not(.agenteFavorecido)"));let I=e.querySelectorAll(".corretorFavorecido, .agenteFavorecido");I[I.length-1].querySelector('input[type="range"]').dispatchEvent(p),a(),inicializaSelects()}I.length>=2&&(document.querySelector(".addCorretor").style.display="none"),e.querySelectorAll("input, select").forEach(e=>{e.setAttribute("required","true")})}function l(e){e.preventDefault();let t=closestByClass(e.target,"section"),a=t.querySelectorAll(".corretorFavorecido, .agenteFavorecido");a[a.length-1].remove(),document.querySelector(".addCorretor").style.display="",0==t.querySelectorAll(".corretorFavorecido:not(.obrigatorio), .agenteFavorecido:not(.obrigatorio)").length&&t.querySelector(".botaoRemover").remove()}function i(e){e.className="",consultaCorretores(e.value)}function c(e){let t=document.createElement("div");t.classList.add("col"),t.classList.add("s12"),t.classList.add("center-align"),t.classList.add("warningAddFavorecido"),t.innerHTML="Limite de 100% atingido",e.insertBefore(t,e.querySelector(".row:last-child:not(.corretorFavorecido)"))}function s(e){let t=e.target.value,o=closestByClass(e.target,"row"),r=document.querySelectorAll(".corretorFavorecido").length,n=document.querySelectorAll(".agenteFavorecido").length;if(o.querySelector(".documentoTipoFavorecido")){let e=o.querySelector(".documentoTipoFavorecido"),a=e.querySelector("input");a.className="",a.classList.add("validate"),a.classList.add("FIS"==t?"cpfMask":"cnpjMask"),a.id=String(("FIS"==t?"CPFAGEFAV":"CNPJAGEFAV")+o.classList.contains("corretorFavorecido")?r:n),a.name=String(("FIS"==t?"CPFAGEFAV":"CNPJAGEFAV")+o.classList.contains("corretorFavorecido")?r:n);let l=e.querySelector("label");l.setAttribute("for",String(("FIS"==t?"CPFAGEFAV":"CNPJAGEFAV")+n)),l.innerHTML=String("FIS"==t?"CPF":"CNPJ")}else{let e=document.createElement("div");e.classList.add("col"),e.classList.add(o.classList.contains("corretorFavorecido")?"s12":"s4"),e.classList.add("input-field"),e.classList.add("documentoTipoFavorecido");let a=document.createElement("input");a.classList.add("FIS"==t?"cpfMask":"cnpjMask"),a.classList.add("validate"),a.type="text",a.setAttribute("id",String("FIS"==t?"CPFAGEFAV":"CNPJAGEFAV")+(o.classList.contains("corretorFavorecido")?r:n)),a.setAttribute("name",String("FIS"==t?"CPFAGEFAV":"CNPJAGEFAV")+(o.classList.contains("corretorFavorecido")?r:n));let l=document.createElement("label");l.setAttribute("for",String(("FIS"==t?"CPFAGEFAV":"CNPJAGEFAV")+n)),l.innerHTML=String("FIS"==t?"CPF":"CNPJ"),e.appendChild(a),e.appendChild(l),o.appendChild(e)}a()}function d(e){let t=closestByClass(e.target,"section").querySelectorAll('input[type="range"]');if(t.length>1){let a=[],o=0,r=e.target,n=-1,l=0;if(t.forEach((e,t)=>{e.id==r.id&&(n=t),a.push(e.value),o+=parseInt(e.value)}),o>100){let e=Array(...t).splice(n,1);l=o-100,e.forEach((e,t,a)=>{e.value-=Math.ceil(l/a.length),l-=Math.ceil(l/a.length)})}document.querySelector(".warningPercentualFavorecido")&&document.querySelector(".warningPercentualFavorecido").remove()}}function u(e){let t=e.target.parentNode.querySelector(".indicator");t.style.left=parseInt(e.target.value)>50?"calc("+e.target.value+"% - 5px)":"calc("+e.target.value+"% + 5px)",t.innerHTML=e.target.value+"%"}function m(){let e=document.getElementById("nomeBeneficiario");e.value="",document.getElementById("nomeSocialBeneficiario").value="";let t=document.getElementById("cpfBeneficiario");t.value="";let a=document.getElementById("cnpjBeneficiario");a.value="";let o=document.getElementById("nascimentoBeneficiario");o.value="";let r=document.getElementById("percentualBeneficio");r.value="";let n=document.getElementById("grauParentescoBeneficiario");n.value="nulloption";let l=document.getElementById("beneficiarioGrauParentescoOutros");l.value="",l.parentElement.classList.add("hidden"),l.removeAttribute("required"),resetHelper(e),resetHelper(t),resetHelper(a),resetHelper(o),resetHelper(r),resetHelper(n),resetHelper(l),e.parentNode.classList.remove("invalid"),e.classList.remove("invalid"),t.parentNode.classList.remove("invalid"),a.parentNode.classList.remove("invalid"),o.classList.remove("invalid"),r.classList.remove("invalid"),n.parentNode.classList.remove("invalid"),e.focus(),inicializaSelects()}function E(){let e=document.querySelector("#tbl-beneficiarios"),t=document.querySelectorAll(".addBeneficiario"),o=parseFloat("0");if(null!=document.getElementById("btn-limpar-beneficiarios")&&null!=document.getElementById("btn-limpar-beneficiarios")){document.getElementById("btn-limpar-beneficiarios").addEventListener("click",()=>{m()})}let r=document.querySelectorAll("select.toggleBeneficiarios");console.log("beneficiarios 996",r),null!=r&&null!=r&&r.forEach(e=>{e.addEventListener("change",t=>{let a=e.closest(".step").querySelector(".listaBeneficiarios");if("Nome do beneficiário"==t.target.value){a.classList.add("on"),a.querySelectorAll("input, select").forEach(e=>{"cpfBeneficiario"!=e.id&&"cnpjBeneficiario"!=e.id&&"nomeSocialBeneficiario"!=e.id&&e.setAttribute("required","true")})}else{a.classList.remove("on"),a.querySelectorAll("input, select").forEach(e=>{e.removeAttribute("required")})}})}),null!=t&&null!=t&&t.forEach(t=>{let r=0;t.addEventListener("click",t=>{const n=document.querySelector("#cpfBeneficiario"),l=document.querySelector("#cnpjBeneficiario");if(n&&!n.classList.contains("invalid")||l&&!l.classList.contains("invalid")){let t=parseInt("0"),n="";""!=document.getElementById("percentualBeneficio").value&&(t=parseInt(document.getElementById("percentualBeneficio").value.replace("%","")),n=parseInt(document.getElementById("percentualBeneficio").value.replace("%",""))+"%");let l=document.getElementById("imprimirApoliceSim").checked,i={tipoPessoaBeneficiario:document.querySelector('input[name="tipoDePessoa"]:checked').value,numeroBeneficiario:r,nomeBeneficiario:document.getElementById("nomeBeneficiario").value,nomeSocialBeneficiario:document.getElementById("nomeSocialBeneficiario").value,cpfBeneficiario:document.getElementById("tipoDePessoaCPF").checked?document.getElementById("cpfBeneficiario").value:document.getElementById("cnpjBeneficiario").value,nascimentoBeneficiario:"undefined"==document.getElementById("nascimentoBeneficiario").value?"":document.getElementById("nascimentoBeneficiario").value,sexoBeneficiario:document.getElementById("sexoBeneficiario").value,percentualBeneficio:t,grauParentescoBeneficiario:document.getElementById("grauParentescoBeneficiario").value,grauParentescoOutros:"Outros"==document.getElementById("grauParentescoBeneficiario").value?document.getElementById("beneficiarioGrauParentescoOutros").value:"",imprimirApolice:1==l,percentualExibido:n};o=parseInt(i.percentualBeneficio);for(let e=0;e<listBeneficiarios.length;e++)o=parseInt(o)+parseInt(listBeneficiarios[e].percentualBeneficio);if(o>100){let e=document.getElementById("percentualBeneficio"),t=document.getElementById("percentualBeneficioError");return e.classList.add("invalid"),buildHelper(t,"O percentual informado excederá 100% do benefício."),void e.focus()}{if(Date.parse(nascimentoBeneficiario)>new Date)nascimentoBeneficiario=null;else{let e=document.querySelector("#formBeneficiario");validarInputsBeneficiarios(e)&&(console.log("------- objBeneficiario"),console.log(i),listBeneficiarios.push(i),r++,m())}let t=document.getElementById("tbl-beneficiarios-tbody");if(listBeneficiarios.length>0||t.rows.length>0){for(;t.rows.length>0;)document.getElementById("tbl-beneficiarios-tbody").deleteRow(0);for(let e=0;e<listBeneficiarios.length;e++){let a=document.createElement("a");a.setAttribute("id",listBeneficiarios[e].numeroBeneficiario),a.setAttribute("class","btn-flat btnPortoSimple"),a.setAttribute("style","margin-top: 0; padding: 20px;");let o=document.createElement("i");o.setAttribute("style","cursor: pointer; margin-top: 0;"),o.setAttribute("class","material-icons"),o.innerHTML="remove_circle",a.appendChild(o),o.addEventListener("click",e=>{let a=parseInt(e.target.parentNode.id),o=[];for(let e in listBeneficiarios)if(listBeneficiarios[e].numeroBeneficiario!=a&&listBeneficiarios[e].cpfBeneficiario)o.push(listBeneficiarios[e]);else for(let e=0;e<t.rows.length;e++)t.rows[e].dataset.numero&&t.rows[e].dataset.numero==a&&t.deleteRow(e);listBeneficiarios=o,r--,validarPorcentagemBeneficiarios()});let n=document.getElementById("tbl-beneficiarios-tbody").insertRow(e),l=listBeneficiarios[e].nomeBeneficiario,i=listBeneficiarios[e].cpfBeneficiario,c=listBeneficiarios[e].grauParentescoBeneficiario,s=listBeneficiarios[e].percentualExibido,d=listBeneficiarios[e].numeroBeneficiario;null!=l&&null!=i&&null!=c&&null!=s&&(n.insertCell(0).innerHTML=l,n.insertCell(1).innerHTML=i,n.insertCell(2).innerHTML=c,n.insertCell(3).innerHTML=s,n.dataset.numero=d,n.insertCell(4).appendChild(a))}validarPorcentagemBeneficiarios(),e.classList.add("on")}else e.classList.remove("on")}g(),a()}})})}async function p(e){return new Promise(e=>{let r=document.createElement("h3");r.innerHTML="Segurado Dependente "+(t+1),r.style.marginTop=50,r.style.display="block",r.style.borderTop=t>0?"1px solid #ccc":"",r.style.paddingTop=t>0?"50px":0;let n=viagem?document.querySelector(".template-form-segurado.template-viagem").cloneNode(!0):document.querySelector(".template-form-segurado").cloneNode(!0);n.classList.remove("hidden"),n.classList.remove("template-form-segurado"),n.id="SEGURADO"+t,n.innerHTML=r.outerHTML+n.innerHTML.replace(/SEGURADO[0-9]+/g,"SEGURADO"+(t+1)),n.querySelectorAll("select").forEach(e=>{let t=closestByClass(e,"input-field"),a=t.querySelector("label")?t.querySelector("label").cloneNode(!0):null;t.innerHTML="",t.appendChild(e),a&&t.appendChild(a)}),document.querySelector(".listaSegurados").appendChild(n),t++,a(),E(),inicializaSelects(),o(),g(),carregamento.classList.remove("on"),e(n)})}function g(){document.querySelectorAll(".listaBeneficiarios").forEach(e=>{e.querySelectorAll(".beneficiario").forEach((e,t)=>{let a=e.querySelector(".motivoCpf");a&&e.querySelector(".cpfMask").addEventListener("input",e=>{e.target.value.trim().length>0?(a.classList.add("hidden"),a.removeAttribute("hidden")):(a.classList.remove("hidden"),a.setAttribute("required","true"))})})})}function v(){let e,t=window.localStorage.getItem("ofertaSelecionada"),a=window.localStorage.getItem("jsonResponseCalculo"),o=JSON.parse(a);for(let a=0;a<o.ofertas.length;a++)t==o.ofertas[a].orcamento.numeroOrcamento&&(e=o.ofertas[a]);return e}function I(e){const t=e||ofertaSelecionada.retornosCalculo.find(e=>{const t=e.precificacao.descontoAgravo.find(e=>"FPG"==e.tipo&&0==e.percentual);return null!=t&&null!=t});if(console.log("Giordano - retornoCalculoResumo",t),!t){const e=ofertaSelecionada.retornosCalculo.length;t=ofertaSelecionada.retornosCalculo[e-1]}let a=document.querySelector(".resumoAzul"),o=window.localStorage.getItem("personalizacaoOferta");rotulo=o?"Vida do Seu Jeito":ofertaSelecionada.orcamento.rotulo;let r=ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados&&ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados.length>0?ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados[0].coberturas:ofertaSelecionada.orcamento.contratantes[0].grupos[0].coberturas,n=t.precificacao.premio.total,l=ofertaSelecionada.regras.coberturas.length>0?ofertaSelecionada.regras.coberturas:ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados[0].coberturas;a.querySelector(".row.titulo h4").innerHTML=rotulo,a.querySelector(".row.titulo span").innerHTML="Orçamento - "+C;let i=ofertaSelecionada.regras.coberturas.map(e=>[e.prioridade,e.sigla]).sort((e,t)=>e[0]-t[0]),c=[];i.forEach((e,t)=>{c[t]=r.filter(t=>t.sigla==e[1]).shift()}),c=c.filter(e=>e);let s=a.querySelector(".row.garantias ul"),d=document.createElement("li");d.classList.add("cobertura","tituloCobertura");let u=document.createElement("strong");u.innerHTML="Cobertura",u.style.cssText="width:60%",d.appendChild(u);let m=document.createElement("strong");m.innerHTML="Capital",m.style.cssText="width: 40%",d.appendChild(m),s.appendChild(d),c.forEach(e=>{let t=ofertaSelecionada.regras.coberturas.filter(t=>t.sigla==e.sigla).shift(),a=document.createElement("strong");if(a.style.cssText="width:60%",a.innerHTML=t.nome,t.descricao&&(a.classList.add("tooltip"),a.dataset.descricao=t.descricao,a.innerHTML+='<i class="fas fa-question-circle"></i>'),"DIT"==t.sigla){let e=document.getElementById("CEPCOMERCIAL");document.getElementById("msgCepComercial").classList.remove("hide"),e.setAttribute("required","required"),document.getElementById("ENDERECOCOMERCIAL").setAttribute("required","required")}let o=document.createElement("span");o.style.cssText="width: 40%",o.innerHTML=null!==e.valor?Intl.NumberFormat("pt-BR",{style:"currency",currency:e.moeda?e.moeda:"BRL"}).format(e.valor):"Sim";let r=document.createElement("li");r.className="cobertura",r.appendChild(a),r.appendChild(o),null!==e.valor&&s.appendChild(r)});let E=Array(...s.querySelectorAll(".cobertura")).slice(0,4);if(s.innerHTML="",E.forEach(e=>{s.appendChild(e)}),ofertaSelecionada.regras.coberturas.length>4){let e=document.createElement("div");e.classList.add("center-align");let a=document.createElement("i");a.classList.add("material-icons"),a.classList.add("left"),a.innerText="add_circle";let o=document.createTextNode("Coberturas"),r=document.createElement("a");r.href="#loaderMore",r.appendChild(a),r.appendChild(o),r.classList.add("modal-trigger"),r.classList.add("btn-flat"),r.classList.add("btnPortoSimple"),e.appendChild(r),s.appendChild(e);let n,i=new Set;c.forEach(e=>{n=ofertaSelecionada.regras.coberturas.filter(t=>t.sigla==e.sigla).shift(),void 0!==n&&i.add(n.sigla)});let d=ofertaSelecionada.regras.coberturas.some(e=>i.has(e.sigla)&&"Cobertura"==e.tipoGarantia),u=ofertaSelecionada.regras.coberturas.some(e=>i.has(e.sigla)&&("Assistência"==e.tipoGarantia||"Benefício"==e.tipoGarantia));r.addEventListener("click",(function(e){if(document.querySelector("#loaderMore .modal-content").innerHTML="",d){let e=document.createElement("ul"),a=document.createElement("li");a.className="titleCobertura";let o=document.createElement("strong");o.innerHTML="Coberturas",a.appendChild(o),e.appendChild(a),a=document.createElement("li"),a.className="titleCobertura",a.style.cssText="margin-top:20px";let r=document.createElement("span");r.style.cssText="width:50%;text-align:left",r.innerHTML="Cobertura";let n=document.createElement("span");n.style.cssText="width:20%;text-align:left",n.innerHTML="Capital";let i=document.createElement("span");i.style.cssText="width:18%;text-align:left",i.innerHTML="Premio";let s=document.createElement("span");s.style.cssText="width:20%;text-align:left",s.innerHTML="Carência";let d=document.createElement("span");d.style.cssText="width:10%;text-align:left",d.innerHTML="Franquia",a.appendChild(r),a.appendChild(n),a.appendChild(i),a.appendChild(s),a.appendChild(d),e.appendChild(a),c.forEach(a=>{let o=ofertaSelecionada.regras.coberturas.filter(e=>e.sigla==a.sigla).shift();if(o&&"Cobertura"==o.tipoGarantia){let r=document.createElement("span");r.style.cssText="width:35%;text-align:left",r.innerHTML=o.nome,o.descricao&&(r.classList.add("tooltip"),r.dataset.descricao=o.descricao,r.innerHTML+='<i class="fas fa-question-circle"></i>');let n=document.createElement("span");n.style.cssText="width:15%",n.innerHTML=null!==a.valor?Intl.NumberFormat("pt-BR",{style:"currency",currency:a.moeda?a.moeda:"BRL"}).format(a.valor):"Sim";let i=t.precificacao.coberturas.filter(e=>e.sigla==a.sigla).shift(),c=l.filter(e=>e.sigla==a.sigla).shift(),s=document.createElement("span");s.style.cssText="width:10%",s.innerHTML=i?null!==i.premio.total?Intl.NumberFormat("pt-BR",{style:"currency",currency:a.moeda?a.moeda:"BRL"}).format(i.premio.total):"Sim":"N/A";let d=document.createElement("span");d.style.cssText="width:10%",c.carencias?d.innerHTML="Sim":d.innerHTML="Não";let u=document.createElement("span");u.style.cssText="width:10%",c.franquias?u.innerHTML="Sim":u.innerHTML="Não";let m=document.createElement("li");m.appendChild(r),m.appendChild(n),m.appendChild(s),m.appendChild(d),m.appendChild(u),null!==a.valor&&e.appendChild(m)}}),document.querySelector("#loaderMore .modal-content").appendChild(e)}if(u){let e=document.createElement("ul"),a=document.createElement("li");a.className="titleCobertura";let o=document.createElement("strong");o.innerHTML="Assistências e Benefícios",a.appendChild(o),e.appendChild(a),a=document.createElement("li"),a.className="titleCobertura",a.style.cssText="justify-content: flex-start; margin-top:20px";let r=document.createElement("span");r.style.cssText="width:40%;text-align:left",r.innerHTML="Nome";let n=document.createElement("span");n.style.cssText="width:18%;text-align:left",n.innerHTML="Premio",a.appendChild(r),a.appendChild(n),e.appendChild(a),c.forEach(a=>{let o=ofertaSelecionada.regras.coberturas.filter(e=>e.sigla==a.sigla).shift();if(o&&("Assistência"==o.tipoGarantia||"Benefício"==o.tipoGarantia)){let r=document.createElement("span");r.style.cssText="width:40%;text-align:left",r.innerHTML=o.nome,o.descricao&&(r.classList.add("tooltip"),r.dataset.descricao=o.descricao,r.innerHTML+='<i class="fas fa-question-circle"></i>');document.createElement("li");let n=t.precificacao.coberturas.filter(e=>e.sigla==a.sigla).shift(),l=document.createElement("span");l.style.cssText="width:10%; text-align: center",n&&"Monetário"==o.tipo?l.innerHTML=null!==n.premio.total?Intl.NumberFormat("pt-BR",{style:"currency",currency:a.moeda?a.moeda:"BRL"}).format(n.premio.total):"Sim":l.innerHTML=" - ";let i=document.createElement("li");i.style.cssText="justify-content: flex-start",i.appendChild(r),i.appendChild(l),e.appendChild(i)}}),document.querySelector("#loaderMore .modal-content").appendChild(e)}}))}let p=window.location.href.toLowerCase().includes("/lotusvida")?"/lotusvida":"/apex",g=JSON.parse(window.localStorage.getItem("entradaConsultivo"));g.consultivo.voltar=!0;let v=document.getElementById("voltarFormulario");if("eds"==g.consultivo.segmento||"APTLMK"==g.consultivo.codigoOfertaConsultiva||"VIAGEM"==g.consultivo.codigoOfertaConsultiva)v.href="https://"+window.location.hostname+p+"/formularioSniper?dados="+JSON.stringify(g);else{const e=window.location.hostname,t="/OrcamentoVidaIndividual/OrcamentoVidaIndividual?origem=proposta&dados=";let a="";switch(e.slice(e.indexOf("--")+2,e.indexOf("."))){case"hml":a="https://portoseguro--hml.sandbox.my.salesforce-sites.com"+t;break;case"tst":a="https://portoseguro--tst.sandbox.my.salesforce-sites.com"+t;break;case"sniper":a="https://portoseguro--sniper.sandbox.my.salesforce-sites.com"+t;break;case"ortoseguro":a="https://portoseguroapi.secure.force.com"+t;break;default:a=window.location.hostname+p+"/orcamentovidaindividual?origem=proposta&dados="}v.href=v.href=a+JSON.stringify(g)}v.addEventListener("click",(function(){console.log('O botão "botaoVoltar" foi clicado!'),salvaDadosProposta()})),a.querySelector(".row.total .investimento").classList.add("hidden"),a.querySelector(".row.total .investimento").innerHTML="Seu investimento : "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n)}!function(){let e=document.querySelector(".addDestino");if(e){let t=1;e.addEventListener("click",e=>{e.preventDefault();let a=closestByClass(e.target,"row"),o=a.querySelector(".listaDestinos");t++,t>=20&&a.querySelector(".addDestino").classList.add("disabled");let r=document.createElement("div");r.classList.add("input-field"),r.classList.add("col"),r.classList.add("s12");let n=document.createElement("input");n.type="text",n.classList.add("destino"),n.id="DESTINO"+t;let l=document.createElement("label");if(l.setAttribute("for","DESTINO"+t),l.innerHTML="Destino "+t,t>1&&!a.querySelector(".removerDestino")){let e=document.createElement("a");e.href="#",e.classList.add("removerDestino"),e.innerHTML="Remover destino",e.addEventListener("click",e=>{e.preventDefault(),a.querySelector(".addDestino").classList.remove("disabled"),t--,o.children[o.children.length-1].remove()}),a.querySelector(".buttons").appendChild(e)}r.appendChild(n),r.appendChild(l),o.appendChild(r)})}}(),E(),function(){let e=0,t=!0;ofertaSelecionada.orcamento.contratantes[0].grupos.forEach(a=>{if(a.qtdeVidas>0){let o=t?a.qtdeVidas-1:a.qtdeVidas;for(let t=0;t<o;t++)p(),e++;t=!1}}),e<=0&&document.getElementById("formularioPropostaViagem")&&document.querySelector("#formularioPropostaViagem .listaSegurados").remove()}(),S=document.querySelector("#blocoAssinaturaEletronica"),null!=ofertaSelecionada&&"eds"==ofertaSelecionada.orcamento.tipoSeguro.toLowerCase()&&S&&S.classList.add("hidden"),g(),document.querySelectorAll(".sem-numero").forEach(e=>{e.addEventListener("change",e=>{let t=closestByClass(e.target,"section").querySelector(".sem-numero-wrapper");t.querySelector("input").classList.add("alfaMask"),a(),"SIM"==e.target.value?(t.querySelector("input").value="",t.querySelector("input").removeAttribute("required")):t.querySelector("input").setAttribute("required","required")})}),function(){let e=document.querySelectorAll("select");M.FormSelect.init(e,{});new Card({form:document.getElementById("formularioProposta")?"form#formularioProposta":"form#formularioPropostaViagem",container:".card-wrapper",formSelectors:{numberInput:"input#cardNumber",expiryInput:"input#cardExpiry",cvcInput:"input#cardCvc",nameInput:"input#cardName"},width:350,formatting:!0,messages:{validDate:"válido\naté",monthYear:"mm/aa"},placeholders:{number:"•••• •••• •••• ••••",name:"Nome impresso",expiry:"••/••",cvc:"•••"},masks:{cardNumber:"•"},debug:!0});VMasker(document.getElementById("cardExpiry")).maskPattern("99/99")}(),function(){if(""==stringOrchestrator||null==stringOrchestrator){const e=v(),t=e.orcamento.rotulo;if("EDS"==e.orcamento.tipoSeguro){const t=e.orcamento.contratoOriginal.empresa;stringOrchestrator="14"==t?"true":"false"}else callGetOrchestrator(t)}}(),function(){let e=document.querySelector("#TIPOPAGAMENTO");e&&e.addEventListener("change",t=>{let o=translationsPayTypeLayout[t.target.querySelector("option:checked").dataset.layout],r=document.querySelectorAll(".tipoPag"),n=e.value;if(""==stringOrchestrator||null==stringOrchestrator){const e=v(),t=e.orcamento.rotulo;if("EDS"==e.orcamento.tipoSeguro){const t=e.orcamento.contratoOriginal.empresa;stringOrchestrator="14"==t?"true":"false"}else callGetOrchestrator(t)}console.log("codigoPagamento ",n),console.log("empresa14? ",stringOrchestrator);let l=document.querySelector(".antecipacaoComissao");if(!l.classList.contains("hidden")&&l.classList.add("hidden"),antecipaComissaoTransmissao=0,"true"==stringOrchestrator){let e=document.getElementById("divCartao"),t=document.getElementById("testePop"),a=document.getElementById("pag");e.style.display="none","70"===n||"98"===n?("none"==e.style.display&&(e.style.display="block"),a.style.display="none"):"62"===n||"97"===n?("block"==t.style.display&&(t.style.display="none"),"block"==e.style.display&&(e.style.display="none"),"none"==a.style.display&&(a.style.display="block")):("block"==t.style.display&&(t.style.display="none"),"block"==e.style.display&&(e.style.display="none"),"block"==a.style.display&&(a.style.display="none"))}else{let e=document.getElementById("divCartao"),t=document.getElementById("cvv");null!=e&&("block"!=e.style.display&&""!=e.style.display||(e.style.display="none")),null!=t&&("block"!=t.style.display&&""!=t.style.display||"62"===n&&(t.style.display="none"))}f.forEach(e=>{let a=e.planoParcelamentos;a&&e.codigo==t.target.value&&(a.length>1?document.querySelector(".planParc").classList.remove("hidden"):document.querySelector(".planParc").classList.add("hidden"))}),r.forEach(e=>{e.classList.remove("on"),e.querySelectorAll("input, select").forEach(e=>{e.removeAttribute("required")})}),document.querySelector("."+o).classList.add("on");const i=["cardCvc"];document.querySelector("."+o).querySelectorAll("input, select").forEach(e=>{if(i.includes(e.getAttribute("id"))||e.setAttribute("required","true"),e.classList.contains("invalid")&&e.classList.remove("invalid"),e.classList.contains("valid")&&e.classList.remove("valid"),individual){if("SELECT"==e.tagName?e.value="0":e.value="",resetHelper(e),"ADCTIPOPESSOA"==e.name){e.addEventListener("change",e=>{let t=e.target.querySelector("option:checked").value,o=e.target.closest(".adc").querySelector(".adccpfcnpj");if(o){"fisica"==t||"juridica"==t?o.classList.remove("hidden"):o.classList.add("hidden");let e=o.querySelector("input");if(e){e.value="",resetHelper(e),e.classList.remove("valid","invalid"),"fisica"==t&&e.classList.contains("cnpjMask")&&e.classList.remove("cnpjMask"),"juridica"==t&&e.classList.contains("cpfMask")&&e.classList.remove("cpfMask"),"fisica"==t?e.classList.add("cpfMask"):"juridica"==t&&e.classList.add("cnpjMask"),"fisica"==t?VMasker(e).maskPattern("999.999.999-99"):VMasker(e).maskPattern("99.999.999/9999-99");let r=o.querySelector("label");r.innerHTML="fisica"==t?"CPF":"juridica"==t?"CNPJ":"",a(),e.addEventListener("change",e=>{"fisica"==t?validaCPF(e.target.value)?(e.target.classList.remove("invalid"),resetHelper(e.target)):(e.target.classList.add("invalid"),buildHelper(e.target,"CPF inválido")):"juridica"==t&&(validaCPF(e.target.value)?(e.target.classList.remove("invalid"),resetHelper(e.target)):(buildHelper(e.target,"CNPJ inválido"),e.target.classList.add("invalid")))})}}}),e.querySelector('option[value="fisica"]').selected=!0,M.FormSelect.init(e,{});var t=new Event("change");e.dispatchEvent(t)}"ADCBANCO"==e.name&&(e.value="",e.dataset.valor="empty")}})})}(),function(){let e=document.getElementById("ADCBANCO");if(""==window.localStorage.getItem("jsonServicos")||void 0===JSON.parse(window.localStorage.getItem("jsonServicos")).ADCBANCO){if(e){if(!listaServicos.filter(t=>t.id==e.id).shift()){let t={bancosConveniados:"true"};listaServicos.push({id:e.id,servico:"Consulta_Banco",body:JSON.stringify(t),metodo:"POST"})}new Promise((e,t)=>{Promise.all([callServicosProposta(JSON.stringify(listaServicos))])})}}else inicializaServicos()}(),function(){let e=document.getElementById("PAISRESIDENTE");document.getElementById("PAISDEORIGEM");""==window.localStorage.getItem("jsonServicos")||void 0===JSON.parse(window.localStorage.getItem("jsonServicos")).PAISRESIDENTE?e&&(listaServicos.push({id:"PAISRESIDENTE",servico:"paises",body:null,metodo:"GET"}),new Promise((e,t)=>{Promise.all([callServicosProposta(JSON.stringify(listaServicos))])})):inicializaServicos()}(),viagem?function(){let e=document.querySelector(".resumoAzul"),t=window.localStorage.getItem("personalizacaoOferta");rotulo=t?"Vida do Seu Jeito":ofertaSelecionada.orcamento.rotulo;let a=ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados&&ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados.length>0?ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados[0].coberturas:ofertaSelecionada.orcamento.contratantes[0].grupos[0].coberturas,o=ofertaSelecionada.retornosCalculo[0].precificacao.premio.total;e.querySelector(".row.titulo h4").innerHTML=rotulo,e.querySelector(".row.titulo span").innerHTML="Orçamento - "+C;let r=ofertaSelecionada.regras.coberturas.map(e=>[e.prioridade,e.sigla]).sort((e,t)=>e[0]-t[0]),n=[];r.forEach((e,t)=>{n[t]=a.filter(t=>t.sigla==e[1]).shift()}),n=n.filter(e=>e);let l=e.querySelector(".row.garantias ul");n.forEach(e=>{let t=ofertaSelecionada.regras.coberturas.filter(t=>t.sigla==e.sigla).shift(),a=document.createElement("strong");a.innerHTML=t.nome,t.descricao&&(a.classList.add("tooltip"),a.dataset.descricao=t.descricao,a.innerHTML+='<i class="fas fa-question-circle"></i>'),"DIT"==t.sigla&&document.getElementById("CEPCOMERCIAL").setAttribute("required","required");let o=document.createElement("span");o.innerHTML=null!==e.valor?Intl.NumberFormat("pt-BR",{style:"currency",currency:e.moeda?e.moeda:"BRL"}).format(e.valor):"Sim";let r=document.createElement("li");r.className="cobertura",r.appendChild(a),r.appendChild(o),null!==e.valor&&l.appendChild(r)});let i=Array(...l.querySelectorAll(".cobertura")).slice(0,3);if(l.innerHTML="",i.forEach(e=>{l.appendChild(e)}),ofertaSelecionada.regras.coberturas.length>3){let e=document.createElement("div");e.classList.add("center-align");let t=document.createElement("i");t.classList.add("material-icons"),t.classList.add("left"),t.innerText="add_circle";let a=document.createTextNode("Coberturas"),o=document.createElement("a");o.href="#loaderMore",o.appendChild(t),o.appendChild(a),o.classList.add("modal-trigger"),o.classList.add("btn-flat"),o.classList.add("btnPortoSimple"),e.appendChild(o),l.appendChild(e),o.addEventListener("click",(function(e){let t=document.createElement("ul"),a=document.createElement("li");a.className="titleCobertura",document.createElement("span").innerHTML="Cobertura",document.createElement("span").innerHTML="Capital",t.appendChild(a),n.forEach((e,a)=>{let o=ofertaSelecionada.regras.coberturas.filter(t=>t.sigla==e.sigla).shift(),r=document.createElement("strong"),n=document.createElement("style");n.attributes.style="width: 70%",r.appendChild(n),r.innerHTML=o.nome,o.descricao&&(r.classList.add("tooltip"),r.dataset.descricao=o.descricao,r.innerHTML+='<i class="fas fa-question-circle"></i>');let l=document.createElement("span");l.innerHTML=null!==e.valor?Intl.NumberFormat("pt-BR",{style:"currency",currency:e.moeda?e.moeda:"BRL"}).format(e.valor):"Sim";let i=document.createElement("li");i.appendChild(r),i.appendChild(l),t.appendChild(i)}),document.querySelector("#loaderMore .modal-content").innerHTML="",document.querySelector("#loaderMore .modal-content").appendChild(t)}))}let c=window.location.href.toLowerCase().includes("/lotusvida")?"/lotusvida":"/apex",s=JSON.parse(window.localStorage.getItem("entradaConsultivo"));s.consultivo.voltar=!0;let d=document.getElementById("voltarFormulario");d.href="https://"+window.location.hostname+c+"/formularioSniper?dados="+JSON.stringify(s),d.addEventListener("click",salvaDadosProposta),e.querySelector(".row.total .investimento").classList.add("hidden"),e.querySelector(".row.total .investimento").innerHTML="Seu investimento : "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o)}():individual&&I(null),function(){if("VIDA_ON"==JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")).consultivo.codigoOfertaConsultiva)document.querySelector(".complementoEmpresario").remove();else{let e=document.getElementById("PROFISSAOLABEL");if(e&&JSON.parse(window.localStorage.getItem("jsonServicos")).DICIO_PROFISSAO){let t=JSON.parse(window.localStorage.getItem("dadosUsuario")).filter(e=>"DICIO_PROFISSAO"==e.id).shift().conteudo;e.value=JSON.parse(window.localStorage.getItem("jsonServicos")).DICIO_PROFISSAO.itens.filter(e=>e.codigo==t).shift().rotulo,e.setAttribute("disabled","true"),"EMPRESÁRIO"==e.value.toUpperCase()||"EMPRESARIO"==e.value.toUpperCase()?document.querySelector(".complementoEmpresario").classList.remove("hidden"):document.querySelector(".complementoEmpresario").remove()}}}(),function(){if(window.innerWidth>768){let t=document.querySelector(".fixedResume"),a=document.documentElement.scrollTop;function e(){a=document.documentElement.scrollTop,t.style.top=a>100?a-100+"px":"0px"}window.addEventListener("scroll",e),e()}}(),function(){let e=document.querySelector(".btnPortoSuccess"),t=document.querySelector(".formulario"),a=document.querySelector(".resumo"),o=window.localStorage.getItem("jsonResponseCalculo"),r=JSON.parse(o);console.log("ResponseCalculo:",JSON.stringify(r)),ofertaSelecionada=r.ofertas.filter(e=>e.orcamento.numeroOrcamento==C).shift()||r.ofertas[0];let n=window.localStorage.getItem("dadosUsuario"),l=JSON.parse(n),i=ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados&&ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados.length>0?ofertaSelecionada.orcamento.contratantes[0].grupos[0].segurados[0].coberturas:ofertaSelecionada.orcamento.contratantes[0].grupos[0].coberturas,c=ofertaSelecionada.regras.coberturas.map(e=>[e.prioridade,e.sigla]).sort((e,t)=>e[0]-t[0]),s=[];c.forEach((e,t)=>{s[t]=i.filter(t=>t.sigla==e[1]).shift()}),s=s.filter(e=>e),e.addEventListener("click",e=>{let o=apagarPagmento1(),n=JSON.parse(window.localStorage.getItem("jsonEntradaCalculo"));if("VIDA_ON"==n.consultivo.codigoOfertaConsultiva){r.ofertas.forEach(e=>{ofertaSelecionada.numeroOrcamento==e.numeroOrcamento&&(e.orcamento.contratantes[0].grupos[0].segurados[0].pessoa.nome=document.querySelector('input[name="DICIO_NOME"]').value,e.orcamento.contratantes[0].grupos[0].segurados[0].pessoa.email=document.querySelector('input[name="EMAIL"]').value,e.orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.sexo=document.querySelector('select[name="DICIO_SEXO"]').value,e.orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.renda=parseInt(document.querySelector('select[name="RENDAMENSAL2"]').value),e.orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.profissao=document.querySelector('input[name="PROFISSAOLABEL"]').value,e.orcamento.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.grupoProfissao="")}),window.localStorage.setItem("jsonResponseCalculo",JSON.stringify(r));let e=!1;l.forEach(t=>{"DICIO_SEXO"==t.id&&(e=!0)}),e||l.push({id:"DICIO_SEXO",conteudo:""}),l.forEach(e=>{"DICIO_NOME"==e.id&&(e.conteudo=document.querySelector('input[name="DICIO_NOME"]').value),"DICIO_RENDA"==e.id&&(e.conteudo=parseInt(document.querySelector('select[name="RENDAMENSAL2"]').value)),"DICIO_PROFISSAO"==e.id&&(e.conteudo="2111-05"),"DICIO_SEXO"==e.id&&(e.conteudo=document.querySelector('select[name="DICIO_SEXO"]').value)}),window.localStorage.setItem("dadosUsuario",JSON.stringify(l))}if("VIAGEM_VIDA_ON"==n.consultivo.codigoOfertaConsultiva&&findIdFormaPagamento(),e.preventDefault(),console.log("Gior ResponseCalculo: ",ofertaSelecionada.orcamento.contratantes[0]),validaCamposTransmissao(listBeneficiarios)){let e=document.querySelector('input[name="DICIO_NOME"]').value,r=document.querySelector('input[name="CPF"]').value,n=o?" ":document.querySelector('select[name="TIPOPAGAMENTO"]').value,l=o?" ":document.querySelector("#OPCAO_PAGAMENTO").value,i=ofertaSelecionada.orcamento.rotulo,c=o?" ":ofertaSelecionada.retornosCalculo.filter(e=>e.opcao==l).shift().precificacao.premio.total,d=o?" ":ofertaSelecionada.retornosCalculo.filter(e=>e.opcao==l).shift(),u=ofertaSelecionada.retornosCalculo[0].precificacao.premio.total;checkOfertaSelecionadaIsEndossoViagem()&&parseFloat(u)<0?parcelamentoAtualEscolhidoPeloUsuario=null:parcelamentoAtual&&(parcelamentoAtualEscolhidoPeloUsuario=parcelamentoAtual.find(e=>e.qtdParcelas==document.querySelector('select[name="planoParcelamentos"]').value)||null),viagem?function(e,t,a,o){let r=document.querySelector(".resumo .row.cobertura");r.innerHTML="";let n=document.createElement("div");n.classList.add("col","s12","center-align");let l=document.createElement("h3");l.innerHTML="Coberturas",n.appendChild(l),r.appendChild(n);let i=document.createElement("div");i.classList.add("col","s12","titleTableResumo","titleTable1");let c=["Cobertura","Capital","Prêmio"];c.forEach((e,t)=>{let a=document.createElement("div");0===t?a.classList.add("col","s8"):a.classList.add("col","s2"),t==c.length-1&&a.classList.add("right-align"),a.innerHTML=e,i.appendChild(a)}),r.appendChild(i);let s=document.createElement("div");s.classList.add("col","s12","coberturasResumo"),A&&(n.classList.add("hidden"),i.classList.add("hidden"),s.classList.add("hidden"));const d={},u=[];t.coberturas.forEach(e=>d[e.prioridade]=e.sigla);for(const e in d)u.includes(d[e])||u.push(d[e]);e.precificacao.coberturas.forEach(e=>{u.includes(e.sigla)||u.push(e.sigla)}),u.forEach(o=>{let r=t.coberturas.filter(e=>e.sigla==o).shift(),n=r&&r.nome||o,l=a.filter(e=>e.sigla==o).shift(),i=l?l.moeda:"BRL",c=l?l.valor:0,d=e.precificacao.coberturas.filter(e=>e.sigla==o).shift();d=d?d.premio.total:0;let u=document.createElement("div");u.classList.add("col","s12"),u.innerHTML='<div class="row"></div>';let m=document.createElement("div");m.classList.add("col","s8"),m.innerHTML=n;let E=document.createElement("div");E.classList.add("col","s2"),E.innerHTML="Sim",c>0&&(E.innerHTML=Intl.NumberFormat("pt-BR",{style:"currency",currency:i}).format(c));let p=document.createElement("div");p.classList.add("col","s2","right-align"),p.innerHTML=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(d),u.children[0].appendChild(m),u.children[0].appendChild(E),u.children[0].appendChild(p),s.appendChild(u)}),r.appendChild(s);let m=document.createElement("div");m.classList.add("col","s12","totalBeneficiosResumo","titleTableTotal");let E=document.createElement("div");E.classList.add("col","s12");let p=document.createElement("div");p.classList.add("col","s6"),p.innerHTML=A?"Valor a ser restituído":"Total";let g=document.createElement("div");g.classList.add("col","s3","offset-s3","totalPremioBeneficios","right-align"),g.innerHTML="<span></span>";let v=document.createElement("span");A?(v.innerHTML=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(L),g.appendChild(v)):(v.innerHTML=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o),g.appendChild(v));E.appendChild(p),E.appendChild(g),m.appendChild(E),r.append(m)}(d,ofertaSelecionada.regras,s,c):individual&&function(e,t,a){let o,r=new Set;t.forEach(t=>{o=e.regras.coberturas.filter(e=>e.sigla==t.sigla).shift(),void 0!==o&&r.add(o.sigla)});let n=e.regras.coberturas.some(e=>r.has(e.sigla)&&"Cobertura"==e.tipoGarantia),l=e.regras.coberturas.some(e=>r.has(e.sigla)&&("Assistência"==e.tipoGarantia||"Benefício"==e.tipoGarantia)),i=document.querySelector(".resumo .row.cobertura");i.innerHTML="";let c=document.querySelector(".resumo .row.assistenciaBeneficio");c.innerHTML="";let s=document.createElement("div");s.classList.add("col","s12","center-align");let d=document.createElement("h3");d.innerHTML="Coberturas",s.appendChild(d),i.appendChild(s);let u=document.createElement("div");u.classList.add("col","s12","center-align");let m=document.createElement("h3");m.innerHTML="Assistências e Benefícios",u.appendChild(m),c.appendChild(u);let E=document.createElement("div");E.classList.add("col","s12","titleTableResumo","titleTable1");let p=["Cobertura","Capital","Carência","Franquia","Prêmio"];p.forEach((e,t)=>{let a=document.createElement("div");0==t?a.classList.add("col","s4"):a.classList.add("col","s2"),t==p.length-1&&a.classList.add("right-align"),a.innerHTML=e,E.appendChild(a)});let g=document.createElement("div");g.classList.add("col","s12","titleTableResumo","titleTable1");let v=["Cobertura","Capital","Carência","Franquia","Prêmio"];v.forEach((e,t)=>{let a=document.createElement("div");0==t?a.classList.add("col","s4"):a.classList.add("col","s2"),t==v.length-1&&a.classList.add("right-align"),a.innerHTML=e,g.appendChild(a)}),i.appendChild(E),c.appendChild(g);let I=document.createElement("div");I.classList.add("col","s12","coberturasResumo");let S=document.createElement("div");S.classList.add("col","s12","assistenciasResumo"),A&&(s.classList.add("hidden"),u.classList.add("hidden"),E.classList.add("hidden"),I.classList.add("hidden"),S.classList.add("hidden"));let C,f=document.querySelector(".planoParcelamentos option:checked"),h=f&&void 0!==f.dataset.percentual?f.dataset.percentual:0;e.retornosCalculo.forEach((e,t)=>{console.log("indice",t),console.log("percentual",h),console.log("percentualItem",e.precificacao.descontoAgravo[0].percentual),e.precificacao.descontoAgravo[0].percentual===parseFloat(h)&&(C=t)}),console.log("indice",C);let y=0;t.forEach(t=>{let a=e.retornosCalculo[C].precificacao.coberturas.filter(e=>e.sigla==t.sigla).shift(),o=e.regras.coberturas.filter(e=>e.sigla==t.sigla).shift();console.log("Cobertura...",t);let r=document.createElement("div");r.classList.add("col"),r.classList.add("s12"),r.innerHTML='<div class="row"></div>';let n=document.createElement("div");n.classList.add("col"),n.classList.add("s4");let l=document.createElement("div");l.classList.add("col"),l.classList.add("s2");let s=document.createElement("div");s.classList.add("col"),s.classList.add("s2");let d=document.createElement("div");d.classList.add("col"),d.classList.add("s2");let u=document.createElement("div");u.classList.add("col"),u.classList.add("s2"),u.classList.add("right-align"),n.innerHTML=o.nome,l.innerHTML=t.valor?Intl.NumberFormat("pt-BR",{style:"currency",currency:t.moeda?t.moeda:"BRL"}).format(t.valor):"Sim",o.carencias?s.innerHTML="Sim":s.innerHTML="Não",o.franquias?d.innerHTML="Sim":d.innerHTML="Não",u.innerHTML=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a?a.premio.total:0),y=a?y+parseFloat(a.premio.total):y,r.children[0].appendChild(n),r.children[0].appendChild(l),r.children[0].appendChild(s),r.children[0].appendChild(d),r.children[0].appendChild(u),o&&"Cobertura"==o.tipoGarantia?(console.log("coberturaRow......"),I.appendChild(r),i.appendChild(I)):(o&&"Assistência"==o.tipoGarantia||"Benefício"==o.tipoGarantia)&&(console.log("assistenciaRow......"),S.appendChild(r),c.appendChild(S))}),n||i.classList.add("hidden");l||c.classList.add("hidden");let O=document.querySelector(".totalBeneficiosResumo");O.innerHTML="",O.classList.add("col","s12","titleTableTotal");let N=document.createElement("div");N.classList.add("col","s12");let b=document.createElement("div");b.classList.add("col","s6"),b.innerHTML=A?"Valor a ser restituído":"Total";let T=document.createElement("div");T.classList.add("col","s3","offset-s3","totalPremioBeneficios","right-align"),T.innerHTML="<span></span>";let R=document.createElement("span");A?(R.innerHTML=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(L),T.appendChild(R)):(R.innerHTML=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(y),T.appendChild(R));N.appendChild(b),N.appendChild(T),O.appendChild(N)}(ofertaSelecionada,s),document.querySelector(".nomePessoaResumo").innerHTML=e,document.querySelector(".cpfPessoaResumo").innerHTML=r.substring(0,3)+".***.***-"+r.slice(-2);let m=document.querySelector(".modoPagamentoResumo span");o||(m.innerHTML=document.querySelector('select[name="planoParcelamentos"]').value+"x no "+translationsPayType[n]),document.querySelector(".nomePlano").innerHTML=i;let E=document.querySelector(".modoPagamentoResumoDados");if(E.innerHTML="",checkOfertaSelecionadaIsEndossoViagem()&&parseFloat(u)<0&&document.querySelector(".modoPagamentoResumo").parentElement.parentElement.setAttribute("hidden","hidden"),checkOfertaSelecionadaIsEndossoVI()&&parseFloat(u)<0&&document.querySelector(".modoPagamentoResumo").parentElement.parentElement.setAttribute("hidden","hidden"),0==n)m&&m.parentElement.parentElement.setAttribute("hidden","hidden");else if(2==n){let e=document.createElement("div");e.classList.add("col"),e.classList.add("s6"),e.innerHTML="Banco";let t=document.createElement("div");t.classList.add("col"),t.classList.add("s6"),t.innerHTML="Agência";let a=document.createElement("div");a.classList.add("col"),a.classList.add("s6"),a.innerHTML="Conta Corrente";let o=document.createElement("div");o.classList.add("col"),o.classList.add("s6"),o.innerHTML="Nome";let r=document.createElement("div");r.classList.add("col"),r.classList.add("s6"),r.innerHTML="CPF";let n=document.getElementById("correntistaDebito").value,l=document.getElementById("cpfDebito").value,i=document.getElementById("bancoDebito"),c=i.options[i.selectedIndex].text,s=document.getElementById("agenciaDebito").value,d=document.getElementById("cidadeDebito").value,u=document.getElementById("contaDebito").value+"-"+d,m=document.createElement("div");m.classList.add("col"),m.classList.add("s6"),m.classList.add("right-align"),m.innerHTML=c;let p=document.createElement("div");p.classList.add("col"),p.classList.add("s6"),p.classList.add("right-align"),p.innerHTML=s;let g=document.createElement("div");g.classList.add("col"),g.classList.add("s6"),g.classList.add("right-align"),g.innerHTML=u;let v=document.createElement("div");v.classList.add("col"),v.classList.add("s6"),v.classList.add("right-align"),v.innerHTML=n;let I=document.createElement("div");I.classList.add("col"),I.classList.add("s6"),I.classList.add("right-align"),I.innerHTML=l.substring(0,3)+".***.***-"+l.slice(-2),E.appendChild(e),E.appendChild(m),E.appendChild(t),E.appendChild(p),E.appendChild(a),E.appendChild(g),E.appendChild(o),E.appendChild(v),E.appendChild(r),E.appendChild(I)}a.classList.remove("hidden"),t.classList.add("hidden")}}),document.querySelector(".voltar").addEventListener("click",e=>{disableCampoRendaMensal2(),document.querySelector(".row.formulario").classList.remove("hidden"),document.querySelector(".row.resumo").classList.add("hidden")}),document.querySelector(".gerarContrato").addEventListener("click",e=>{document.querySelector(".modalLoaderErro").classList.add("on");let t=getjsonEntradaTransmissao(),a=getJsonDadosVoucher();window.localStorage.setItem("jsonDadosVoucher",JSON.stringify(a)),window.localStorage.setItem("jsonEntradaTransmissao",JSON.stringify(t)),CallPagTransmissao(JSON.stringify(t),JSON.stringify(a))})}(),function(){let e=document.getElementById("questionarioRisco"),t=ofertaSelecionada.regras.questionarios,o=null;if(ofertaSelecionada&&ofertaSelecionada.retornoAceitacao&&Array.isArray(ofertaSelecionada.retornoAceitacao.decisoes)&&ofertaSelecionada.retornoAceitacao.decisoes.length){let e=ofertaSelecionada.retornoAceitacao.decisoes.find(e=>e.tipo&&e.acao&&"RISCO"===e.tipo.toUpperCase()&&("AUTO"==e.acao.toUpperCase()||"TELE"==e.acao.toUpperCase()||"VIDEO"==e.acao.toUpperCase()));e&&e.mensagemRepresentante&&(o=e.mensagemRepresentante)}if(null!=t&&t.length>0&&!o)t.forEach((t,a)=>{let o;if("Opção"===t.tipoResposta){o=document.createElement("select"),t.obrigatorio&&o.setAttribute("required",t.obrigatorio),o.id="pergunta_"+t.idPergunta,o.innerHTML='<option value="" selected="true" disabled="true">Selecione</option>',o.classList.add("col"),o.classList.add("s12"),o.classList.add("l12"),t.opcoesRespostas.split(";").forEach(e=>{let t=document.createElement("option");t.innerHTML=e,o.appendChild(t)});let a=document.createElement("div");a.classList.add("input-field"),a.classList.add("col"),a.classList.add("s12"),a.classList.add("l12"),a.classList.add("selecionePergunta");let r=document.createElement("label");r.setAttribute("for","pergunta_"+t.idPergunta),r.innerText=t.pergunta,a.appendChild(o),a.appendChild(r),e.querySelector(".campos").appendChild(a),inicializaSelects()}else{o=document.createElement("input"),o.type="text",o.id="pergunta_"+t.idPergunta;let a=document.createElement("div");t.obrigatorio&&o.setAttribute("required",t.obrigatorio),a.classList.add("input-field"),a.classList.add("col"),a.classList.add("s12"),a.classList.add("l12");let r=document.createElement("label");r.setAttribute("for","pergunta_"+t.idPergunta),r.innerText=t.pergunta;let n=document.createElement("span");n.classList.add("helper-text"),"Número"==t.tipoResposta?o.classList.add("numberMask"):"Data"==t.tipoResposta?o.classList.add("dataMask"):o.classList.add("textMask"),a.appendChild(o),a.appendChild(r),a.appendChild(n),e.querySelector(".campos").appendChild(a)}}),a();else if(document.getElementById("questionarioRisco"))if(o){let t=document.createElement("p"),a=document.createElement("div");t.classList.add("col"),t.classList.add("s12"),t.innerText=o,a.appendChild(t),e.querySelector(".campos").appendChild(a)}else document.getElementById("questionarioRisco").remove()}(),function(){if(individual){let e=document.getElementById("grauParentescoBeneficiario"),t=document.getElementById("NACIONALIDADE"),a=JSON.parse(window.localStorage.getItem("jsonServicos")),o=a.PAISRESIDENTE,r={data:{}};console.log("entradaServicos[2] "+a.PAISRESIDENTE),e.addEventListener("change",t=>{let a=document.getElementById("beneficiarioGrauParentescoOutros");"outros"==e.value.toLowerCase()?(a.parentElement.classList.remove("hidden"),a.required="true"):"outros"!=e.value.toLowerCase()&&(a.parentElement.classList.add("hidden"),a.removeAttribute("required"))}),t.addEventListener("change",e=>{let a=document.getElementById("PAISDEORIGEM");"ESTRANGEIRA"==t.value.toUpperCase()?(a.parentElement.classList.remove("hidden"),a.required="true",o.records.forEach(e=>r.data[""+e.Label]=null),a.addEventListener("change",e=>{let t=o.records.filter(t=>t.Label==e.target.value);a.dataset.valor=t.length>0?t[0].codigo:"0"}),M.Autocomplete.init(a,r)):"ESTRANGEIRA"!=t.value.toUpperCase()&&(a.parentElement.classList.add("hidden"),a.removeAttribute("required"))}),document.getElementById("CPF").addEventListener("change",e=>{const t=document.getElementById("cpfBeneficiario");t&&(e.target.value==t.value&&""!=e.target.value?(buildHelper(t,"CPF não pode ser o mesmo do contratante"),t.classList.add("invalid")):(resetHelper(t),t.classList.remove("invalid"),t.classList.add("valid")))});const n=document.getElementById("cpfBeneficiario");n&&n.addEventListener("change",e=>{console.log("changed CPF Benefas"),""==e.target.value||validaCPF(e.target.value)?""!=e.target.value&&e.target.value==document.querySelector('input[name="CPF"]').value?(buildHelper(e.target,"CPF não pode ser o mesmo do contratante"),e.target.classList.add("invalid")):validaCPFBeneficiarioJaExistente(e.target.value,listBeneficiarios)?(buildHelper(e.target,"CPF já informado para um Beneficiário"),e.target.classList.add("invalid")):(console.log("RESET HELPER!!!"),resetHelper(e.target),e.target.classList.remove("invalid"),e.target.classList.add("valid")):(buildHelper(e.target,"CPF inválido"),e.target.classList.add("invalid"))});const l=document.getElementById("cnpjBeneficiario");l&&l.addEventListener("change",e=>{console.log("changed CNPJ Benefas"),""==e.target.value||validaCPF(e.target.value)?""!=e.target.value&&e.target.value==document.querySelector('input[name="CNPJ"]').value?(buildHelper(e.target,"CNPJ não pode ser o mesmo do contratante"),e.target.classList.add("invalid")):validaCNPJBeneficiarioJaExistente(e.target.value,listBeneficiarios)?(buildHelper(e.target,"CNPJ já informado para um Beneficiário"),e.target.classList.add("invalid")):(console.log("RESET HELPER!!!"),resetHelper(e.target),e.target.classList.remove("invalid"),e.target.classList.add("valid")):(buildHelper(e.target,"CNPJ inválido"),e.target.classList.add("invalid"))})}}(),function(){console.log("progParcelamentos");let e=document.querySelector("#TIPOPAGAMENTO"),t=document.querySelector(".planoParcelamentos");[...new Set(f.map(e=>e.descricao))].forEach(t=>{let a=f.find(e=>e.descricao==t),o=a.codigo,r=a.agrupamento,n=a.nomeFormaPagamento,l=a.idFormaPagamento,i=document.createElement("option");i.setAttribute("value",o),i.setAttribute("data-id",l),i.setAttribute("data-layout",r),i.innerHTML=n,e.appendChild(i)}),e.addEventListener("change",e=>{let a={};parcelamentoAtual=f.filter(t=>t.idFormaPagamento==e.target.querySelector("option:checked").dataset.id),f.forEach((e,t)=>{a[e.descontoAgravo]=e.opcao}),document.querySelector("#OPCAO_PAGAMENTO").value=parcelamentoAtual[0].opcao;let o=ofertaSelecionada.retornosCalculo.filter(e=>e.opcao==parcelamentoAtual[0].opcao).shift();I(o);let r=o.precificacao.premio.total,n=document.querySelector(".resumoAzul");n.querySelector(".row.total .investimento").innerHTML="Seu investimento total: "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r),n.querySelector(".row.total .investimento").classList.remove("hidden"),t.innerHTML='<option value="" selected="selected" disabled="true">Selecione</option>',t.setAttribute("required","true"),parcelamentoAtual&&parcelamentoAtual.sort((function(e,t){return e.qtdParcelas-t.qtdParcelas})),parcelamentoAtual.forEach(e=>{let o=document.createElement("option");o.value=e.qtdParcelas,o.setAttribute("data-ac",e.antecipacaoComissao),o.innerHTML=1==e.qtdParcelas?e.qtdParcelas+"x de "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e.valorPrimeiraParcela):"1x de "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e.valorPrimeiraParcela)+" + "+(e.qtdParcelas-1)+"x de "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e.valorDemaisParcelas);let r=e.valorPrimeiraParcela?parseFloat(e.valorPrimeiraParcela):0;r=1===e.qtdParcelas?r:r+(e.qtdParcelas-1)*parseFloat(e.valorDemaisParcelas),o.setAttribute("data-percentual",e.descontoAgravo),o.setAttribute("data-valortotal",r.toFixed(2)),o.setAttribute("data-opcao",a[e.descontoAgravo]),t.appendChild(o)}),document.querySelector(".containerParc").classList.remove("hidden");let l=document.querySelector(".antecipacaoComissao");if(l){let e=l.querySelector("#N_Antecipa");antecipaComissaoTransmissao=0,e.checked=!0,"CartaoCredito"!=parcelamentoAtual[0].agrupamento&&!l.classList.contains("hidden")&&l.classList.add("hidden")}handleVisibilityMelhorDataVencimento(),inicializaSelects(),displayCCWarning()});let a=document.getElementById("cardName");a.addEventListener("change",e=>{a.value.length>30&&(a.value=a.value.substring(0,30))}),t.addEventListener("change",handleVisibilityMelhorDataVencimento)}(),function(){let e=window.localStorage.getItem("ofertaSelecionada");Visualforce.remoting.Manager.invokeAction(controllerActionAntecip,e,e=>{let t=JSON.parse(e.replace(/&quot;/g,'"'));window.localStorage.setItem("antecipacaoComissao",JSON.stringify(t))});let t=document.querySelector(".planoParcelamentos"),a=document.querySelector(".antecipacaoComissao"),o=a.querySelector("#S_Antecipa"),r=a.querySelector("#N_Antecipa");o.addEventListener("change",e=>{1==confirm("Tem certeza que deseja antecipar sua comissão?")?(o.checked=!0,r.checked=!1,antecipaComissaoTransmissao=1):(o.checked=!1,r.checked=!0,antecipaComissaoTransmissao=0)}),t.addEventListener("change",e=>{let t=e.target.querySelector("option:checked");if(a){let e,o=document.querySelector("#TIPOPAGAMENTO").value,r=JSON.parse(window.localStorage.getItem("antecipacaoComissao"));const n=JSON.parse(window.localStorage.getItem("dadosUsuario")),l=JSON.parse(window.localStorage.getItem("entradaConsultivo"));let i=n.filter(e=>"DICIO_AGENCIAMENTO"==e.id).shift();i=void 0!==i?parseInt(i.conteudo):null;let c=n.filter(e=>"DICIO_CORRETAGEM"==e.id).shift();for(key in c=void 0!==c?parseInt(c.conteudo):null,r)if(r.hasOwnProperty(key)){let n;try{n=r[key].FormaPagamento__r.Codigo__c}catch{console.log("antecipação sem código cadastrado encontrada")}if(null!=n&&null!=n&&n==o&&(e=r[key]),!l.consultivo.Cliente&&e&&void 0!==e.AntecipacaoAutomatica__c&&a&&null!=c){let o=e.QuantidadeParcelas__c.split(";");if(endosso){a.classList.contains("hidden")&&a.classList.remove("hidden"),a.querySelector(".title-field").innerText="Não é permitida a antecipação de comissão no endosso",a.querySelectorAll("label")[0].classList.add("hidden"),a.querySelectorAll("label")[1].classList.add("hidden"),a.querySelector("#N_Antecipa").checked=!0,antecipaComissaoTransmissao=0,console.log("Entrou aqui 6");break}if(null!=i&&0!=i){!a.classList.contains("hidden")&&a.classList.add("hidden"),antecipaComissaoTransmissao=0,console.log("Entrou aqui 5");break}if(1==e.AntecipacaoAutomatica__c&&o.includes(t.value)){!a.classList.contains("hidden")&&a.classList.add("hidden");let e=a.querySelector("#N_Antecipa");antecipaComissaoTransmissao=1,e.checked=!0,console.log("Entrou aqui 4");break}{let r=!1;if(console.log("antecipacaoEncontrada LimiteMinimo__c "+e.LimiteMinimo__c),console.log("antecipacaoEncontrada LimiteMaximo__c "+e.LimiteMaximo__c),console.log("arrayParcelas "+o),console.log("corretagem "+c),e&&e.LimiteMinimo__c&&e.LimiteMaximo__c&&(r=e.LimiteMinimo__c<c&&c<=e.LimiteMaximo__c),console.log("corretagemOK "+e.Id),console.log("corretagemOK "+r),console.log("planoParc.value "+t.value),(0==i||null==i)&&r&&o.includes(t.value)){a.classList.contains("hidden")&&a.classList.remove("hidden"),antecipaComissaoTransmissao=2,console.log("Entrou aqui 1");break}antecipaComissaoTransmissao=0,!a.classList.contains("hidden")&&a.classList.add("hidden"),console.log("Entrou aqui 2")}}else!a.classList.contains("hidden")&&a.classList.add("hidden"),antecipaComissaoTransmissao=0,console.log("Entrou aqui 3")}}if(I(ofertaSelecionada.retornosCalculo.filter(e=>e.opcao==t.dataset.opcao).shift()),t.dataset.valortotal){let e=document.querySelector(".resumoAzul");e.querySelector(".row.total .investimento").innerHTML="Seu investimento total: "+Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(parseFloat(t.dataset.valortotal)),document.querySelector("#OPCAO_PAGAMENTO").value=t.dataset.opcao,e.querySelector(".row.total .investimento").classList.remove("hidden")}})}(),function(){let e=document.getElementById("formularioProposta")?document.getElementById("formularioProposta"):document.getElementById("formularioPropostaViagem")?document.getElementById("formularioPropostaViagem"):null;e&&e.addEventListener("submit",e=>(e.preventDefault(),!1))}(),document.querySelectorAll('[name="RESPFINANCEIRO"]').forEach(e=>{e.addEventListener("change",e=>{"Nao"==e.target.value?(document.querySelector(".respfin").classList.remove("hidden"),document.querySelector(".respfin").querySelectorAll("select, input:not(#TELOPCIONALRESPFIN):not(#NUMERORESPFIN):not(#COMPLEMENTORESPFIN)").forEach(e=>{console.log("metodo responsavel 1",e),e.removeAttribute("requiredRemoved"),"CPFRESP"==e.id&&e.addEventListener("change",e=>{validaCPF(e.target.value)||""==e.target.value?verifyCPF()?viagem&&(buildHelper(e.target,"O mesmo CPF foi adicionado para outra pessoa."),e.target.classList.add("invalid")):(resetHelper(e.target),e.target.classList.remove("invalid")):(buildHelper(e.target,"CPF inválido"),e.target.classList.add("invalid"))})})):(document.querySelector(".respfin").classList.add("hidden"),document.querySelector(".respfin").querySelectorAll("[required]").forEach(e=>{e.removeAttribute("required"),e.setAttribute("requiredRemoved","true"),e.classList.remove("invalid"),e.value=""}))})}),function(){let e=ofertaSelecionada.orcamento.remuneracoes;if(e.length>0&&(e=e.filter(e=>"agenciamento"!=e.tipoRemuneracao.toLowerCase())),e.length>0){let t=document.querySelector(".listacorretores");if("Individual"==ofertaSelecionada.orcamento.segmento){let e=document.createElement("span");e.className="center-align",e.innerHTML="As porcentagens de corretagem somadas não podem ultrapassar o valor de 100%, então distribua cautelosamente entre os favorecidos",t.appendChild(e)}e.forEach(e=>{let a=document.createElement("div");a.classList.add("section"),a.classList.add("corretagem");let o=document.createElement("div");o.classList.add("row");let r=document.createElement("div");r.classList.add("col"),r.classList.add("s8"),r.innerHTML='<p class="title-field">'+e.tipoRemuneracao+"</p>";let l=document.createElement("div");l.classList.add("col"),l.classList.add("s4"),l.classList.add("right-align"),l.innerHTML=e.percentual+"%",o.appendChild(r),o.appendChild(l),a.appendChild(o);let i=document.createElement("div");i.classList.add("row");let c=document.createElement("div");c.classList.add("col"),c.classList.add("s12"),c.classList.add("center-align");let s=document.createTextNode("Adicionar Favorecido"),d=document.createElement("a");d.href="#",d.appendChild(s),d.classList.add("addCorretor"),d.classList.add("btn-flat"),d.classList.add("btnPortoSimple");let u=document.createElement("i");u.classList.add("material-icons"),u.classList.add("left"),u.innerText="add_circle",d.appendChild(u),c.appendChild(d),i.appendChild(c),a.appendChild(i),ofertaSelecionada.regras.cocorretagem&&"VI-PESSOAS"===ofertaSelecionada.orcamento.codigoProdutoVida&&(d.style.display="none"),"CORRETAGEM"==e.tipoRemuneracao.toUpperCase()&&n(a,e.tipoRemuneracao.toUpperCase(),!0),c.querySelector(".addCorretor").addEventListener("click",t=>{t.preventDefault(),n(a,e.tipoRemuneracao.toUpperCase())}),0==document.getElementsByClassName("corretagem").length&&t.appendChild(a),JSON.parse(window.localStorage.getItem("entradaConsultivo")).consultivo.Cliente&&t.classList.add("corretagemCliente")})}}(),function(){let e=document.getElementById("MELHORPERIODO");if(null!==e){let t="AUTO";if(ofertaSelecionada&&ofertaSelecionada.retornoAceitacao&&Array.isArray(ofertaSelecionada.retornoAceitacao.decisoes)&&ofertaSelecionada.retornoAceitacao.decisoes.length){let e=ofertaSelecionada.retornoAceitacao.decisoes.find(e=>e.descricao&&"TIPO SUBSCRIÇÃO"===e.descricao.toUpperCase());e&&e.acao&&(t=e.acao.toUpperCase())}t?(t=t.toUpperCase().trim(),"TELE"!=t&&"VÍDEO"!=t&&"VIDEO"!=t&&(e.value="I",e.setAttribute("disabled","true"))):(e.value="I",e.setAttribute("disabled","true")),M.FormSelect.init(e,{})}}(),function(){if("Individual"==ofertaSelecionada.orcamento.segmento){let e=JSON.parse(window.localStorage.getItem("dadosUsuario")).filter(e=>"DICIO_AGENCIAMENTO"==e.id).shift();agenciamento=e?e.conteudo:0;let t=document.querySelector("#blocoagenciamento"),a=document.querySelector("#AGENCIAMENTO_PARA"),o=document.querySelector("#AGENCIADOR");0==agenciamento?(a.removeAttribute("required"),o.removeAttribute("required"),t.classList.add("hidden")):(a.setAttribute("required","required"),a.addEventListener("change",e=>{let t=document.querySelectorAll(".busca_agenciador");if(t.forEach(e=>{e.parentNode.classList.remove("hidden"),e.value=""}),document.querySelector("#btn_busca_agenciador").parentNode.classList.remove("hidden"),document.querySelector("#AGENCIADOR").parentNode.parentNode.classList.add("hidden"),"CORRETOR"==e.target.value){document.querySelector("#btn_busca_agenciador").parentNode.classList.add("hidden");let e=document.querySelector("#CPF_AGENCIADOR");e.parentNode.classList.add("hidden"),e.setAttribute("disabled","disabled");let a=document.querySelector("#NOME_AGENCIADOR");a.parentNode.classList.add("hidden"),a.setAttribute("disabled","disabled");let o=document.querySelector("#CODIGO_AGENCIADOR");o.parentNode.classList.add("hidden"),o.setAttribute("disabled","disabled");let n=document.querySelector("#AGENCIADOR");n.parentNode.classList.add("hidden"),n.setAttribute("disabled","disabled"),n.removeAttribute("required");let l=document.querySelector("#SUSEP_AGENCIADOR");l.value="",l.removeAttribute("disabled"),l.setAttribute("required","required"),l.parentNode.classList.remove("hidden"),l.classList.remove("invalid"),l.classList.remove("valid"),l.addEventListener("keyup",(function(e){clearTimeout(r),r=setTimeout((function(){i(e.target)}),h)})),l.addEventListener("keydown",(function(){clearTimeout(r)})),l.addEventListener("blur",(function(e){clearTimeout(r),i(e.target)})),t.forEach(e=>{e.setAttribute("disabled","disabled")})}if("AGENCIADOR"==e.target.value){document.querySelector("#btn_busca_agenciador").parentNode.classList.remove("hidden");let e=document.querySelector("#SUSEP_AGENCIADOR");e.parentNode.classList.add("hidden"),e.setAttribute("disabled","disabled"),e.value="";let a=document.querySelector("#CPF_AGENCIADOR");a.parentNode.classList.remove("hidden"),a.removeAttribute("disabled");let o=document.querySelector("#NOME_AGENCIADOR");o.parentNode.classList.remove("hidden"),o.removeAttribute("disabled");let r=document.querySelector("#CODIGO_AGENCIADOR");r.parentNode.classList.remove("hidden"),r.removeAttribute("disabled");let n=document.querySelector("#AGENCIADOR");n.parentNode.classList.remove("hidden"),n.removeAttribute("disabled"),n.setAttribute("required","required"),t.forEach(e=>{e.removeAttribute("disabled")})}t.forEach(e=>{e.focus(),e.blur()})}),o.addEventListener("change",e=>{let t=JSON.parse(window.localStorage.getItem("jsonAgenciadores")).agenciadores;Array.isArray(t)&&t.length&&t.forEach(t=>{if(t.cpf==e.target.value||t.cnpj==e.target.value){let e=t.cpf;e&&""!==e&&"null"!=e||(e=t.cnpj),null!=t.susep&&"null"!=t.susep||(t.susep=""),null!=t.codigoAgenciador&&"null"!=t.codigoAgenciador||(t.codigoAgenciador=""),document.querySelector("#SUSEP_AGENCIADOR").value=t.susep,document.querySelector("#CPF_AGENCIADOR").value=e,document.querySelector("#NOME_AGENCIADOR").value=t.nome,document.querySelector("#CODIGO_AGENCIADOR").value=t.codigoAgenciador,document.querySelectorAll(".busca_agenciador").forEach(e=>{e.hasAttribute("disabled")?(e.removeAttribute("disabled"),e.focus(),e.blur(),e.setAttribute("disabled","disabled")):(e.focus(),e.blur())})}})}))}}(),console.log("tela proposta"),window.localStorage.getItem("dadosTelaProposta")&&(JSON.parse(window.localStorage.getItem("dadosTelaProposta")).forEach(e=>{let t=document.getElementById(e.id);if(console.log("preencher campo",t),t)if("SELECT"==t.tagName){t.querySelectorAll("option").forEach(e=>{e.removeAttribute("selected")});let a=t.querySelector('option[value="'+e.conteudo+'"]');a&&(a.setAttribute("selected","selected"),t.M_FormSelect._handleSelectChangeBound())}else t.value=e.conteudo}),M.updateTextFields(),window.localStorage.removeItem("dadosTelaProposta")),document.querySelectorAll("#formProposta .listaSegurados .segurado").length==window.localStorage.getItem("qtdSeguradosProposta")&&(JSON.parse(window.localStorage.getItem("dadosSegurados")).forEach(e=>{let t=e.id?document.getElementById(e.id):[...document.querySelectorAll('[name="'+e.name+'"]')].find(e=>e.checked);"SELECT"==t.tagName?(t.querySelectorAll("option").forEach(e=>{e.removeAttribute("selected")}),t.querySelector('option[value="'+e.conteudo+'"]').setAttribute("selected","selected"),t.M_FormSelect._handleSelectChangeBound()):"radio"==t.type?[...document.querySelectorAll('[name="'+e.name+'"]')].find(t=>t.value==e.conteudo).checked=!0:t.value=e.conteudo}),M.updateTextFields(),window.localStorage.removeItem("dadosSegurados"),window.localStorage.removeItem("qtdSeguradosProposta")),function(){let e=JSON.parse(window.localStorage.getItem("dadosUsuario")),t=JSON.parse(window.localStorage.getItem("entradaConsultivo")).consultivo.Cliente;e.forEach(e=>{if(document.querySelector("#"+e.id)){let a=document.querySelector("#"+e.id);switch(a.tagName){case"INPUT":a.value=e.conteudo.toUpperCase(),"DICIO_CORRETAGEM"==a.id&&t&&(a.setAttribute("hidden","hidden"),a.parentNode.classList.add("corretagemCliente")),"DICIO_DATA_SAIDA"!=a.id&&"DICIO_DATA_RETORNO"!=a.id||(a.value=e.conteudo.split("-").reverse().join("/")),"DICIO_DATANASCIMENTO"==a.id&&(a.value=e.conteudo.split("-").reverse().join("/")),"DICIO_NOME"!=a.id&&"CPF"!=a.id&&"DICIO_NOMESOCIAL"!=a.id&&(a.setAttribute("readonly","readonly"),a.setAttribute("disabled","disabled"));break;case"SELECT":a.value=e.conteudo,a.setAttribute("disabled","true"),a.querySelectorAll("option").forEach(e=>{e.removeAttribute("selected"),e.setAttribute("disabled","disabled")});let o="false"==e.conteudo.toString()||"true"==e.conteudo.toString()?"false"==e.conteudo.toString()?"NAO":"SIM":e.conteudo;a.querySelector('option[value="'+o+'"]').setAttribute("selected","selected"),a.querySelector('option[value="'+o+'"]').removeAttribute("disabled")}}})}(),function(){let e=document.getElementById("DICIO_DATANASCIMENTO").value,t=null!=e&&new Date(e.split("/").reverse().join("-"));if(t){let e=Date.now()-t.getTime(),a=new Date(e),o=Math.abs(a.getUTCFullYear()-1970),r=document.getElementById("DICIO_IDADE");r&&(r.value=o)}}(),function(){let e=document.getElementById("DICIO_REGIME_TRABALHO");if(e){let t=document.querySelector("#EMPRESATRABALHO"),a=document.querySelector("#RAMOEMPRESA");"CLT"==e.value?(t.parentNode.classList.remove("hidden"),t.setAttribute("required","required"),a.removeAttribute("required")):"PROFISSIONAL_LIBERAL"==e.value?(a.parentNode.classList.remove("hidden"),a.setAttribute("required","required"),t.removeAttribute("required")):(t.parentNode.classList.add("hidden"),a.parentNode.classList.add("hidden"),t.removeAttribute("required"),a.removeAttribute("required"))}}(),function(){let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")),t=window.localStorage.getItem("ofertaSelecionada");ofertaSelecionada=e.ofertas.filter(e=>e.orcamento.numeroOrcamento==t).shift()||e.ofertas[0];let a=ofertaSelecionada.retornoAceitacao;if(a&&null!=a.decisoes){if(a.decisoes.filter(e=>"TermoGuarda"==e.acao).length>0){document.querySelectorAll(".termoguarda").forEach(e=>{e.classList.remove("hidden")})}}}(),function(){let e=document.getElementById("TIPODOCUMENTO");if(e){e.addEventListener("change",e=>{if("0"!=e.target.value){document.querySelector("#NUMERODOCUMENTO").setAttribute("required","required"),document.querySelector("#ORGAOEMISSOR").setAttribute("required","required"),document.querySelector("#DATAEXPEDICAO").setAttribute("required","required")}});var t=new Event("change");e.dispatchEvent(t)}}(),1==checkOfertaSelecionadaIsEndossoVI()?setEndossoPage():1==checkOfertaSelecionadaIsEndossoViagem()&&setEndossoViagemPage()}var S;formatacaoFormularioAPTLMK(),formatacaoFormularioPortoVidaON1(),copiarCPF(),exibirBotaoMesmoContatoEmergencia()});var cepResidencialEspecial=!1,cepComercialEspecial=!1;function preencheEnderecoCEP(e,t,a){console.log("retorno serviço >>",t);const o=document.getElementById("ENDERECO"+e);o.innerHTML='<option value="0" disabled="true" selected="true">Endereço</option>';const r=e=>e.replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t)),n=document.getElementById("ESTADO"+e),l=a?document.getElementById("CEP"):document.getElementById("CEP"+e);if(t.length){if(t.forEach(e=>{let t=e.obterEnderecoPorCEPResponse.enderecosGuiaPostalEBO.enderecoGuiaPostalEBO.enderecoCompleto,a=`${t.logradouro}, ${t.bairro}, ${t.cidade}, ${t.uf}`;a=r(a),t.logradouro=r(t.logradouro),t.bairro=r(t.bairro),t.cidade=r(t.cidade),t.uf=r(t.uf);const n=document.createElement("option");n.textContent=a,n.value=a,n.setAttribute("data-logradouro",t.logradouro),n.setAttribute("data-bairro",t.bairro),n.setAttribute("data-cidade",t.cidade),n.setAttribute("data-uf",t.uf),o.appendChild(n)}),1!==t.length){const e=document.createElement("option");e.textContent="Não encontrei meu endereço",e.id="NA",e.value="NA",o.appendChild(e)}l&&(l.classList.remove("invalid"),l.classList.add("valid"))}else{l.classList.add("invalid"),buildHelper(l,"CEP Inválido");const t=document.getElementById("CIDADE"+e),a=document.getElementById("LOGRADOURO"+e),r=document.getElementById("BAIRRO"+e);t.value="",a.value="",r.value="",n.value="",o.innerHTML='<option value="0" disabled="true" selected="true">Endereço</option>',o.M_FormSelect._handleSelectChangeBound(),n.M_FormSelect._handleSelectChangeBound(),[t,n,a,r].forEach(disableInput)}M.FormSelect.init(o,{})}function preencheRendaMensal(e,t){t.sort((e,t)=>parseInt(e.codigo)-parseInt(t.codigo)),t.forEach(t=>{const a=document.createElement("option");a.text=t.descricao,a.value=t.codigo,e.appendChild(a)}),M.FormSelect.init(e,{})}function enableInput(e){e.id.startsWith("ESTADO")?e.parentElement.parentElement.classList.remove("disabled"):e.parentElement.classList.remove("disabled"),e.disabled=!1}function disableInput(e){e.id.startsWith("ESTADO")?e.parentElement.parentElement.classList.add("disabled"):e.parentElement.classList.add("disabled"),e.disabled=!0}function numeroComNCaracteres(e,t){return e.toString().split("").length<t?Array(t-e.toString().split("").length).fill(0).concat(e.toString().split("")).join(""):e}function storeRetornoId(e){"VIAGEM_VIDA_ON"==JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")).consultivo.codigoOfertaConsultiva&&window.localStorage.setItem("idFormaPagamento",e)}function gerarContrato(){const e=["REJEITADA","CANCELADA","ERRO","IGNORADA","EXPIRADA","DESCONHECIDO"];document.querySelector(".modalLoaderErro").classList.remove("on"),window.localStorage.setItem("retornoTransmissao",document.querySelector("#Transmissao").value);let t=window.localStorage.getItem("retornoTransmissao"),a=JSON.parse(t),o=JSON.parse(window.localStorage.getItem("jsonEntradaTransmissao")),r=!0;if(hasErroVidaOn=t.includes("erroVidaOnMessage"),hasErroVidaOn){document.querySelector("#formProposta > .row.resumo").classList.add("hidden");let e=document.getElementById("pageErros");e.classList.remove("hidden"),document.querySelector(".voltarErroTransmissao").addEventListener("click",t=>{e.classList.add("hidden"),document.querySelector("#formProposta > .formulario").classList.remove("hidden")}),e.querySelector(".errosGenericos").innerHTML="";let t=document.createElement("span");return t.classList.add("label-error"),t.classList.add("col"),t.classList.add("s12"),t.innerHTML=a.erroVidaOnMessage,void e.querySelector(".errosGenericos").appendChild(t)}console.log("Retorno Financeiro: ......................",JSON.stringify(a.retornoFinanceiro)),a.retornoFinanceiro&&console.log("OBJ STARGATE: ......................",JSON.stringify(a.retornoFinanceiro.autorizacaoCartao.stargate)),a.retornoFinanceiro&&console.log("OBJ PORTOPAG: ......................",JSON.stringify(a.retornoFinanceiro.autorizacaoCartao.portopag));let n=!1,l=!1;if(a.retornoFinanceiro&&a.retornoFinanceiro.autorizacaoCartao&&null!=o.propostas[0].contratantes[0].dadosPagamento.dadosCartaoCredito&&(console.log("Entrou no validacao cartao criticas"),a.retornoFinanceiro.autorizacaoCartao.portopag&&(l=a.retornoFinanceiro.autorizacaoCartao.portopag.cobrancas&&a.retornoFinanceiro.autorizacaoCartao.portopag.cobrancas.some(t=>t.estado&&e.includes(t.estado)),console.log("CobrancaRejeitadaPortoPag?......",l),n=!a.retornoFinanceiro.autorizacaoCartao.portopag.cobrancas||l),console.log("Tem critica PortoPag?",n),r=a.retornoFinanceiro.autorizacaoCartao.stargate&&2==a.retornoFinanceiro.autorizacaoCartao.stargate.codigo||a.retornoFinanceiro.autorizacaoCartao.portopag&&!n||!1),console.log("VALIDAÇÃO PAGAMENTO: ......................",r),[a.validacoesEstruturais.valido,r,a.devolutivasPropostas.every(e=>e.retornoAceitacao.recusas?0==e.retornoAceitacao.recusas.length:e.retornoAceitacao.analises?0==e.retornoAceitacao.analises.length:!e.retornoAceitacao.avisos||0==e.retornoAceitacao.avisos.length)].every(e=>e)){let e=document.getElementById("pageContrato");document.querySelector("#formProposta").classList.add("hidden"),e.classList.remove("hidden"),irPasso(0,3),!viagem&&e.querySelector("#fieldPassageiro")&&(e.querySelector("#fieldPassageiro").innerText="Nome do segurado");o.propostas[0].codigoProdutoVida;a.devolutivasPropostas.forEach(t=>{let a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=o.propostas.find(e=>e.indice==(t.proposta?t.proposta.indice:t.indice)).contratantes[0].grupos[0].segurados[0].pessoa.nome;let n=document.createElement("td");const l=t.proposta.origem+"-"+numeroComNCaracteres(t.proposta.numero,8);n.innerHTML=t.message||l,"Enviar por e-mail"===infoPayload?btnEnviarPorEmail(l):console.log("não passou***"),a.appendChild(r),a.appendChild(n);const i=JSON.parse(window.localStorage.getItem("entradaConsultivo"));if("VIDA_INDIVIDUAL"===i.consultivo.codigoOfertaConsultiva||"VIDA_INDIVIDUAL_VP"===i.consultivo.codigoOfertaConsultiva){const e=JSON.parse(window.localStorage.getItem("jsonEntradaTransmissao")),t=e.propostas[0],o=!t.assinaturaEletronica&&!t.reaproveitarAssinatura||t.termoGuarda;if(console.log("------------proposta-----------"),console.log(t,o,e),console.log("-------------------------------"),o){const e=document.createElement("td");if(e.classList.add("center-align"),e.innerHTML='<section class="modalLoaderErro" style="opacity: 1; background: none; position: relative; visibility: visible; width: auto; height: auto;"><div class="content"><div class="loader" style="width: 25px; height: 25px;"></div><div><p>Carregando PDF...</p></div></div></section>',e.id="pdfUrl",a.appendChild(e),null!==l){const e=setInterval(()=>{console.log("Visualforce",Visualforce),Visualforce.remoting.Manager.invokeAction(controllerActionName,l,(function(t,a){if(t){localStorage.removeItem(PERSONALIZAR_OFERTA_KEY),console.log("result",t);const a=document.getElementById("pdfUrl");a&&("Proposta Recusada"!=t?(console.log("entrou no if tem link"),a.innerHTML="<a href="+t+' target="_blank" rel="noopener noreferrer" style="display: inline-block"><div style="width: 25px"><?xml version="1.0" encoding="UTF-8"?><svg enable-background="new 0 0 512 512" version="1.1" viewBox="0 0 512 512" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path d="M128,0c-17.6,0-32,14.4-32,32v448c0,17.6,14.4,32,32,32h320c17.6,0,32-14.4,32-32V128L352,0H128z" fill="#E2E5E7"/><path d="m384 128h96l-128-128v96c0 17.6 14.4 32 32 32z" fill="#B0B7BD"/><polygon points="480 224 384 128 480 128" fill="#CAD1D8"/><path d="M416,416c0,8.8-7.2,16-16,16H48c-8.8,0-16-7.2-16-16V256c0-8.8,7.2-16,16-16h352c8.8,0,16,7.2,16,16  V416z" fill="#F15642"/><g fill="#fff"><path d="m101.74 303.15c0-4.224 3.328-8.832 8.688-8.832h29.552c16.64 0 31.616 11.136 31.616 32.48 0 20.224-14.976 31.488-31.616 31.488h-21.36v16.896c0 5.632-3.584 8.816-8.192 8.816-4.224 0-8.688-3.184-8.688-8.816v-72.032zm16.88 7.28v31.872h21.36c8.576 0 15.36-7.568 15.36-15.504 0-8.944-6.784-16.368-15.36-16.368h-21.36z"/><path d="m196.66 384c-4.224 0-8.832-2.304-8.832-7.92v-72.672c0-4.592 4.608-7.936 8.832-7.936h29.296c58.464 0 57.184 88.528 1.152 88.528h-30.448zm8.064-72.912v57.312h21.232c34.544 0 36.08-57.312 0-57.312h-21.232z"/><path d="m303.87 312.11v20.336h32.624c4.608 0 9.216 4.608 9.216 9.072 0 4.224-4.608 7.68-9.216 7.68h-32.624v26.864c0 4.48-3.184 7.92-7.664 7.92-5.632 0-9.072-3.44-9.072-7.92v-72.672c0-4.592 3.456-7.936 9.072-7.936h44.912c5.632 0 8.96 3.344 8.96 7.936 0 4.096-3.328 8.704-8.96 8.704h-37.248v0.016z"/></g><path d="m400 432h-304v16h304c8.8 0 16-7.2 16-16v-16c0 8.8-7.2 16-16 16z" fill="#CAD1D8"/></svg></div></a><div style="font-size: 12px;"><div class="tooltip" style="display: inline-block" data-descricao="Após impressão e assinatura encaminhar os documentos para emissao@vidaindividual.com.br"><i class="fas fa-info-circle"></i></div> Imprimir PDF da proposta para assinatura</div>'):(console.log("entrou no ELSE não tem link"),a.remove())),clearInterval(e)}}))},1500)}else alert("Erro ao carregar pdf para impressão. Recarregue a página.")}const r=t.remuneracoes.some(e=>e.favorecidos.some(e=>e.corretorLider&&e.corretorResponde)),n=Array.from(document.getElementsByName("FORMAPREENCHIMENTO")).some(e=>"tela"==e.value&&e.checked);if(console.log("MMR - showQuestionarioCorretor",r,l,n),r&&null!==l&&!n){const e=document.createElement("td");e.classList.add("center-align"),e.innerHTML='<section class="modalLoaderErro" style="opacity: 1; background: none; position: relative; visibility: visible; width: auto; height: auto;"><div class="content"><div class="loader" style="width: 25px; height: 25px;"></div><div><p>Carregando Link...</p></div></div></section>',a.appendChild(e),Visualforce.remoting.Manager.invokeAction(controllerActionUrl,l,(function(t,o){console.log("result",t,o),t&&(console.log("result",t),e.innerHTML='<div style="width: 15px; margin: auto;"><?xml version="1.0" encoding="iso-8859-1"?><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 490 490" style="enable-background:new 0 0 490 490;" xml:space="preserve"><g><g id="XMLID_25_"><g><polygon style="fill:#AFB6BB;" points="430,100 340,100 340,10"/><polygon style="fill:#FFFFFF;" points="430,100 430,480 60,480 60,10 340,10 340,100 "/></g><g><path style="fill:#231F20;" d="M439.976,100c-0.001-2.602-0.993-5.159-2.905-7.071l-90-90c-1.913-1.912-4.47-2.904-7.071-2.905V0H60c-5.523,0-10,4.477-10,10v470c0,5.523,4.477,10,10,10h370c5.523,0,10-4.477,10-10V100H439.976z M350,34.142L405.858,90H350V34.142z M70,470V20h260v80c0,5.523,4.477,10,10,10h80v360H70z"/><rect x="130" y="160" style="fill:#231F20;" width="260" height="20"/><rect x="100" y="220" style="fill:#231F20;" width="290" height="20"/><rect x="100" y="280" style="fill:#231F20;" width="290" height="20"/><rect x="100" y="340" style="fill:#231F20;" width="290" height="20"/><rect x="100" y="400" style="fill:#231F20;" width="230" height="20"/><rect x="355" y="400" style="fill:#231F20;" width="35" height="20"/><rect x="100" y="45" style="fill:#231F20;" width="60" height="20"/><rect x="100" y="80" style="fill:#231F20;" width="120" height="20"/></g></g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></div><p style="font-size: 12px;">Clique <a href="'+t+'" target="_blank" rel="noopener noreferrer">aqui</a> para abrir o questionário</p>',a.appendChild(e)),console.log("location",document.location),o.statusCode>=400&&"portoseguro--sniper--c.sandbox.vf.force.com"==document.location.hostname&&(e.innerHTML="<span>Link indisponível</span>",alert(`Erro ao processar requisição ao servidor - HTTP Status Code: [${o.statusCode}] em ${o.action}.${o.method}`),console.error(o))}))}}if("Viagem"==o.propostas[0].segmento){let e=document.createElement("i");e.classList.add("fas"),e.classList.add("fa-file-download");let o=document.createElement("a");o.setAttribute("target","_blank"),o.href="https://"+window.location.hostname+"/apex/VoucherPage1?numero="+t.proposta.origem+"-"+numeroComNCaracteres(t.proposta.numero,8),o.classList.add("btnPortoSuccess"),o.classList.add("download"),o.appendChild(e);let r=document.createElement("td");r.appendChild(o),a.appendChild(r),document.querySelector("#DICIO_AVENTURA").required=!1,document.querySelector("#DICIO_AVENTURA").parentElement.classList.add("hidden")}e.querySelector(".retornoPropostas table").appendChild(a)}),"Viagem"!=o.propostas[0].segmento&&document.querySelector("#fieldVoucher").classList.add("hidden");let t=!1;if(a.devolutivasPropostas.length>0&&(t=a.devolutivasPropostas.every(e=>!(!e.retornoAceitacao||!e.retornoAceitacao.pendencias)&&e.retornoAceitacao.pendencias.length>0)),t){e.querySelector(".retornoPropostas").innerHTML+='<div id="pendenciasProposta" class="col s12"></div>';let t=document.createElement("th");t.innerHTML=viagem?"Passageiro":"Segurado";let o=document.createElement("th");o.innerHTML="Status";let r=document.createElement("tr");r.appendChild(t),r.appendChild(o);let n=document.createElement("table");n.appendChild(r),viagem||(n=document.createElement("div"));let l=JSON.parse(window.localStorage.getItem("jsonEntradaTransmissao"));e.querySelector("#pendenciasProposta").innerHTML='<h1 class="center-align">Pendências</h1>',a.devolutivasPropostas.forEach(e=>{let t=l.propostas.find(t=>t.indice==e.proposta.indice).contratantes[0].grupos[0].segurados[0].pessoa.nome,a=e.retornoAceitacao?e.retornoAceitacao.pendencias:null;a&&a.length>0&&a.forEach(a=>{let o=document.createElement("td");o.classList.add("nowrap"),o.innerHTML='<span style="margin-right: 20px">'+e.proposta.indice+".</span> "+t;let r=document.createElement("div");r.classList.add("label-warning"),r.innerHTML=a.mensagens.cliente;let l=document.createElement("td");l.appendChild(r);let i=document.createElement("tr");i.appendChild(o),i.appendChild(l),viagem?n.appendChild(i):n.appendChild(r)})}),e.querySelector("#pendenciasProposta").appendChild(n)}}else{document.querySelector("#formProposta > .row.resumo").classList.add("hidden");let e=document.getElementById("pageErros");e.classList.remove("hidden"),document.querySelector(".voltarErroTransmissao").addEventListener("click",t=>{e.classList.add("hidden"),document.querySelector("#formProposta > .formulario").classList.remove("hidden")}),function(){e.querySelector(".errosGenericos").innerHTML="";let t=!1;if(!a.validacoesEstruturais.valido||!r){let o=a.validacoesEstruturais.problemas.filter(e=>!e.indice);o.length>0&&(e.querySelector(".errosGenericos").innerHTML+="<b>Contratação</b>"),o.forEach(a=>{let o=document.createElement("span");o.classList.add("label-error"),o.classList.add("col"),o.classList.add("s12"),o.innerHTML=void 0!==a.integracao?a.integracao+" - "+a.descricao:void 0!==a.codigo?a.codigo+" - "+a.descricao:a.descricao,e.querySelector(".errosGenericos").appendChild(o),t=!0})}if(console.log("hasErros?...",t),!t&&(!r||a.retornoFinanceiro&&2!=a.retornoFinanceiro.autorizacaoCartao.stargate.codigo&&null!=a.retornoFinanceiro.autorizacaoCartao.stargate.codigo)){e.querySelector(".errosGenericos").innerHTML+="<b>Efetivação do pagamento</b>";let t=document.createElement("span");t.classList.add("label-error"),t.classList.add("col"),t.classList.add("s12"),a.retornoFinanceiro.autorizacaoCartao.stargate&&(t.innerHTML=""!=a.retornoFinanceiro.autorizacaoCartao.stargate.mensagem?a.retornoFinanceiro.autorizacaoCartao.stargate.mensagem:""!=a.validacoesEstruturais.problemas[0].descricao?a.validacoesEstruturais.problemas[0].descricao:"Transação inválida"),a.retornoFinanceiro.autorizacaoCartao.portopag&&(console.log("Mensagem cobrança nao efetivada portopag"),t.innerHTML=l?"Cobrança não Efetivada":""!=a.retornoFinanceiro.autorizacaoCartao.portopag.mensagem?a.retornoFinanceiro.autorizacaoCartao.portopag.mensagem:""!=a.validacoesEstruturais.problemas[0].descricao?a.validacoesEstruturais.problemas[0].descricao:"Transação inválida"),e.querySelector(".errosGenericos").appendChild(t)}}(),function(){e.querySelector(".errosEspecificos").innerHTML="";let t=a.devolutivasPropostas.every(e=>!(e.retornoAceitacao.recusas&&0!=e.retornoAceitacao.recusas.length||e.retornoAceitacao.analises&&0!=e.retornoAceitacao.analises.length||e.retornoAceitacao.avisos&&0!=e.retornoAceitacao.avisos.length)),o=a.validacoesEstruturais.problemas.filter(e=>e.indice);if(!a.validacoesEstruturais.valido&&o.length>0){e.querySelector(".errosEspecificos").innerHTML+="<b>VALIDAÇÃO DOS DADOS DA CONTRATAÇÃO</b>";let t=JSON.parse(window.localStorage.getItem("jsonEntradaTransmissao")),a=document.createElement("th");a.innerHTML=viagem?"Passageiro":"Segurado";let r=document.createElement("th");r.innerHTML="Status";let n=document.createElement("tr");n.appendChild(a),n.appendChild(r);let l=document.createElement("table");l.appendChild(n),e.querySelector(".errosEspecificos").appendChild(l),t.propostas.forEach(e=>{let a=o.filter(t=>t.indice==e.indice);if(a.length>0)a.forEach(e=>{let a=t.propostas.find(t=>t.indice==e.indice).contratantes[0].grupos[0].segurados[0].pessoa.nome,o=document.createElement("td");o.innerHTML='<span style="margin-right: 20px;">'+e.indice+".</span> "+a;let r=document.createElement("span");r.classList.add("label-error"),r.innerHTML=e.descricao;let n=document.createElement("td");n.appendChild(r);let i=document.createElement("tr");i.appendChild(o),i.appendChild(n),l.appendChild(i)});else{let t=e.contratantes[0].grupos[0].segurados[0].pessoa.nome,a=document.createElement("td");a.innerHTML='<span style="margin-right: 20px;">'+e.indice+".</span> "+t;let o=document.createElement("span");o.classList.add("label-success"),o.innerHTML=viagem?"Tudo certo para a contratação desse passageiro":"Tudo certo para a contratação desse segurado";let r=document.createElement("td");r.appendChild(o);let n=document.createElement("tr");n.appendChild(a),n.appendChild(r),l.appendChild(n)}})}if(!t){e.querySelector(".errosEspecificos").innerHTML+="<b>Processo de aceitação da seguradora</b>";let t=document.createElement("th");t.innerHTML=viagem?"Passageiro":"Segurado";let o=document.createElement("th");o.innerHTML="Status";let r=document.createElement("tr");r.appendChild(t),r.appendChild(o);let n=document.createElement("table");n.appendChild(r);let l=JSON.parse(window.localStorage.getItem("jsonEntradaTransmissao"));a.devolutivasPropostas.forEach(e=>{let t=l.propostas.find(t=>t.indice==e.proposta.indice).contratantes[0].grupos[0].segurados[0].pessoa.nome,a=e.retornoAceitacao.avisos.concat(e.retornoAceitacao.analises).concat(e.retornoAceitacao.recusas);if(a.length>0)a.forEach(a=>{let o=document.createElement("td");o.innerHTML='<span style="margin-right: 20px">'+e.proposta.indice+".</span> "+t;let r=document.createElement("span");r.classList.add("label-error"),r.innerHTML=a.mensagens.cliente;let l=document.createElement("td");l.appendChild(r);let i=document.createElement("tr");i.appendChild(o),i.appendChild(l),n.appendChild(i)});else{let a=document.createElement("td");a.innerHTML='<span style="margin-right: 20px">'+e.proposta.indice+".</span> "+t;let o=document.createElement("span");o.classList.add("label-success"),o.innerHTML=viagem?"Tudo certo para a contratação desse passageiro":"Tudo certo para a contratação desse segurado";let r=document.createElement("td");r.appendChild(o);let l=document.createElement("tr");l.appendChild(a),l.appendChild(r),n.appendChild(l)}}),e.querySelector(".errosEspecificos").appendChild(n)}}()}window.scrollTo({top:0,behavior:"smooth"})}function callConsultaAgenciadores(){let e=document.querySelector("#AGENCIADOR"),t=document.querySelector("#AGENCIAMENTO_PARA");e.parentNode.parentNode.classList.add("hidden"),e.innerHTML="",e.innerHTML='<option disabled="true" selected="selected" value="0">Selecione</option>',window.localStorage.setItem("jsonAgenciadores","{agenciadores:[]}");let a=document.querySelector("#CPF_AGENCIADOR").value+"",o="",r="";a=a.replace(/\D/g,""),11==a.length?o=a:r=a;let n={susep:document.querySelector("#SUSEP_AGENCIADOR").value,codigoAgenciador:document.querySelector("#CODIGO_AGENCIADOR").value,cpf:o,cnpj:r,nome:document.querySelector("#NOME_AGENCIADOR").value,papel:t.value};consultaAgenciadores(JSON.stringify(n))}function retornoCallAgenciadores(){let e=document.querySelector("#AGENCIAMENTO_PARA"),t=document.querySelector("#retornoAgenciadores").value;window.localStorage.setItem("jsonAgenciadores",t);let a=JSON.parse(window.localStorage.getItem("jsonAgenciadores")).agenciadores,o=document.querySelector("#AGENCIADOR");Array.isArray(a)&&a.length&&(a.forEach(e=>{let t=document.createElement("option"),a=e.codigoAgenciador;null!=a&&"null"!=a||(a="???");let r=e.cpf;null!=r&&"null"!=r||(r=e.cnpj),t.value=r,t.innerHTML=a+" - "+e.nome,o.appendChild(t)}),1!=a.length&&"Corretor"!=e.value||(o.selectedIndex=1,o.dispatchEvent(new Event("change")))),M.FormSelect.init(o,{}),document.querySelector("#AGENCIADOR").parentNode.parentNode.classList.remove("hidden")}function retornoCallCorretores(){let e=document.querySelector("#retornoCorretores").value,t=JSON.parse(e),a=document.querySelectorAll('.listacorretores .row.corretorFavorecido input[type="text"]:not([disabled])');[].forEach.call(a,e=>{e.value==t.corretor&&(t.encontrado?(e.classList.add("valid"),e.classList.remove("invalid")):(e.classList.remove("valid"),e.classList.add("invalid")))});let o=document.querySelector("#SUSEP_AGENCIADOR");o.value==t.corretor&&(t.encontrado?(o.classList.add("valid"),o.classList.remove("invalid")):(o.classList.remove("valid"),o.classList.add("invalid")))}function handleVisibilityMelhorDataVencimento(){let e=document.querySelector(".dataVenc"),t=document.querySelector(".planoParcelamentos");if(!e)return;let a=t&&"ADC"==parcelamentoAtual[0].agrupamento||52==parcelamentoAtual[0].codigo||41==parcelamentoAtual[0].codigo;"CartaoCredito"==parcelamentoAtual[0].agrupamento||11==parcelamentoAtual[0].codigo||a&&1==t.value?e.classList.add("hidden"):(a&&1!=t.value||"Boleto"==parcelamentoAtual[0].agrupamento)&&e.classList.remove("hidden")}function displayCCWarning(){let e=document.querySelector(".ccWarningMessage"),t=parcelamentoAtual[0].codigo;62==t?e.classList.remove("hidden"):62!=t&&e.classList.add("hidden")}function checkEndossoPgmt(){let e=getOfertaSelecionada();if(e.orcamento.tiposEndosso&&e.orcamento.tiposEndosso.cad&&e.orcamento.contratantes[0].manterPlanoParcelamento){document.querySelector(".formapagamento").classList.add("hidden")}}function apagarPagmento1(){let e=getOfertaSelecionada();JSON.parse(window.localStorage.getItem("jsonEntradaCalculo"));if(e.orcamento.tiposEndosso&&e.orcamento.tiposEndosso.cad&&e.orcamento.contratantes[0].manterPlanoParcelamento){return document.querySelector(".formapagamento").innerHTML="",!0}}function formatacaoFormularioAPTLMK(){let e=window.localStorage.getItem("jsonEntradaCalculo");if(null!=e&&(e=JSON.parse(e).consultivo.codigoOfertaConsultiva,"APTLMK"==e)){document.querySelector("#NUMERODOCUMENTO").value="",document.querySelector("#ORGAOEMISSOR").value="",document.querySelector("#DATAEXPEDICAO").value="",document.querySelector("#TIPODOCUMENTO").removeAttribute("required"),document.querySelector("#NUMERODOCUMENTO").removeAttribute("required"),document.querySelector("#ORGAOEMISSOR").removeAttribute("required"),document.querySelector("#DATAEXPEDICAO").removeAttribute("required"),document.querySelector("#DICIO_FUMANTE").removeAttribute("required"),document.querySelectorAll(".vacina, #BLOCOFUMANTE").forEach(e=>e.classList.add("hidden")),document.querySelector(".regimeTrabalho").classList.add("hidden"),document.querySelector("#DICIO_CICLOCOVID option:first-child").setAttribute("selected","selected"),document.querySelector("#DICIO_REGIME_TRABALHO").value="Regime Trabalho",document.querySelector("#EMPRESATRABALHO").value="Empresa Trabalho",document.querySelector("#RAMOEMPRESA").value="Ramo Empresa",document.querySelector("#DICIO_FUMANTE option:first-child").setAttribute("selected","selected"),console.log("Até aqui está ok"),document.getElementById("BLOCOENDCOMERCIAL").style.display="none",document.querySelectorAll(".termoguarda").forEach(e=>e.classList.remove("hidden")),document.querySelector("#pergunta_2").style.margin="25px 0 0 0",document.querySelector(".termoPadrao").classList.add("hidden"),document.querySelector(".termoAPTLMKT").classList.remove("hidden");let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.ramoSeguro,t=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.rotulo,a=window.localStorage.getItem("ofertaSelecionada");console.log("ofertaSelecionada:"+a);let o=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].parcelamentos.length;document.querySelector("#TIPOPAGAMENTO").addEventListener("change",r=>{function n(){document.getElementById("testePop").style.display="none"}"70"==r.target.value||"97"==r.target.value?Visualforce.remoting.Manager.invokeAction(controllerActionAptlmk,e,t,a,o,(function(e){if(console.log("resultado request: ",e),console.log("ofertaSelecionada:"+a),e){const t=JSON.parse(e).link,a=t.split("&token=")[1];window.localStorage.setItem("tokenAPI",a),document.querySelectorAll(".blocoPagamentoCartao").forEach(e=>{e.style.display="none",e.childNodes.forEach(e=>{console.log("antes do if"),e.innerHTML=""})});let o=document.getElementById("testePop"),r=document.getElementById("testeModal");return o.style.display="block",o.style.textAlign="center",r.innerHTML=`<iframe src=${t} height=1200px width=700px frameborder=0 scrolling=no style="overflow-x:hidden;overflow-y:hidden;"></iframe>`,void window.addEventListener("message",e=>{console.log("event:",e);let t=JSON.parse(e.data.message);window.localStorage.setItem("idCartao",t.idCartao);setTimeout(n,5e3);console.log(t.idCartao)})}}),{escape:!1}):document.getElementById("testePop").style.display="none"})}}function formatacaoFormularioAPTLMK1(){let e=window.localStorage.getItem("jsonEntradaCalculo");null!=e&&(e=JSON.parse(e).consultivo.codigoOfertaConsultiva,"APTLMK"==e&&(document.querySelector("#blocoAssinaturaEletronica").classList.add("hidden"),document.querySelector("#blocoAssinaturaEletronica").value="NAO"))}function formatacaoFormularioPortoVidaON1(){let e=window.localStorage.getItem("jsonEntradaCalculo");if(null!=e){if(e=JSON.parse(e).consultivo.codigoOfertaConsultiva,"VIAGEM_VIDA_ON"==e){let e=JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")),t=e.consultivo.respostas.length;for(console.log("arrayLength",t),i=0;i<t;i++)if("DICIO_CPFVOUCHER"==e.consultivo.respostas[i].id){e=e.consultivo.respostas[i].conteudo;break}document.querySelector(".cpfMask").value=e,document.querySelector(".cpfMask").classList.add("disabled");let a=document.querySelector("#DICIO_CORRETAGEM");a.classList.add("hidden"),a.labels[0].innerHTML="",document.querySelector("#DICIO_CORRETAGEM").value="5",document.querySelector(".formapagamento").classList.add("hidden"),document.querySelector("#TIPOPAGAMENTO").required=!1,document.querySelector(".listacorretores").classList.add("hidden"),document.querySelector("#DICIO_MOTOCICLETA").value="NAO",document.querySelector("#DICIO_AVENTURA").value="NAO"}"VIDA_ON"==e&&(document.querySelector("#EMPRESATRABALHO").parentElement.classList.add("hidden"),document.querySelector("#EMPRESATRABALHO").required=!1)}}function disableCampoRendaMensal2(){let e=window.localStorage.getItem("jsonEntradaCalculo");if(null!=e&&(e=JSON.parse(e).consultivo.codigoOfertaConsultiva,"VIDA_ON"!=e)){const e=document.getElementById("RENDAMENSAL");if(e){const t=e.nextElementSibling;t&&t.classList.contains("select-wrapper")&&(t.style.display="none")}}}function formatacaoFormularioPortoVidaON2(){let e=window.localStorage.getItem("jsonEntradaCalculo");if(null!=e&&(e=JSON.parse(e).consultivo.codigoOfertaConsultiva,"VIAGEM_VIDA_ON"==e&&(document.querySelector("#DICIO_MOTOCICLETA").parentElement.classList.add("hidden"),document.querySelector("#DICIO_AVENTURA").parentElement.classList.add("hidden")),"VIDA_ON"==e)){let e=document.querySelector("#DICIO_CORRETAGEM");e.classList.add("hidden"),e.labels[0].innerHTML="",document.querySelector("#DICIO_CORRETAGEM").value="5";let t=document.querySelector("#RENDAMENSAL");t.removeAttribute("required"),t.style.display="none";let a=document.querySelector("#RENDAMENSAL2");a.setAttribute("required","true"),a.classList.remove("hidden");(()=>{Visualforce.remoting.Manager.invokeAction(controllerActionConsultaRendaVidaON,e=>{const t=JSON.parse(e.replace(/&quot;/g,'"'));preencheRendaMensal(a,t)})})(),document.getElementById("BLOCOENDCOMERCIAL").style.display="none",document.getElementById("BLOCOBENEFICIARIOS").style.display="none",document.querySelector("#BENEFICIARIOS").value="Herdeiros legais, conforme artigo 792 do código civil.",document.querySelector(".listacorretores").classList.add("hidden"),document.querySelector(".blocoRemuneracao").classList.add("hidden"),document.querySelector("#blocoAssinaturaEletronica").value="NAO",document.querySelector("#blocoAssinaturaEletronica").classList.add("hidden"),document.querySelector("#DICIO_REGIME_TRABALHO").value="CLT",document.querySelector("#DICIO_REGIME_TRABALHO").classList.add("hidden"),document.querySelector("#DICIO_REGIME_TRABALHO").parentElement.classList.add("hidden"),document.querySelector("#BLOCOFUMANTE").classList.add("hidden")}}function executeAfterDelay(){const e=e=>{switch(e){case"Casado (a)":return"CASADO";case"Divorciado(a)":return"DIVORCIADO";case"Solteiro (a)":return"SOLTEIRO";case"União estável":return"VIVEMARITALMENTE";case"Viúvo(a)":return"VIUVO";case"Separado(a)":return"DIVORCIADO";case"Desquitado(a)":return"DESQUITADO";case"Vive maritalmente":return"VIVEMARITALMENTE";case"Não informado":default:return"0"}},t=(t,a)=>{if(null===a)return;console.log(t,a);const o=document.getElementById(t);if(o){if(console.log("Elemento existe"),o.value=a,o.dispatchEvent(new KeyboardEvent("keyup",{key:""})),"CEPCLIENTE"!==t&&"CEPCOMERCIAL"!==t||selectedEndereco(t),["TIPOENDERECORESPFIN","grauParentescoBeneficiario","TIPOEMPRESA","RESIDE_BRASIL"].includes(t))return;if("SELECT"===o.tagName){switch(console.log(t),t){case"ESTADOCIVIL":a=e(a)}a=(r=a,r=(r=(r=(r=(r=(r=(r=r.toLowerCase()).replace(new RegExp("[ÁÀÂÃ]","gi"),"a")).replace(new RegExp("[ÉÈÊ]","gi"),"e")).replace(new RegExp("[ÍÌÎ]","gi"),"i")).replace(new RegExp("[ÓÒÔÕ]","gi"),"o")).replace(new RegExp("[ÚÙÛ]","gi"),"u")).replace(new RegExp("[Ç]","gi"),"c")).toUpperCase(),o.M_FormSelect._handleSelectChangeBound(),o.querySelector('option[value="'+a+'"]').setAttribute("selected","selected"),o.querySelector('option[value="'+a+'"]').removeAttribute("disabled")}}var r},a=(()=>{try{const e=JSON.parse(window.localStorage.getItem("dadosProposta"));console.log("dados proposta"),console.dir(e);const t=window.localStorage.getItem("dadosUsuario"),a=t?JSON.parse(t).filter(e=>"DICIO_RENDA"!==e.id):[];return console.log("dados usuario"),console.dir(a),a.forEach(({id:t,conteudo:a})=>{Object.assign(e,{[t]:a})}),Object.entries(e).map(([e,t])=>({id:e,value:t}))}catch{return[]}})();function o(e){const t=e.split("-");return`${t[2]}/${t[1]}/${t[0]}`}console.log("dados"),console.dir(a);const r=e=>{const t="true"===e;(e=>{const t=document.getElementsByClassName("respfin")[0];e?t.classList.add("hidden"):t.classList.remove("hidden")})(t);const[a,o]=document.getElementsByName("RESPFINANCEIRO");t?(a.checked=!0,o.checked=!1):(a.checked=!1,o.checked=!0)};a.forEach(({id:n,value:l})=>{if(console.log("dados foreach",{id:n,value:l}),l)switch(n){case"DICIO_RESIDEBRASIL":console.log("--------reside brasil"),t("RESIDE_BRASIL",l.toUpperCase());break;case"DICIO_RENDA":t("RENDAMENSAL",l.replace(".",","));break;case"DICIO_PAIS":t("PAISRESIDENTE",l);break;case"DICIO_ORGAOEXPEDIDOR":t("ORGAOEMISSOR",l);break;case"DICIO_ESTADOCIVIL":t("ESTADOCIVIL",l);break;case"DICIO_EMPRESA":t("EMPRESATRABALHO",l);break;case"DICIO_DOCIDENTIFICACAO":t("NUMERODOCUMENTO",l);break;case"DICIO_DATAEXPEDICAO":t("DATAEXPEDICAO",o(l));break;case"DICIO_CPF":console.log("DICIO_CPF",l.replaceAll(".","").replaceAll("/","").replaceAll("-","")),t("CPF",l.replaceAll(".","").replaceAll("/","").replaceAll("-",""));break;case"DICIO_ENDERECORES_CEP":t("CEPCLIENTE",l);break;case"DICIO_ENDERECORES_BAIRRO":t("BAIRROCLIENTE",l);break;case"DICIO_ENDERECORES_NUMERO":t("NUMEROCLIENTE",l);break;case"DICIO_ENDERECOCOM_NUMERO":t("NUMEROCOMERCIAL",l);break;case"DICIO_ENDERECORES_LOGRADOURO":t("LOGRADOUROCLIENTE",l);break;case"DICIO_ENDERECOCOM_LOGRADOURO":t("LOGRADOUROCOMERCIAL",l);break;case"DICIO_ENDERECOCOM_COMPLEMENTO":t("COMPLEMENTO",l);break;case"DICIO_ENDERECORES_CIDADE":t("CIDADECLIENTE",l);break;case"DICIO_ENDERECOCOM_CIDADE":t("CIDADECOMERCIAL",l);break;case"DICIO_ENDERECOCOM_CEP":t("CEPCOMERCIAL",l);break;case"DICIO_ENDERECOCOM_BAIRRO":t("BAIRROCOMERCIAL",l);break;case"DICIO_EMAIL":t("EMAIL",l),t("EMAILCONFIRMATION",l);break;case"DICIO_CELULAR":t("CELULARCLIENTE",l);break;case"DICIO_ENDERECORES_ESTADO":t("ESTADOCLIENTE",l);break;case"DICIO_ENDERECOCOM_ESTADO":t("ESTADOCOMERCIAL",l);break;case"DICIO_TELEFONERES":t("TELEFONECLIENTE",l);break;case"DICIO_RESPONSAVEL":r(l);break;case"DICIO_RESPONSAVELNAME":t("NOMERESP",l);break;case"DICIO_RESPONSAVELCPF":t("CPFRESP",l);break;case"DICIO_RESPONSAVELVINCULO":t("VINCULORESP",l);break;case"DICIO_RESPONSAVELSEXO":t("SEXORESP",l);break;case"DICIO_RESPONSAVELDATA":t("DTNASCRESP",o(l));break;case"DICIO_RESPONSAVELCIVIL":t("ESTADOCIVILRESP",e(l));break;case"DICIO_RESPONSAVELEMAIL":t("EMAILRESPFIN",l),t("EMAILCONFIRMATIONRESPFIN",l);break;case"DICIO_RESPONSAVELCEP":t("CEPRESPFIN",l);break;case"DICIO_RESPONSAVELTIPO":t("TIPOENDERECORESPFIN",l);break;case"DICIO_RESPONSAVELRUA":t("LOGRADOURORESPFIN",l);break;case"DICIO_RESPONSAVELESTADO":t("ESTADORESPFIN",l);break;case"DICIO_RESPONSAVELCIDADE":t("CIDADERESPFIN",l);break;case"DICIO_RESPONSAVELTELEFONE1":t("CELULARRESPFIN",l);break;case"DICIO_RESPONSAVELTELEFONE2":t("TELEFONERESPFIN",l);break;case"DICIO_RESPONSAVELTELEFONE3":t("TELOPCIONALRESPFIN",l);break;case"DICIO_RESPONSAVELBAIRRO":t("BAIRRORESPFIN",l);break;case"DICIO_RESPONSAVELNUMERO":t("NUMERORESPFIN",l);break;case"DICIO_LSTBENEF":(e=>{const a=document.querySelector("a.addBeneficiario"),r=document.getElementById("BENEFICIARIOS");e.forEach(e=>{if("Herdeiros legais, conforme artigo 792 do código civil."===e.DICIO_BENEFTIPO)return void(r.value="Herdeiros legais, conforme artigo 792 do código civil.");const n=document.getElementsByClassName("listaBeneficiarios cliente")[0];r.value="Nome do beneficiário",n.classList.add("on"),t("nomeBeneficiario",e.DICIO_BENEFNOME),14==e.DICIO_BENEFCPF.length?t("cpfBeneficiario",e.DICIO_BENEFCPF):(document.getElementById("tipoDePessoaCNPJ").click(),t("cnpjBeneficiario",e.DICIO_BENEFCPF)),t("nascimentoBeneficiario",e.DICIO_BENEFDATA?o(e.DICIO_BENEFDATA):null),t("sexoBeneficiario",e.DICIO_BENEFSEXO),t("grauParentescoBeneficiario",e.DICIO_BENEFPAREN),t("percentualBeneficio",e.DICIO_BENEFPERCEN);const l=document.getElementById("imprimirApoliceSim"),i=document.getElementById("imprimirApoliceNao");"true"===e.DICIO_BENEFIMPRIMI?l.click():i.click(),a.click()})})(l);break;case"DICIO_RAMOATIVIDADE":t("RAMOEMPRESA",l);break;case"DICIO_TIPOEMPRESA":t("TIPOEMPRESA",l);break;case"DICIO_CNPJMEI":((e,a)=>{switch(e.toLowerCase()){case"cnpj":t("CNPJEMPRESA",a);break;case"mei":t("MEIEMPRESA",a)}const o=document.getElementById("TIPOEMPRESA");o.value=e.toLowerCase(),o.dispatchEvent(new Event("change"))})(a.find(e=>"DICIO_TIPOEMPRESA"===e.id).value,l);break;case"DICIO_QTDFUNCIONARIOS":t("QTDFUNCIONARIOS",l);break;case"DICIO_NOME_AGENCIADOR":t("NOME_AGENCIADOR",l);break;case"DICIO_CPF_AGENCIADOR":case"DICIO_CNPJ_AGENCIADOR":t("CPF_AGENCIADOR",l);const n=document.getElementById("btn_busca_agenciador");n&&n.click();break;case"DICIO_CODIGOAGENCIADOR":t("CODIGO_AGENCIADOR",l);break;case"DICIO_SUSEPAGENCIADOR":t("SUSEP_AGENCIADOR",l);break;case"DICIO_TIPOREMUNERACAO":(e=>{const a="AGENCIAMENTO_PARA";t(a,"Agenciador"===e?"AGENCIADOR":"CORRETOR");const o=document.getElementById(a);o&&o.dispatchEvent(new Event("change"))})(l)}}),a.length&&M.updateTextFields()}function verifyCPF(){var e=[],t=[];console.log("viagem",viagem);var a=document.getElementById("NOMERESP").value;console.log("responsibleName",a);var o=document.getElementById("CPFRESP").value;console.log("responsibleCpf",o);var r=document.getElementById("DICIO_NOME").value,n=document.getElementById("CPF").value;e.push(r),t.push(n);for(var l=calculateTotalInsured(),i=1;i<l;i++){var c=document.getElementById("NOMESEGURADO"+i).value,s=document.getElementById("CPFSEGURADO"+i).value;e.push(c),t.push(s)}console.log("listNames",e),console.log("listCpfs",t);var d=t.indexOf(o);return-1!==d&&e[d].toLowerCase()!==a.toLowerCase()?(console.log("true"),!0):(console.log("false"),!1)}function calculateTotalInsured(){var e=localStorage.getItem("jsonEntradaCalculo");if(e){for(var t=JSON.parse(e).consultivo.respostas,a=0,o=0;o<t.length;o++){var r=t[o];"DICIO_QTD_JOVENS"!==r.id&&"DICIO_QTD_IDOSOS"!==r.id||(a+=parseInt(r.conteudo,10))}return a}return null}function copiarCPF(){let e=document.getElementById("TIPOPAGAMENTO"),t=document.getElementById("CPF"),a=document.getElementById("ADCCPFCNPJ"),o=document.getElementById("CPFRESP"),r=document.querySelector('label[for="ADCCPFCNPJ"]'),n=document.querySelector('input[name="RESPFINANCEIRO"]:checked');function l(e){a.value=e,r.classList.add("active")}function i(){52==e.value&&("Sim"==n.value&&null!=t.value&&""!=t.value?l(t.value):"Nao"==n.value&&(a.value="",o.addEventListener("input",e=>{l(e.target.value)})))}e.addEventListener("change",()=>{i()}),document.querySelectorAll('input[name="RESPFINANCEIRO"]').forEach(e=>{e.addEventListener("change",()=>{n=document.querySelector('input[name="RESPFINANCEIRO"]:checked'),i()})})}function exibirBotaoMesmoContatoEmergencia(){const e=document.querySelectorAll("#formProposta .listaSegurados .segurado"),t=document.getElementById("NOMECLIENTEALTERNATIVOSEGURADO0"),a=document.getElementById("TELCLIENTEALTERNATIVOSEGURADO0"),o=window.localStorage.getItem("segmento");null!=e&&e.length>0&&"Viagem"==o&&(document.getElementById("preencheContatoDiv").classList.remove("hidden"),t.addEventListener("change",e=>{preencherContatosAlternativos()}),t.addEventListener("input",e=>{preencherContatosAlternativos()}),a.addEventListener("change",e=>{preencherContatosAlternativos()}),a.addEventListener("input",e=>{preencherContatosAlternativos()}))}function preencherContatosAlternativos(){const e=document.querySelectorAll("#formProposta .listaSegurados .segurado");if(desejaInformarMesmoContato()){const t=document.getElementById("NOMECLIENTEALTERNATIVOSEGURADO0").value,a=document.getElementById("TELCLIENTEALTERNATIVOSEGURADO0").value;e.forEach((e,o)=>{preencherInputAlternativo(e,o+1,t,a)})}else e.forEach((e,t)=>{habilitarInputAlternativo(e,t+1)})}function preencherInputAlternativo(e,t,a,o){const r=document.getElementById("NOMECLIENTEALTERNATIVOSEGURADO"+t),n=document.getElementById("TELCLIENTEALTERNATIVOSEGURADO"+t);r.value=a,n.value=o,r.disabled=!0,n.disabled=!0;const l=document.querySelector(`label[for="${r.id}"]`),i=document.querySelector(`label[for="${n.id}"]`);l&&l.classList.add("active"),i&&i.classList.add("active")}function habilitarInputAlternativo(e,t){const a=document.getElementById("NOMECLIENTEALTERNATIVOSEGURADO"+t),o=document.getElementById("TELCLIENTEALTERNATIVOSEGURADO"+t);a.disabled=!1,o.disabled=!1}function desejaInformarMesmoContato(){const e=document.getElementsByName("preencheCttInput");for(const t of e)if(t.checked)return"true"===t.value;return!1}window.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("ENDERECOCOMERCIAL"),t=document.getElementById("ENDERECOCLIENTE"),a=document.getElementById("ENDERECORESPFIN");let o=window.localStorage.getItem("entradaConsultivo");o=JSON.parse(o).consultivo.segmento,"eds"==o&&(e.removeAttribute("required"),t.removeAttribute("required"));const r=e=>{const{id:t}=e,a=document.querySelector(`label[for="${t}"]`),{classList:o}=a;e.value.length?o.add("active"):o.remove("active")},n=(o,n,l)=>{const i=document.getElementById("LOGRADOURO"+n),c=document.getElementById("BAIRRO"+n),s=document.getElementById("CIDADE"+n),d=document.getElementById("ESTADO"+n),u=l?document.getElementById("CEP"):document.getElementById("CEP"+n);if("NA"===o.value&&u&&u.classList.contains("valid"))return void[c,s,i,d].forEach(enableInput);[c,s,i,d].forEach(disableInput);const m=[...(()=>{switch(n){case"COMERCIAL":return e;case"CLIENTE":return t;case"RESPFIN":return a;default:throw new Error("Endereço não encontrado")}})().options].find(e=>e.value===o.value);if(!m)return;const E=m.getAttribute("data-logradouro"),p=m.getAttribute("data-bairro"),g=m.getAttribute("data-cidade"),v=m.getAttribute("data-uf");null!=E&&""!=E&&null!=E&&"null"!=E?i.value=E:enableInput(i),null!=p&&""!=p&&null!=p&&"null"!=p?c.value=p:enableInput(c),null!=g&&""!=g&&null!=g&&"null"!=g?s.value=g:enableInput(s),null!=v&&""!=v&&null!=v&&"null"!=v?(d.value=v,d.M_FormSelect._handleSelectChangeBound()):enableInput(d),[c,s,i,d].forEach(r)},l=document.getElementById("CEPCOMERCIAL"),i=document.getElementById("CEPCLIENTE"),c=document.getElementById("CEPRESPFIN"),s=document.getElementById("CEP"),d=(e,t,a=!1)=>{e&&e.addEventListener("blur",e=>{const o=e.target.name,[r,n]=(e=>e.split("-"))(e.target.value),l={obterEnderecoPorCEP:{cep:r,cepSufixo:n}};Visualforce.remoting.Manager.invokeAction(controllerActionConsultaCEP,l,o,e=>{const o=JSON.parse(e.replace(/&quot;/g,'"'));preencheEnderecoCEP(t,o,a)})})};d(l,"COMERCIAL"),d(i,"CLIENTE"),d(s,"CLIENTE",!0),d(c,"RESPFIN"),e&&e.addEventListener("change",()=>{n(e,"COMERCIAL")}),t.addEventListener("change",()=>{s?n(t,"CLIENTE",!0):n(t,"CLIENTE")}),a.addEventListener("change",()=>{n(a,"RESPFIN")})}),document.addEventListener("DOMContentLoaded",()=>{"Viagem"==window.localStorage.getItem("segmento")?setTimeout(executeAfterDelay,1e4):executeAfterDelay()}),document.addEventListener("DOMContentLoaded",()=>{let e=[],t=!1;JSON.parse(window.localStorage.getItem("entradaConsultivo"));const a=localStorage.getItem("ofertaSelecionada");if("Viagem"==window.localStorage.getItem("segmento")){let e=document.getElementById("DICIO_AVENTURA");e.parentNode.parentNode.classList.add("hidden"),e.removeAttribute("required")}let o=window.localStorage.getItem("segmento");const r=JSON.parse(localStorage.getItem("jsonResponseCalculo"));let n=r.ofertas.find(e=>e.orcamento.numeroOrcamento==a).segmento;if(o=null===o?n:o,"Individual"!==o)return;if(!a||!r)return;const l=r.ofertas.some(e=>e.orcamento.numeroOrcamento===a&&e.retornoAceitacao.decisoes.some(e=>"auto"===e.acao));let i=ofertaSelecionada.regras.questionarios;if(l){const a=document.getElementById("switchQuestionarioCorretor"),o=document.getElementsByClassName("blockCelularCorretor"),r=document.querySelector(".declaracao-saude"),n=document.querySelectorAll(".info-cel"),l=document.getElementsByClassName("obsQuestionario"),m=document.getElementById("CELULARCLIENTE"),E=document.getElementById("CELULARCORRETOR"),p=document.getElementsByClassName("naoEsquecaCorretor");var c=r.querySelectorAll(".opcao-preenc"),s=r.querySelector(".campos");function d(){e=[];document.querySelectorAll(".campos .input-field input").forEach(t=>{(t.classList.contains("invalid")||!0===t.required)&&(t.classList.remove("invalid"),t.removeAttribute("required"),e.push(t.id))});document.querySelectorAll(".selecionePergunta .select-wrapper").forEach(t=>{const a=t.querySelector("select");if(t.classList.contains("invalid")||!0===a.required){const o=t.querySelector("select").id;t.classList.remove("invalid"),a.removeAttribute("required"),e.push(o)}})}document.querySelectorAll(".relCorretor").forEach((function(e){console.log("DANILO -> EL: ",e),e.classList.remove("hidden")})),l[0].classList.add("hidden");const g=()=>{o[0].classList.add("disabled"),l[0].classList.add("hidden"),p[0].classList.add("hidden"),E.nextElementSibling.classList.remove("hidden"),E.value="",n.forEach(e=>{e.classList.add("hidden")})},v=()=>{s.classList.add("hidden"),o[0].classList.remove("disabled"),E.nextElementSibling.classList.add("hidden"),E.value=m.value,n.forEach(e=>{e.classList.remove("hidden")})};g(),a.addEventListener("change",e=>{if(e.currentTarget.checked){r.classList.remove("hidden");let e=document.getElementsByName("FORMAPREENCHIMENTO");Array.from(e).forEach(e=>{"link"==e.value&&(e.checked=!0)}),v(),i&&i.length>0&&!t&&(!function(e){let t=document.querySelector(".declaracao-saude");e.forEach((e,a)=>{let o;if("Opção"===e.tipoResposta){o=document.createElement("select"),o.addEventListener("change",e=>{!function(e){switch(console.log("selectChangeQuests",e.srcElement.value),e.srcElement.id){case"pergunta_3":let t=document.getElementById("pergunta_4");console.log("validando fumante",t),"SIM"==e.srcElement.value.toUpperCase()?(console.log("sim"),t.setAttribute("required",!0),t.removeAttribute("disabled")):(console.log("nao"),t.removeAttribute("required"),t.setAttribute("disabled",!0),t.options[0].selected=!0),M.FormSelect.init(t);break;case"pergunta_4":console.log("validando tempo de fumante");break;default:console.log(`valor do elemento ${e.srcElement.id} foi alterado`)}}(e)}),e.obrigatorio&&o.setAttribute("required",e.obrigatorio),o.id="pergunta_"+e.idPergunta,o.innerHTML='<option value="" selected="true" disabled="true">Selecione</option>',o.classList.add("col"),o.classList.add("s12"),o.classList.add("l12"),e.opcoesRespostas.split(";").forEach(e=>{let t=document.createElement("option");t.innerHTML=e,o.appendChild(t)});let a=document.createElement("div");a.classList.add("input-field"),a.classList.add("col"),a.classList.add("s12"),a.classList.add("l12"),a.classList.add("selecionePergunta");let r=document.createElement("label");r.setAttribute("for","pergunta_"+e.idPergunta),r.innerText=e.pergunta,a.appendChild(o),a.appendChild(r),t.querySelector(".campos").appendChild(a),inicializaSelects()}else{o=document.createElement("input"),"Número"==e.tipoResposta?(o.type="text",o.classList.add("numberMask"),1==e.idPergunta&&(o.min=0,o.max=999,o.maxlength=3,o.addEventListener("input",u),VMasker(o).maskPattern("999")),2==e.idPergunta&&(o.step=.01,o.min=0,o.max=3,o.maxlength=1,o.addEventListener("input",u),VMasker(o).maskPattern("9.99"))):"Data"==e.tipoResposta?(o.type="date",o.classList.add("dataMask")):(o.type="text",o.classList.add("textMask")),o.id="pergunta_"+e.idPergunta;let a=document.createElement("div");e.obrigatorio&&o.setAttribute("required",e.obrigatorio),a.classList.add("input-field"),a.classList.add("col"),a.classList.add("s12"),a.classList.add("l12");let r=document.createElement("label");r.setAttribute("for","pergunta_"+e.idPergunta),r.innerText=e.pergunta;let n=document.createElement("span");n.classList.add("helper-text"),a.appendChild(o),a.appendChild(r),a.appendChild(n),t.querySelector(".campos").appendChild(a)}})}(i),t=!0),d()}else d(),r.classList.add("hidden"),g()}),m.addEventListener("blur",e=>{a.checked&&(E.value=e.target.value)}),a.dispatchEvent(new Event("change")),c.forEach((function(t){t.addEventListener("change",(function(){"link"===t.value?(d(),v()):"tela"===t.value&&(s.classList.remove("hidden"),function(){if(e.length<=0)return;e.forEach(e=>{const t=document.getElementById(e);t&&t.closest(".campos .input-field")&&t.setAttribute("required",!0)}),document.querySelectorAll(".selecionePergunta .select-wrapper").forEach(t=>{const a=t.querySelector("select").id,o=t.querySelector("select");e.includes(a)&&o.setAttribute("required",!0)})}(),g())}))}))}function u(){let e=document.getElementById("pergunta_1"),t=document.getElementById("pergunta_2"),a=e.value,o=t.value;if(a&&o&&(a=parseFloat(a),o=parseFloat(o),!isNaN(a)&&!isNaN(o)&&o>0)){let e=a/(o*o);document.getElementById("IMC").value=e.toFixed(2)}}}),document.addEventListener("DOMContentLoaded",()=>{if("VIDA_INDIVIDUAL"===JSON.parse(window.localStorage.getItem("entradaConsultivo")).consultivo.codigoOfertaConsultiva)if(document.querySelectorAll(".termoguarda:not(.hidden)").length>0){const t=document.querySelectorAll(".termoguarda input");t.length&&t.forEach((function(t){t.addEventListener("change",t=>{"Sim"===t.currentTarget.value?e(!1):e(!0)}),t.dispatchEvent(new Event("change"))}))}else e(!0);function e(e){const t=document.getElementById("blocoAssinaturaEletronica"),a=document.querySelectorAll("#blocoAssinaturaEletronica input"),o=document.querySelectorAll("#blocoAssinaturaEletronica span");t&&a&&o&&(!1===e?(t.classList.add("hidden"),a[1].click()):(t.classList.remove("hidden"),a[0].click(),o[0].innerHTML="Assinatura Eletrônica",o[1].innerHTML="Assinatura Manual"))}}),document.addEventListener("DOMContentLoaded",()=>{const e=JSON.parse(window.localStorage.getItem("entradaConsultivo")),t=JSON.parse(window.localStorage.getItem("dadosProposta"));if("VIDA_INDIVIDUAL"!==e.consultivo.codigoOfertaConsultiva||!t)return;const a=document.getElementById("DICIO_NOME"),o=document.getElementById("CPF"),r=document.getElementById("DICIO_DATANASCIMENTO"),n=document.querySelectorAll('input[name="switchReaproveitarAssinatura"]'),l=document.getElementsByClassName("reaproveitarAssinatura"),i=(document.querySelectorAll("#formProposta .rodape-resumo-fixo .btnPortoSuccess")[0],document.querySelector("#formProposta .total .investimento")),c=document.querySelector("#formProposta .reaproveitarAssinatura .propostaAnterior");n.forEach((function(e){e.addEventListener("change",e=>{e.currentTarget.checked&&("true"===e.currentTarget.value?c.classList.remove("hidden"):c.classList.add("hidden"))})}));const s=()=>{"true"===t.DICIO_REAPROVEITAR_ASSINATURA&&parseFloat(t.DICIO_TOTAL).toString().replace(/\D/g,"")===i.innerHTML.replace(/\D/g,"")&&a.value===t.DICIO_NOME&&o.value===t.DICIO_CPF&&r.value===formatDate(t.DICIO_DATANASCIMENTO)?(n[0].checked=!0,l[0].classList.remove("hidden"),c.classList.remove("hidden"),c.innerHTML="Estou de acordo com as condições e reaproveitando a assinatura da proposta "+t.DICIO_ORIGEM+" (anterior)"):(n[1].checked=!0,l[0].classList.add("hidden"))};i.addEventListener("DOMSubtreeModified",s),o.addEventListener("change",s),a.addEventListener("change",s),i.dispatchEvent(new Event("DOMSubtreeModified"))}),window.addEventListener("DOMContentLoaded",()=>{disableCampoRendaMensal2();const e=document.getElementById("switchReaproveitarEndereco"),t=document.getElementById("CEPCLIENTE"),a=(document.getElementById("CEP"),document.getElementById("LOGRADOUROCLIENTE")),o=document.getElementById("SEMNUMERO"),r=document.getElementById("NUMEROCLIENTE"),n=document.getElementById("COMPLEMENTO"),l=document.getElementById("BAIRROCLIENTE"),i=document.getElementById("CIDADECLIENTE"),c=document.getElementById("ESTADOCLIENTE"),s=document.getElementById("ENDERECOCLIENTE"),d=document.getElementById("CEPCOMERCIAL"),u=document.getElementById("LOGRADOUROCOMERCIAL"),m=document.getElementById("SEMNUMEROCOMERCIAL"),E=document.getElementById("NUMEROCOMERCIAL"),p=document.getElementById("COMPLEMENTOCOMERCIAL"),g=document.getElementById("BAIRROCOMERCIAL"),v=document.getElementById("CIDADECOMERCIAL"),I=document.getElementById("ESTADOCOMERCIAL"),S=document.getElementById("ENDERECOCOMERCIAL"),C=[d,u,E,p,g,v],f=[t,a,r,n,l,i],A=document.querySelectorAll(".cepMask"),L=document.querySelectorAll(".alfaMask"),h=[o,c,s],y=e=>{const{id:t}=e,a=document.querySelector(`label[for="${t}"]`),{classList:o}=a;e.value.length?o.add("active"):o.remove("active")},O=f=>{if(e.checked){(e=>{if(e){const t=(f=e).includes("CLIENTE")?f.replace("CLIENTE","COMERCIAL"):f+"COMERCIAL";document.getElementById(t).value=document.getElementById(e).value}else d.value=t.value,u.value=a.value,m.value=o.value,E.value=r.value,p.value=n.value,g.value=l.value,v.value=i.value,I.value=c.value,S.innerHTML=s.innerHTML,S.value=s.value;var f;m.M_FormSelect._handleSelectChangeBound(),I.M_FormSelect._handleSelectChangeBound(),S.M_FormSelect._handleSelectChangeBound(),A.forEach(e=>{VMasker(e).maskPattern("99999-999")}),L.forEach(e=>{e.value=e.value.replace(/[^0-9]/g,"")}),C.forEach(y)})(f?f.target.id:null)}};e&&e.addEventListener("click",e=>{e.target.checked&&O()}),f.forEach(e=>e.addEventListener("input",O)),h.forEach(e=>e.addEventListener("change",O));const N=document.getElementById("formBeneficiario");console.log("formBeneficiario",N);let b=document.getElementsByName("tipoDePessoa");Array.from(b).forEach(e=>{console.log("tipdepessoa",b),e.addEventListener("change",e=>{const t=document.getElementById("cpfBeneficiarioBlock"),a=document.getElementById("cnpjBeneficiarioBlock"),o=document.getElementById("cpfBeneficiario"),r=document.getElementById("cnpjBeneficiario"),n=document.getElementById("nascimentoBeneficiario"),l=document.getElementById("sexoBeneficiario"),i=document.querySelector('select[name="grauParentescoBeneficiario"]');r.addEventListener("change",e=>{validaCNPJ(e.target.value)||""==e.target.value?(e.target.classList.remove("invalid"),resetHelper(e.target)):(e.target.classList.add("invalid"),buildHelper(e.target,"CNPJ inválido"))}),console.log("tipdepessoa",t,a,o,r),"tipoDePessoaCPF"==e.target.id?(i.parentElement.classList.remove("disabled"),n.parentElement.setAttribute("style","display: block;"),l.parentElement.parentElement.setAttribute("style","display: block;"),t.setAttribute("style","display: block;"),a.setAttribute("style","display: none;"),o.setAttribute("required",!0),r.removeAttribute("required")):(i.value="Outros",M.FormSelect.init(i,{}),i.parentElement.classList.add("disabled"),n.parentElement.setAttribute("style","display: none;"),n.value="",l.parentElement.parentElement.setAttribute("style","display: none;"),l.value="",M.FormSelect.init(l,{}),t.setAttribute("style","display: none;"),a.setAttribute("style","display: block;"),o.removeAttribute("required"),n.removeAttribute("required"),l.removeAttribute("required"),r.setAttribute("required",!0))})});let T=document.querySelectorAll('input[name="tipoPessoa"]');console.log("tpPessoa",T),T.forEach(e=>{e.addEventListener("click",e=>{const t=document.getElementById("tipoPFBlock"),a=document.getElementById("tipoPJBlock");console.log("evt click tpPessoa",e),t.setAttribute("style","display: block;"),a.setAttribute("style","display: none;"),document.getElementById("dadosPFRow").setAttribute("style","display: block"),document.getElementById("CPFRESP").setAttribute("required",!0),document.getElementById("CNPJRESP").removeAttribute("required"),document.getElementById("SEXORESP").setAttribute("required",!0),document.getElementById("DTNASCRESP").setAttribute("required",!0),document.getElementById("ESTADOCIVILRESP").setAttribute("required",!0),console.log("pos",document.getElementById("CNPJRESP"))})})});
"use strict";function geraJsonComRespostas(){let e=JSON.parse(window.localStorage.getItem("entradaConsultivo")).consultivo,o={orcamento:null,consultivo:{codigoOfertaConsultiva:e.codigoOfertaConsultiva,canalDistribuicao:e.canalDistribuicao,identificadorRepresentante:e.identificadorRepresentante,meioComercializacao:e.entradaNegocio,DICIO_RETENCAO:e.DICIO_RETENCAO,respostas:[]}},a=JSON.parse(window.localStorage.getItem("conjuntosJson"));return o.consultivo.respostas.push({id:"TIPOCONTRATO",conteudo:"VOCE"}),o.consultivo.respostas.push({id:"DICIO_TEMPO_PROTECAO",conteudo:"48"}),"VIDA_ON"==e.codigoOfertaConsultiva&&(o.consultivo.respostas.push({id:"DICIO_NOME",conteudo:""}),o.consultivo.respostas.push({id:"DICIO_FUMANTE",conteudo:"NAO"}),o.consultivo.respostas.push({id:"DICIO_REGIME_TRABALHO",conteudo:"CLT"}),o.consultivo.respostas.push({id:"DICIO_RENDA",conteudo:""}),o.consultivo.respostas.push({id:"DICIO_DEPENDENTES",conteudo:!1}),o.consultivo.respostas.push({id:"DICIO_CORRETAGEM",conteudo:""}),o.consultivo.respostas.push({id:"DICIO_AGENCIAMENTO",conteudo:""}),o.consultivo.respostas.push({id:"DICIO_CICLOCOVID",conteudo:"0"}),o.consultivo.respostas.push({id:"DICIO_PROFISSAO",conteudo:""})),"APTLMK"==e.codigoOfertaConsultiva&&(o.consultivo.respostas.push({id:"DICIO_RENDA",conteudo:"2500"}),o.consultivo.respostas.push({id:"DICIO_DEPENDENTES",conteudo:!1}),o.consultivo.respostas.push({id:"DICIO_CICLOCOVID",conteudo:"0"}),o.consultivo.respostas.push({id:"DICIO_FUMANTE",conteudo:"NAO"}),o.consultivo.respostas.push({id:"DICIO_REGIME_TRABALHO",conteudo:""})),a.conjuntos.forEach((e,a,t)=>{let r,n,l=document.querySelectorAll(".step");l.forEach((e,o)=>{e.classList.contains("on")&&(r=e,n=o)}),(caminho.includes(a)||n==a)&&e.informacoes.forEach((e,t)=>{let r=null==l[a].querySelector("#"+e.id)?l[a].querySelector("input[name="+e.id+"]:checked"):l[a].querySelector("#"+e.id);r&&(console.log("InfoNode "+t+" :.... ",e.id+" - Value: "+r.value),o.consultivo.respostas.push({id:e.id,conteudo:r.classList.contains("servico")?r.dataset.valor:"checkbox"==r.type?1==r.checked:"radio"==r.type?"true"==r.value:r.classList.contains("data")?r.value.split("/").reverse().join("-"):""!=r.value.length?r.value:null}))})}),console.log("RESPOSTAS:..........",o.consultivo.respostas),o.consultivo.respostas.push({id:"TIPOCONTRATO",conteudo:"VOCE"}),o}function tratamentoOfertas(e){let o=JSON.parse(e).ofertas,a=o.map(e=>e.retornosCalculo[0].precificacao.premio.total).sort((function(e,o){return e-o})),t={ofertas:[]};for(;a.length>0;){let e=o.filter(e=>e.retornosCalculo[0].precificacao.premio.total==a[0]).shift(),r=o.findIndex(o=>o.orcamento.numeroOrcamento==e.orcamento.numeroOrcamento);t.ofertas.push(o.splice(r,1).shift()),a.splice(0,1)}let r={ofertas:[]};return t.ofertas.forEach(e=>{let o={orcamento:{rotulo:e.orcamento.rotulo,numeroOrcamento:e.orcamento.numeroOrcamento,garantiasAtuais:e.orcamento.contratantes[0].grupos[0].segurados?e.orcamento.contratantes[0].grupos[0].segurados[0].coberturas:e.orcamento.contratantes[0].grupos[0].coberturas,versoesCalculos:e.orcamento.versoesCalculos,customizavel:e.orcamento.customizavel||!1,gerarDocumento:e.orcamento.gerarDocumento||!1,segmento:e.orcamento.segmento},retornosCalculo:[],parcelamentos:e.parcelamentos,regras:e.regras,retornoAceitacao:e.retornoAceitacao};e.retornosCalculo.forEach(a=>{let t={descontoMonetario:a.precificacao.descontoAgravo[0].monetario,premio:a.precificacao.premio.total,capital:a.precificacao.coberturas.capital,opcao:a.opcao,coberturas:[]},r=[];a.precificacao.coberturas.length>0?(a.precificacao.coberturas.forEach(o=>{let a=e.regras.coberturas.filter(e=>o.sigla==e.sigla).shift();a&&(r[a.prioridade]=o)}),r.forEach(e=>{let o={sigla:e.sigla,premio:e.premio.total,capital:e.capital,descontoAgravo:e.descontoAgravo};t.coberturas.push(o)})):a.precificacao.grupos&&a.precificacao.grupos[0].coberturas.forEach(e=>{let o={sigla:e.sigla,premio:e.premio.total,capital:e.capital,descontoAgravo:e.descontoAgravo};t.coberturas.push(o)}),o.retornosCalculo.push(t)}),r.ofertas.push(o)}),window.localStorage.setItem("jsonOfertasMin",JSON.stringify(r)),JSON.stringify(r)}function jsonEntradaPersonalizado(e){let o=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas.filter(o=>o.orcamento.numeroOrcamento==e).shift(),a=[];return document.querySelectorAll(".personalizeInput:checked").forEach(e=>{let o=closestByClass(e,"containerCampo"),t=o.querySelector(".valorTotal").value,r=o.querySelector(".valorTotal").id,n=o.querySelector(".valorTotal").dataset?o.querySelector(".valorTotal").dataset.garantiareferenciada:null;n?a.push({sigla:r,valor:t,garantiaReferenciada:n}):a.push({sigla:r,valor:t})}),o.orcamento.contratantes[0].grupos[0].segurados[0].coberturas=a,{consultivo:null,orcamento:{rotulo:o.orcamento.rotulo,segmento:o.orcamento.segmento,meioComercializacao:"SFC",numeroPortal:o.orcamento.numeroPortal,dataCalculo:o.orcamento.dataCalculo,codigoProdutoVida:o.orcamento.codigoProdutoVida,tipoVigencia:o.orcamento.tipoVigencia,vigenciaInicial:o.orcamento.vigenciaInicial,vigenciaFinal:o.orcamento.vigenciaFinal,tipoSeguro:o.orcamento.tipoSeguro,entradaNegocio:o.orcamento.entradaNegocio,contratantes:o.orcamento.contratantes,canalDistribuicao:o.orcamento.canalDistribuicao,remuneracoes:o.orcamento.remuneracoes,susepOrcamento:JSON.parse(window.localStorage.getItem("conjuntosJson")).identificadorRepresentante,ordemPortal:1}}}function getJsonDadosVoucher(){let e,o,a=JSON.parse(window.localStorage.getItem("dadosUsuario")),t=JSON.parse(window.localStorage.getItem("entradaConsultivo")),r={};for(let t=0;t<a.length;t++)"DICIO_CPFVOUCHER"==a[t].id&&(e=a[t].conteudo),"DICIO_VOUCHER"==a[t].id&&(o=a[t].conteudo);return r="VIAGEM_VIDA_ON"==t.consultivo.codigoOfertaConsultiva?{cpf:e,voucher:o,produto:t.consultivo.codigoOfertaConsultiva}:{cpf:"",voucher:"",produto:""},r}function getjsonEntradaTransmissao(){let e=apagarPagmento(),o=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")),a=window.localStorage.getItem("ofertaSelecionada"),t=o.ofertas.filter(e=>e.orcamento.numeroOrcamento==a)[0],r=1,n=document.getElementById("formularioProposta")?document.getElementById("formularioProposta").elements:document.getElementById("formularioPropostaViagem").elements,l=window.localStorage.getItem("dadosUsuario")?JSON.parse(window.localStorage.getItem("dadosUsuario")):null,s={};if(viagem)s={tipo:"FIS",nome:n.DICIO_NOME.value.toUpperCase(),nomeSocial:n.DICIO_NOMESOCIAL.value?n.DICIO_NOMESOCIAL.value.toUpperCase():"",dadosPessoaFisica:{sexo:document.querySelector("#DICIO_SEXO").value.toLowerCase().includes("mas")?"MASCULINO":"FEMININO",numeroCpf:n.CPF.value.split("-")[0].replace(/\./g,""),digitoCpf:n.CPF.value.split("-")[1],dataNascimento:new Date(n.DICIO_DATANASCIMENTO.value.split("/").reverse().join("/")).toISOString().slice(0,10)}};else if(individual){s=t.orcamento.contratantes[0].grupos[0].segurados[0].pessoa,s.tipo="FIS",s.nome=n.DICIO_NOME.value.toUpperCase(),s.nomeSocial=n.DICIO_NOMESOCIAL.value?n.DICIO_NOMESOCIAL.value.toUpperCase():"",s.dadosPessoaFisica.numeroCpf=n.CPF.value.split("-")[0].replace(/\./g,""),s.dadosPessoaFisica.digitoCpf=n.CPF.value.split("-")[1],s.rendaMensal=n.RENDAMENSAL&&n.RENDAMENSAL.value?n.RENDAMENSAL.value.replace(/[(R\$ ) \.]/g,"").replace(",","."):n.RENDAMENSAL2&&n.RENDAMENSAL2.value?n.RENDAMENSAL2.value.replace(/[(R\$ ) \.]/g,"").replace(",","."):null,s.telefones=[],s.enderecos=[],s.melhorPeriodo=n.MELHORPERIODO?n.MELHORPERIODO.value:"I",s.dadosPessoaFisica.estadoCivil=n.ESTADOCIVIL.value,s.dadosPessoaFisica.dataNascimento=new Date(s.dadosPessoaFisica.dataNascimento).toISOString(),s.dadosPessoaFisica.nacionalidade=n.NACIONALIDADE.value,s.dadosPessoaFisica.profissao=""!=n.DICIO_PROFISSAO.value?n.DICIO_PROFISSAO.value:n.PROFISSAOLABEL.value,delete s.dadosPessoaFisica.celular,delete s.dadosPessoaFisica.renda,s.dadosPessoaFisica.tipoDocIdentificacao=""!=document.getElementById("TIPODOCUMENTO").value?document.getElementById("TIPODOCUMENTO").value:null,s.dadosPessoaFisica.docIdentificacao=""!=document.getElementById("NUMERODOCUMENTO").value?document.getElementById("NUMERODOCUMENTO").value:null,s.dadosPessoaFisica.orgaoExpedidor=""!=document.getElementById("ORGAOEMISSOR").value?document.getElementById("ORGAOEMISSOR").value.toUpperCase():null,s.dadosPessoaFisica.dataExpedicao=""!=document.getElementById("DATAEXPEDICAO").value?new Date(document.getElementById("DATAEXPEDICAO").value.split("/").reverse().join("/")).toISOString().slice(0,10):null,s.dadosPessoaFisica.idade=n.DICIO_IDADE&&null!=n.DICIO_IDADE.value?parseInt(n.DICIO_IDADE.value):null,s.dadosPessoaFisica.paisResidente=document.getElementById("PAISRESIDENTE").value,s.dadosPessoaFisica.imc=parseFloat(n.IMC.value),s.dadosPessoaFisica.cicloVacinal=document.getElementById("DICIO_CICLOCOVID").value,s.dadosPessoaFisica.DataUltimaVacina=null,s.dadosPessoaFisica.paisDeOrigem="ESTRANGEIRA"==n.NACIONALIDADE.value.toUpperCase()?n.PAISDEORIGEM.value:"";var c=document.getElementById("PROFISSAOLABEL").value;"EMPRESÁRIO"!=c.toUpperCase()&&"EMPRESARIO"!=c.toUpperCase()||(s.dadosPessoaFisica.tipoEmpresa=document.getElementById("TIPOEMPRESA").value,qtdFuncionarios=document.getElementById("QTDFUNCIONARIOS").value,s.dadosPessoaFisica.qtdFuncionarios=parseInt(qtdFuncionarios),"CNPJ"==s.dadosPessoaFisica.tipoEmpresa.toUpperCase()?s.dadosPessoaFisica.numeroCnpj=document.getElementById("CNPJEMPRESA").value.replace(/[^0-9,]*/g,"").replace(",",""):s.dadosPessoaFisica.numeroCnpj=document.getElementById("MEIEMPRESA").value.replace(/[^0-9,]*/g,"").replace(",","")),t.orcamento.contratantes[0].grupos[0].segurados[0].empresaQueTrabalha=document.getElementById("EMPRESATRABALHO").value.toUpperCase(),t.orcamento.contratantes[0].grupos[0].segurados[0].ramoAtividade=document.getElementById("RAMOEMPRESA").value;let e=!1;null!=l&&(t.orcamento.contratantes[0].grupos[0].segurados[0].ocupacaoProfissionalPrincipal=void 0!==typeof l.filter(e=>"DICIO_PROFISSAO"==e.id).shift()?l.filter(e=>"DICIO_PROFISSAO"==e.id).shift().conteudo:null,t.orcamento.contratantes[0].grupos[0].segurados[0].faixaRenda=void 0!==typeof l.filter(e=>"DICIO_RENDA"==e.id).shift()?l.filter(e=>"DICIO_RENDA"==e.id).shift().conteudo:null,t.orcamento.contratantes[0].grupos[0].segurados[0].formaTrabalho=void 0!==typeof l.filter(e=>"DICIO_REGIME_TRABALHO"==e.id).shift()?l.filter(e=>"DICIO_REGIME_TRABALHO"==e.id).shift().conteudo:null,t.orcamento.tempoRendaProtegida=void 0!==typeof l.filter(e=>"DICIO_TEMPO_PROTECAO"==e.id).shift()?l.filter(e=>"DICIO_TEMPO_PROTECAO"==e.id).shift().conteudo:null,e=void 0!==typeof l.filter(e=>"DICIO_DEPENDENTES"==e.id).shift()&&l.filter(e=>"DICIO_DEPENDENTES"==e.id).shift().conteudo);var i=document.querySelector('input[name="CIENTETERMOGUARDA"]:checked').value,u=document.querySelector('input[name="CIENTECONDICOES"]:checked').value,d=document.querySelector('input[name="ASSINATURAELETRONICA"]:checked').value,p=document.querySelector("#RESIDE_BRASIL").value;"NÃƒO"==p?s.dadosPessoaFisica.resideBrasil=!1:"SIM"==p&&(s.dadosPessoaFisica.resideBrasil=!0),0==e?t.orcamento.dependentesFinanceiros=!1:1==e&&(t.orcamento.dependentesFinanceiros=!0),"Nao"==i?t.orcamento.termoGuarda=!1:"Sim"==i&&(t.orcamento.termoGuarda=!0),"Nao"==u?t.orcamento.termoResponsabilidade=!1:"Sim"==u&&(t.orcamento.termoResponsabilidade=!0),"Nao"==d?t.orcamento.assinaturaEletronica=!1:"Sim"==d&&(t.orcamento.assinaturaEletronica=!0);if("VIDA_INDIVIDUAL"===JSON.parse(window.localStorage.getItem("entradaConsultivo")).consultivo.codigoOfertaConsultiva){const e=document.querySelector('input[name="switchReaproveitarAssinatura"]:checked').value;t.orcamento.reaproveitarAssinatura="true"===e}t.orcamento.formaReceberApolice=document.querySelector("#RECEBERAPOLICE").value;var m=[];"Nome do beneficiário"==n.BENEFICIARIOS.value?listBeneficiarios.forEach(e=>{console.log("ben >>>> ",e);var o={};o.nome=e.nomeBeneficiario.toUpperCase(),o.nomeSocial=e.nomeSocialBeneficiario.toUpperCase(),o.cpf=e.cpfBeneficiario.replace(/\D/g,""),o.nascimento=""!=e.nascimentoBeneficiario?getCorrectDate(e.nascimentoBeneficiario):null,o.grauParentesco=e.grauParentescoBeneficiario,o.grauParentescoOutros="Outros"==o.grauParentesco?e.grauParentescoOutros:"",o.imprimirCertificado=e.imprimirApolice,o.percentualIndenizacao=e.percentualBeneficio,o.sexoBeneficiario=e.sexoBeneficiario.toLowerCase().includes("mas")?"MASCULINO":"FEMININO",o.tipoBeneficiario=n.BENEFICIARIOS.value,m.push(o)}):m.push({nome:null,nomeSocial:null,cpf:null,nascimento:null,grauParentesco:null,percentualIndenizacao:100,sexoBeneficiario:null,tipoBeneficiario:n.BENEFICIARIOS.value}),t.orcamento.contratantes[0].grupos[0].segurados[0].beneficiarios=m,s.email=document.querySelector("#EMAIL").value.toLowerCase();const o={TELEFONECLIENTE:"RES",CELULARCLIENTE:"CEL",TELOPCIONAL:"PES"};document.querySelectorAll("#TELEFONECLIENTE, #CELULARCLIENTE, #TELOPCIONAL").forEach((e,a)=>{""!=e.value.trim()&&s.telefones.push({tipoTelefone:o[e.id]||"RES",numeroTelefone:e.value.replace(/[\( \s \) \-]/g,"").slice(2),dddTelefone:e.value.replace(/[\( \s \) \-]/g,"").slice(0,2)})})}individual&&(s.enderecos||(s.enderecos=[]),NodeList.prototype.isPrototypeOf(n.CEPCLIENTE)?(s.enderecos.push({tipoEndereco:n.TIPOENDERECO.value,logradouro:n.LOGRADOUROCLIENTE.value,numeroLogradouro:parseInt(n.NUMEROCLIENTE.value),bairro:n.BAIRROCLIENTE.value,cidade:n.CIDADECLIENTE.value,uf:n.ESTADOCLIENTE.value,cep:n.CEPCLIENTE[0].value.split("-")[0],complemento:n.COMPLEMENTO.value,complementoCep:n.CEPCLIENTE[0].value.split("-")[1]}),s.enderecos.push({tipoEndereco:n.TIPOENDERECOCOMERCIAL.value,logradouro:n.LOGRADOUROCOMERCIAL.value,numeroLogradouro:parseInt(n.NUMEROCOMERCIAL.value),bairro:n.BAIRROCOMERCIAL.value,cidade:n.CIDADECOMERCIAL.value,uf:n.ESTADOCOMERCIAL.value,cep:n.CEPCLIENTE[1].value.split("-")[0],complemento:n.COMPLEMENTOCOMERCIAL.value,complementoCep:n.CEPCLIENTE[1].value.split("-")[1]})):(s.enderecos.push({tipoEndereco:n.TIPOENDERECO.value,logradouro:n.LOGRADOUROCLIENTE.value,numeroLogradouro:parseInt(n.NUMEROCLIENTE.value),bairro:n.BAIRROCLIENTE.value,cidade:n.CIDADECLIENTE.value,uf:n.ESTADOCLIENTE.value,cep:n.CEPCLIENTE.value.split("-")[0],complemento:n.COMPLEMENTO.value,complementoCep:n.CEPCLIENTE.value.split("-")[1]}),console.log("cep comercial",n.CEPCOMERCIAL),console.log("complemento comercial",n.CEPCOMERCIAL),s.enderecos.push({tipoEndereco:n.TIPOENDERECOCOMERCIAL.value,logradouro:n.LOGRADOUROCOMERCIAL.value,numeroLogradouro:parseInt(n.NUMEROCOMERCIAL.value),bairro:n.BAIRROCOMERCIAL.value,cidade:n.CIDADECOMERCIAL.value,uf:n.ESTADOCOMERCIAL.value,cep:n.CEPCOMERCIAL.value.split("-")[0],complemento:n.COMPLEMENTOCOMERCIAL.value,complementoCep:n.CEPCOMERCIAL.value.split("-")[1]})));let E=[];for(let e=0;e<5;e++)E.push(Math.round(9*Math.random()));let O,g=new Date,I=new Date(g);const C=()=>{let e=n.cardExpiry&&n.cardExpiry.value?n.cardExpiry.value:"",o=(new Date).getFullYear().toString().slice(0,2),a=e.split("/");return a[1]=o+a[1],a=a.join(""),a=a.replace(/\//g,"").replace(/\D/g,""),a};let A={valor:0};if(JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.contratoOriginal){let e,o,a=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.contratoOriginal.precificacao.descontoAgravo.filter(e=>"FPG"==e.tipo).shift();JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].retornosCalculo.forEach(t=>{let r=t.precificacao.descontoAgravo.filter(e=>e.tipo==a.tipo).shift();a.percentual==r.percentual&&(e=r,o=t.precificacao.premio.total)}),A.valor=o}if(viagem){I.setMonth(I.getMonth()+1);let e="CartaoCredito"==n.TIPOPAGAMENTO.querySelector("option:checked").dataset.layout?"A cada 30 dias":null;switch(O={opcao:parseInt(n.OPCAO_PAGAMENTO.value),codigoFormaPagamento:parseInt(n.TIPOPAGAMENTO.value),quantidadeParcelas:parcelamentoAtualEscolhidoPeloUsuario?parcelamentoAtualEscolhidoPeloUsuario.qtdParcelas:null,cartaoCredito:null,dadosBancarios:null,formaPagamento:{codigo:parseInt(n.TIPOPAGAMENTO.value),descricao:n.TIPOPAGAMENTO.querySelector("option:checked").text,idFormaPagamento:n.TIPOPAGAMENTO.querySelector("option:checked").dataset.id,planoParcelamento:null},descricaoFormaPagamento:parcelamentoAtualEscolhidoPeloUsuario?parcelamentoAtual.descricao:null,responsavelPagamento:null,tipoResponsavelPagamento:"CON",vencimentoPrimeiraParcela:I.toISOString().slice(0,10),vencimentoDemaisParcelas:e,premioTotal:A.valor},n.TIPOPAGAMENTO.querySelector("option:checked").dataset.layout){case"CartaoCredito":O.dadosCartaoCredito={cartaoPorto:!1,cvv:"naoInformado",nome:n.cardName&&n.cardName.value?n.cardName.value.trim():"",numero:n.cardNumber&&n.cardNumber.value?n.cardNumber.value.replace(/\D/g,""):"",validade:C(),bandeira:n.cardFlag&&n.cardFlag.value?n.cardFlag.value.trim():null};break;case"ADC":O.dadosBancarios={agencia:n.ADCAGENCIA.value.trim().split("-").length>1?n.ADCAGENCIA.value.split("-")[0]:n.ADCAGENCIA.value,banco:n.ADCBANCO.dataset.valor,conta:n.ADCCONTA.value.replace(/\D/g,""),digitoAgencia:n.ADCAGENCIA.value.trim().split("-").length>1?n.ADCAGENCIA.value.split("-")[1]:0,digitoConta:n.ADCDIGITOCONTA.value.trim().replace("x","X")}}}else if(individual){let o=e?"":n.TIPOPAGAMENTO.querySelector("option:checked").dataset.layout,a=null,t=null;"Boleto"==o||"ADC"==o?a=document.getElementById("dataVencimentoOpcoes").value:"CartaoCredito"==o&&(a="A cada 30 dias");var v=document.querySelector("#retornoOrchestrator").value;let r=window.localStorage.getItem("idCartao"),l=window.localStorage.getItem("jsonEntradaCalculo");if(l=JSON.parse(l).consultivo.codigoOfertaConsultiva,!e&&"APTLMK"==l)switch(O={opcao:parseInt(n.OPCAO_PAGAMENTO.value),codigoFormaPagamento:parseInt(n.TIPOPAGAMENTO.value),quantidadeParcelas:parseInt(n.planoParcelamentos.value),cartaoCredito:null,dadosBancarios:null,formaPagamento:{codigo:parseInt(n.TIPOPAGAMENTO.value),descricao:n.TIPOPAGAMENTO.querySelector("option:checked").text,idFormaPagamento:n.TIPOPAGAMENTO.querySelector("option:checked").dataset.id,planoParcelamento:null},responsavelPagamento:null,tipoResponsavelPagamento:"CON",vencimentoDemaisParcelas:a,vigenciaInicial:t},console.log("stringOrchestrator14: ",v),"70"==n.TIPOPAGAMENTO.value&&(O.dadosCartaoCredito={cartaoPorto:!1,nome:"",numero:"",validade:"",bandeira:"",ticket:r&&""!==r.trim()?r:null},console.log("objPagamentos"+O.dadosCartaoCredito)),"97"==n.TIPOPAGAMENTO.value&&(O.dadosCartaoCredito={cartaoPorto:!0,nome:"",numero:"",validade:"",bandeira:"",ticket:r&&""!==r.trim()?r:null}),n.TIPOPAGAMENTO.querySelector("option:checked").dataset.layout){case"ADC":O.dadosBancarios={agencia:n.ADCAGENCIA.value.trim().split("-").length>1?n.ADCAGENCIA.value.split("-")[0]:n.ADCAGENCIA.value,banco:n.ADCBANCO.dataset.valor,conta:n.ADCCONTA.value.replace(/\D/g,""),digitoAgencia:n.ADCAGENCIA.value.trim().split("-").length>1?n.ADCAGENCIA.value.split("-")[1]:0,digitoConta:n.ADCDIGITOCONTA.value.trim().replace("x","X"),tipoPessoa:document.querySelector('[name="ADCTIPOPESSOA"]').value,cpf:document.querySelector('[name="ADCCPFCNPJ"]').value.replace(/\D/g,"")}}let s=JSON.parse(window.localStorage.getItem("jsonOrquestrador")),c=null;if(null!=s&&(c=s.formaInfoCartao),!e&&"APTLMK"!=l)switch(O={opcao:parseInt(n.OPCAO_PAGAMENTO.value),codigoFormaPagamento:parseInt(n.TIPOPAGAMENTO.value),quantidadeParcelas:parseInt(n.planoParcelamentos.value),cartaoCredito:null,dadosBancarios:null,formaInfoCartao:c,formaPagamento:{codigo:parseInt(n.TIPOPAGAMENTO.value),descricao:n.TIPOPAGAMENTO.querySelector("option:checked").text,idFormaPagamento:n.TIPOPAGAMENTO.querySelector("option:checked").dataset.id,planoParcelamento:null},responsavelPagamento:null,tipoResponsavelPagamento:"CON",vencimentoDemaisParcelas:a,vigenciaInicial:t},n.TIPOPAGAMENTO.querySelector("option:checked").dataset.layout){case"CartaoCredito":O.dadosCartaoCredito={cartaoPorto:!1,cvv:"naoInformado",nome:n.cardName&&n.cardName.value?n.cardName.value.trim():"",numero:n.cardNumber&&n.cardNumber.value?n.cardNumber.value.replace(/\D/g,""):"",validade:C(),bandeira:n.cardFlag&&n.cardFlag.value?n.cardFlag.value.trim():null};let e=window.localStorage.getItem("idCartao");"70"!=n.TIPOPAGAMENTO.value&&"98"!=n.TIPOPAGAMENTO.value||(O.dadosCartaoCredito={cartaoPorto:!1,nome:"",numero:"",validade:"",bandeira:"",ticket:e&&""!==e.trim()?e:null},console.log("objPagamentos"+O.dadosCartaoCredito));break;case"ADC":O.dadosBancarios={agencia:n.ADCAGENCIA.value.trim().split("-").length>1?n.ADCAGENCIA.value.split("-")[0]:n.ADCAGENCIA.value,banco:n.ADCBANCO.dataset.valor,conta:n.ADCCONTA.value.replace(/\D/g,""),digitoAgencia:n.ADCAGENCIA.value.trim().split("-").length>1?n.ADCAGENCIA.value.split("-")[1]:0,digitoConta:n.ADCDIGITOCONTA.value.trim().replace("x","X"),tipoPessoa:document.querySelector('[name="ADCTIPOPESSOA"]').value,cpf:document.querySelector('[name="ADCCPFCNPJ"]').value.replace(/\D/g,"")}}}if(individual&&!e&&n.planoParcelamentos.querySelector("option:checked"))if("0"==n.planoParcelamentos.querySelector("option:checked").value){let e=t.parcelamentos.filter(e=>e.codigo==parseInt(n.TIPOPAGAMENTO.value)).shift();if(void 0!==e){let o=e.planoParcelamentos?e.planoParcelamentos[0]:null;o&&(O.formaPagamento.planoParcelamento={codigoMeioRecebimento:o.codigoMeioRecebimento,idPlanoParcelamento:o.idPlanoParcelamento,quantidadeParcelas:o.quantidadeParcelas})}}else O.formaPagamento.planoParcelamento={codigoMeioRecebimento:n.planoParcelamentos.querySelector("option:checked").dataset.codreceb,idPlanoParcelamento:n.planoParcelamentos.value,quantidadeParcelas:parseInt(n.planoParcelamentos.value)};if(e||"97"==n.TIPOPAGAMENTO.value&&(O.dadosCartaoCredito.cartaoPorto=!0),!e)if("Nao"==n.RESPFINANCEIRO.value){O.responsavelFinanceiro=!1,O.responsavelFinanceiroSeguro={nome:document.querySelector("#NOMERESP").value.toUpperCase(),cpf:document.querySelector("#CPFRESP").value,vinculoComSegurado:document.querySelector("#VINCULORESP").value.toUpperCase(),email:document.querySelector("#EMAILRESPFIN").value,dadosPessoaFisica:{digitoCpf:n.CPFRESP.value.split("-")[1],numeroCpf:n.CPFRESP.value.split("-")[0].replace(/\./g,""),sexo:document.querySelector("#SEXORESP").value,dataNascimento:new Date(document.querySelector("#DTNASCRESP").value.split("/").reverse().join("/")).toISOString().slice(0,10),estadoCivil:document.querySelector("#ESTADOCIVILRESP").value}},O.responsavelFinanceiroSeguro.telefones=[];const e={TELEFONERESPFIN:"RES",CELULARRESPFIN:"CEL",TELOPCIONALRESPFIN:"PES"};document.querySelectorAll("#TELEFONERESPFIN, #CELULARRESPFIN, #TELOPCIONALRESPFIN").forEach((o,a)=>{""!=o.value.trim()&&O.responsavelFinanceiroSeguro.telefones.push({tipoTelefone:e[o.id]||"RES",numeroTelefone:o.value.replace(/[\( \s \) \-]/g,"").slice(2),dddTelefone:o.value.replace(/[\( \s \) \-]/g,"").slice(0,2)})}),O.responsavelFinanceiroSeguro.enderecos=[],O.responsavelFinanceiroSeguro.enderecos.push({tipoEndereco:n.TIPOENDERECORESPFIN.value,logradouro:n.LOGRADOURORESPFIN.value,numeroLogradouro:parseInt(n.NUMERORESPFIN.value),bairro:n.BAIRRORESPFIN.value,cidade:n.CIDADERESPFIN.value,uf:n.ESTADORESPFIN.value,cep:n.CEPRESPFIN.value.split("-")[0],complemento:n.COMPLEMENTORESPFIN.value,complementoCep:n.CEPRESPFIN.value.split("-")[1]})}else O.responsavelFinanceiro=!0;let S=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].retornosCalculo[0].precificacao.premio.total;e||(document.getElementById("parc_SIM")&&document.getElementById("parc_SIM").checked?O=objPagamentoManterParcelamento():S<0&&(O.codigoFormaPagamento=41)),individual&&(e||(0==O.responsavelFinanceiro?(t.orcamento.contratantes[0].grupos[0].segurados[0].responsavelFinanceiro=!1,t.orcamento.contratantes[0].grupos[0].segurados[0].responsavelFinanceiroSeguro=O.responsavelFinanceiroSeguro):1==O.responsavelFinanceiro&&(t.orcamento.contratantes[0].grupos[0].segurados[0].responsavelFinanceiro=!0)));let P=JSON.parse(window.localStorage.getItem("jsonEntradaCalculo"));if(e&&"VIAGEM_VIDA_ON"!=P.consultivo.codigoOfertaConsultiva){let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.contratoOriginal.dadosPagamento?JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.contratoOriginal.dadosPagamento:JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.contratoOriginal.contratantes[0].dadosPagamento;O=e}if("VIAGEM_VIDA_ON"==P.consultivo.codigoOfertaConsultiva&&e){let e={};e={opcao:0,codigoFormaPagamento:41,quantidadeParcelas:1,cartaoCredito:null,dadosBancarios:null,formaPagamento:{codigo:41,descricao:"BoletobancÃ¡rioParcelado",idFormaPagamento:window.localStorage.getItem("idFormaPagamento"),planoParcelamento:{idPlanoParcelamento:"1",quantidadeParcelas:1}},responsavelPagamento:null,tipoResponsavelPagamento:"CON",vencimentoDemaisParcelas:"Acada30dias",vigenciaInicial:null},O=e}new Array,new Array;if(individual){let e={idquestionario:t.regras.idquestionario,respostas:[]};t.regras.questionarios&&(t.regras.questionarios.forEach(o=>{const a=document.getElementById("pergunta_"+o.idPergunta);if(null!=a&&""!==a.value){let t={questao:o.idPergunta,resposta:a.value};e.respostas.push(t)}}),0===e.respostas.length&&(e.idquestionario=""),t.orcamento.contratantes[0].grupos[0].segurados[0].questionario=e)}let N=t.orcamento.contratantes[0].grupos;individual||viagem&&N.forEach(e=>{delete e.coberturas});let R=[{tipo:t.orcamento.contratantes[r-1].tipo,numero:r++,grupos:N,pessoa:Object.assign({},s),dadosPagamento:O}],D=t.orcamento.remuneracoes,f=D.filter(e=>"CORRETAGEM"==e.tipoRemuneracao.toUpperCase()),T=D.filter(e=>"AGENCIAMENTO"==e.tipoRemuneracao.toUpperCase());if(f.length>0){let e=!1;switch(f=f[0],f.tipoRemuneracao="COR",f.favorecidos=[],antecipaComissaoTransmissao){case 0:e=!1;break;case 1:e=!0;break;default:let o=document.querySelector('input[name="ANTECIPACOMISSAO"]:checked')?document.querySelector('input[name="ANTECIPACOMISSAO"]:checked').value:"N";e="S"==o}document.querySelectorAll(".corretorFavorecido").forEach((o,a)=>{let t=o.querySelector('input[type="checkbox"]').checked,r=o.querySelector('input[type="text"]').value.toUpperCase(),n=o.querySelector('input[type="range"]').value;f.favorecidos.push({papel:"COR",participacao:parseInt(n),corretorLider:t,susep:r,pessoa:null}),f.favorecidos[f.favorecidos.length-1].antecipaComissao=e;const l=JSON.parse(window.localStorage.getItem("entradaConsultivo"));if(document.getElementById("switchQuestionarioCorretor")&&("VIDA_INDIVIDUAL"===l.consultivo.codigoOfertaConsultiva||"VIDA_INDIVIDUAL_VP"===l.consultivo.codigoOfertaConsultiva)){const e=document.getElementById("switchQuestionarioCorretor").checked,o=document.getElementById("CELULARCLIENTE").value;f.favorecidos[f.favorecidos.length-1].corretorResponde=t?e:null,f.favorecidos[f.favorecidos.length-1].corretorCelular=t?o:null}})}if(T.length>0&&(T=T[0],T.tipoRemuneracao="AGE",T.favorecidos=[],null!=T.percentual&&T.percentual>0&&individual)){let e="AGE",o=!0;"CORRETOR"==document.querySelector("#AGENCIAMENTO_PARA").value&&(e="COR",o=!1);let a=document.querySelector("#SUSEP_AGENCIADOR").value.toUpperCase(),t=document.querySelector("#CPF_AGENCIADOR").value+"",r=!1,n=!1;t=t.replace(/\D/g,""),11==t.length&&(r=!0),14==t.length&&(n=!0);let l="FIS";n&&(l="JUR");let s=null,c=null;r&&(s={numeroCpf:t.slice(0,9),digitoCpf:t.slice(9,11)}),n&&(c={numeroCnpj:t.slice(0,8),ordemCnpj:t.slice(8,12),digitoCnpj:t.slice(12,14)}),T.favorecidos.push({papel:e,participacao:100,susep:a,pessoa:{tipo:l,dadosPessoaFisica:s,dadosPessoaJuridica:c}})}function h(e,o){try{console.error("value-> "+e);let a=function(e){try{var o=e.substring(0,3),a=e.replace(/\D/g,"");if(console.log("r "+o),console.log("m "+a.length),a.length<12)return(e=e.replace(/\D/g,"")).padEnd(7," "),e;if(e.length<16){console.log("if 1 "+e.length);var t=e.substring(0,2);if(console.log("->> "+t),"55"==t&&a.length<14){var r=e.replace(/\D/g,"");if(r=(r=r.replace(/^(\d{2})(\d)/g,"($1) $2")).replace(/(\d)(\d{4})$/,"$1-$2"),console.log("size V-> "+r.length),r.length>=16&&r.length<20)return 12==(r=(r=(r=(r=r.replace(/\D/g,"")).replace(/^(\d)/,"+$1")).replace(/(.{3})(\d)/,"$1 ($2")).replace(/(.{7})(\d)/,"$1) $2")).length?r=r.replace(/(.{1})$/,"-$1"):13==r.length?r=r.replace(/(.{2})$/,"-$1"):14==r.length?r=r.replace(/(.{3})$/,"-$1"):(15==r.length||r.length>15)&&(r=r.replace(/(.{4})$/,"-$1")),r}return e}if(e.length>=16&&e.length<20&&a.length<16){console.log("if 2"),12==(e=(e=(e=(e=e.replace(/\D/g,"")).replace(/^(\d)/,"+$1")).replace(/(.{3})(\d)/,"$1 ($2")).replace(/(.{7})(\d)/,"$1) $2")).length?e=e.replace(/(.{1})$/,"-$1"):13==e.length?e=e.replace(/(.{2})$/,"-$1"):14==e.length?e=e.replace(/(.{3})$/,"-$1"):(15==e.length||e.length>15)&&(e=e.replace(/(.{4})$/,"-$1"));t=e.substring(0,3);return console.log("->> "+t),"+55"==t?e:e=e.replace(/\D/g,"")}return e.length>=20?(console.log("if 3"),e=e.replace(/\D/g,"")):e=e.replace(/\D/g,"")}catch(e){console.error("error  "+e)}}(e),t=a.includes("+")?a.slice(0,8):a.slice(0,2),r=a.includes("+")?a.split(" ")[2]:a.slice(2);return console.log("ddd-> "+t),console.log("tel-> "+r),o?t:r}catch(o){return console.error("err "+o),e}}let L=document.querySelectorAll(".listaSegurados .segurado");if(viagem){let e=JSON.parse(window.localStorage.getItem("jsonMdtGrupo")),o=[];document.querySelectorAll("#TELEFONE, #TELCLIENTEALTERNATIVOSEGURADO0").forEach((e,a)=>{""!=e.value.trim()&&o.push({tipoTelefone:"RES",numeroTelefone:h(e.value,!1),dddTelefone:h(e.value,!0)})});let a=document.querySelector("#NOMECLIENTEALTERNATIVOSEGURADO0").value,r=document.querySelector('[name="TELCLIENTEALTERNATIVOSEGURADO0"]').value,l=calcIdadeViagem(),s=t.orcamento.contratantes[0].grupos.map(e=>e.nome).indexOf(parseInt(l)<=70?e.GRUPO_JOVENS_NOME:e.GRUPO_IDOSOS_NOME);t.orcamento.contratantes[0].grupos[s].segurados=[],console.log("telefoneAcidenteSegurado: ",r),t.orcamento.contratantes[0].grupos[s].segurados.push({pessoa:{tipo:"FIS",enderecos:[{tipoEndereco:n.TIPOENDERECO.value,logradouro:n.LOGRADOUROCLIENTE.value,bairro:n.BAIRROCLIENTE.value,cidade:n.CIDADECLIENTE.value,uf:n.ESTADOCLIENTE.value,cep:n.CEP.value.split("-")[0],complementoCep:n.CEP.value.split("-")[1],numeroLogradouro:n.NUMEROCLIENTE.value,complemento:n.COMPLEMENTO.value,paisResidencia:"NACIONAL"==n.TIPO_VIAGEM.value?"BRA":n.PAISRESIDENTE.value}],nome:n.DICIO_NOME.value.toUpperCase(),nomeSocial:n.DICIO_NOMESOCIAL.value?n.DICIO_NOMESOCIAL.value.toUpperCase():"",dadosPessoaFisica:{digitoCpf:n.CPF.value.split("-")[1],numeroCpf:n.CPF.value.split("-")[0].replace(/\./g,""),sexo:n.DICIO_SEXO.value.toLowerCase().includes("mas")?"MASCULINO":"FEMININO",dataNascimento:n.DICIO_DATANASCIMENTO.value.split("/").reverse().join("-")},email:n.EMAIL.value.toLowerCase(),telefones:o,pep:null,pessoaRelacionamentoPep:null},contatoEmergencia:{nome:a,ddd:h(r,!0),telefone:h(r,!1)},numero:1}),L.length>0&&(L.forEach((o,a)=>{let r=document.querySelector('input[name="TELEFONESEGURADO'+(a+1)+'"]').value,l=document.querySelector('input[name="TELCLIENTEALTERNATIVOSEGURADO'+(a+1)+'"]').value,s=document.querySelector("#NOMESEGURADO"+(a+1)).value,c=document.querySelector("#NOMESOCIALSEGURADO"+(a+1)).value?document.querySelector("#NOMESOCIALSEGURADO"+(a+1)).value:"",i=document.querySelector("#CPFSEGURADO"+(a+1)).value,u=document.querySelector("#DATANASCIMENTOSEGURADO"+(a+1)).value,d=document.querySelector("#RESIDEBRASILSEGURADO"+(a+1)).value,p=document.querySelector("#PAISRESIDENTESEGURADO"+(a+1)).value,m=document.querySelector("#NOMECLIENTEALTERNATIVOSEGURADO"+(a+1)).value,E=document.querySelector("#SEXOSEGURADO"+(a+1)).value.toLowerCase().includes("mas")?"MASCULINO":"FEMININO",O=[];r&&O.push({tipoTelefone:"RES",numeroTelefone:h(r,!1),dddTelefone:h(r,!0)}),l&&O.push({tipoTelefone:"RES",numeroTelefone:h(l,!1),dddTelefone:h(l,!0)});let g=diferencaDatas(new Date(u.split("/").reverse().join("-")),new Date((new Date).toISOString().slice(0,10)),"Y"),I=t.orcamento.contratantes[0].grupos.map(e=>e.nome).indexOf(parseInt(g)<=70?e.GRUPO_JOVENS_NOME:e.GRUPO_IDOSOS_NOME);void 0===t.orcamento.contratantes[0].grupos[I].segurados&&(t.orcamento.contratantes[0].grupos[I].segurados=[]),t.orcamento.contratantes[0].grupos[I].segurados.push({pessoa:{tipo:"FIS",enderecos:[{tipoEndereco:n.TIPOENDERECO.value,logradouro:n.LOGRADOUROCLIENTE.value,bairro:n.BAIRROCLIENTE.value,cidade:n.CIDADECLIENTE.value,uf:n.ESTADOCLIENTE.value,cep:n.CEP.value.split("-")[0],complementoCep:n.CEP.value.split("-")[1],numeroLogradouro:n.NUMEROCLIENTE.value,complemento:n.COMPLEMENTO.value,paisResidencia:"SIM"==d?"BRA":p}],nome:s,nomeSocial:c,dadosPessoaFisica:{sexo:E,numeroCpf:i.split("-")[0].replace(/\./g,""),digitoCpf:i.split("-")[1],dataNascimento:new Date(u.split("/").reverse().join("-")).toISOString().slice(0,10)},telefones:O,pep:null,pessoaRelacionamentoPep:null},contatoEmergencia:{nome:m,ddd:h(l,!0),telefone:h(l,!1)},numero:a+2})}),null!=t.orcamento.contratantes[0].grupos[0].segurados?t.orcamento.contratantes[0].grupos[0].qtdeVidas=t.orcamento.contratantes[0].grupos[0].segurados.length:t.orcamento.contratantes[0].grupos[0].qtdeVidas=0,null!=t.orcamento.contratantes[0].grupos[1].segurados?t.orcamento.contratantes[0].grupos[1].qtdeVidas=t.orcamento.contratantes[0].grupos[1].segurados.length:t.orcamento.contratantes[0].grupos[1].qtdeVidas=0)}else individual&&(L.length>0&&L.forEach((e,o)=>{let a=e.querySelector("#NOMESEGURADO"+(o+1)).value,r=e.querySelector("#CPFSEGURADO"+(o+1)).value,n=(e.querySelector("#PROFISSAOSEGURADO"+(o+1)).value,e.querySelector("#TIPODOCUMENTOSEGURADO"+(o+1)).value,e.querySelector("#NUMERODOCUMENTOSEGURADO"+(o+1)).value,e.querySelector("#ORGAOEMISSORSEGURADO"+(o+1)).value,e.querySelector("#DATAEXPEDICAOSEGURADO"+(o+1)).value,e.querySelector("#DATANASCIMENTOSEGURADO"+(o+1)).value),l=e.querySelector("#SEXOSEGURADO"+(o+1)).value.toLowerCase().includes("mas")?"MASCULINO":"FEMININO",s=e.querySelector("#ESTADOCIVILSEGURADO"+(o+1)).value,c=e.querySelector("#NACIONALIDADESEGURADO"+(o+1)).value,i=e.querySelector("#RESIDENTESEGURADO"+(o+1)).value,u=e.querySelector("#PAISRESIDENTE"+(o+1)).value,d=e.querySelector("#RENDAMENSALSEGURADO"+(o+1)).value,p=e.querySelector("#BENEFICIARIOSSEGURADO"+(o+1)).value,m=(e.querySelector("#IMPRESSAOCERTIFICADOSEGURADO"+(o+1)).value,e.querySelector("#telClientSEGURADO"+(o+1)).value),E=e.querySelector('select[name="tipoTelSEGURADO'+(o+1)+'"]').value,O=(e.querySelector("#ramalClientSEGURADO"+(o+1)).value,e.querySelector("#telClient2SEGURADO"+(o+1)).value),g=e.querySelector('select[name="tipoTel2SEGURADO'+(o+1)+'"]').value,I=(e.querySelector("#ramalClient2SEGURADO"+(o+1)).value,e.querySelector('select[name="ENVIOAPOLICESEGURADO'+(o+1)+'"]').value,e.querySelector('select[name="TIPOENVIOSEGURADO'+(o+1)+'"]').value,e.querySelector("#NOMECLIENTEALTERNATIVOSEGURADO"+(o+1)).value,e.querySelector("#TELCLIENTEALTERNATIVOSEGURADO"+(o+1)).value),C=(e.querySelector("#BAIRROCLIENTEALTERNATIVOSEGURADO"+(o+1)).value,e.querySelector("#CIDADECLIENTEALTERNATIVOSEGURADO"+(o+1)).value,e.querySelector('input[name="recebimentoSEGURADO'+(o+1)+'"]').value,[]);m&&C.push({tipoTelefone:E,numeroTelefone:m.split(" ")[1].replace(/\-/g,""),dddTelefone:m.split(" ")[0].replace(/\(|\)/g,"")}),O&&C.push({tipoTelefone:g,numeroTelefone:O.split(" ")[1].replace(/\-/g,""),dddTelefone:O.split(" ")[0].replace(/\(|\)/g,"")}),I&&C.push({tipoTelefone:"RES",numeroTelefone:I.split(" ")[1].replace(/\-/g,""),dddTelefone:I.split(" ")[0].replace(/\(|\)/g,"")});let A=[];if("Nome do beneficiÃ¡rio"==p){e.querySelectorAll(".beneficiario").forEach((e,a)=>{A.push({tipoBeneficiario:p,motivoSemCpfCnpj:""!=e.querySelector("#CPFPROP"+(a+1)+"SEGURADO"+(o+1)).value.trim()?e.querySelector("#MOTIVOSEMCPFPROP"+(a+1)+"SEGURADO"+(o+1)).value:null,grauParentesco:e.querySelector("#GRAUPROP"+(a+1)+"SEGURADO"+(o+1)).value,participacao:parseFloat(e.querySelector("#PERCENTUALPROP"+(a+1)+"SEGURADO"+(o+1)).value.replace("%","")),pessoa:{tipo:"FIS",nome:e.querySelector("#NOMEPROP"+(a+1)+"SEGURADO"+(o+1)).value,email:"",rendaMensal:parseFloat(e.querySelector("#RENDAMENSALPROP"+(a+1)+"SEGURADO"+(o+1)).value.replace(/[(R\$ ) \.]/g,"").replace(",",".")),dadosPessoaFisica:{sexo:"",numeroCpf:e.querySelector("#CPFPROP"+(a+1)+"SEGURADO"+(o+1)).value.split("-")[0].replace(/\./g,""),digitoCpf:e.querySelector("#CPFPROP"+(a+1)+"SEGURADO"+(o+1)).value.split("-")[1],profissao:parseInt(e.querySelector("#PROFISSAOPROP"+(a+1)+"SEGURADO"+(o+1)).dataset.valor),estadoCivil:"",dataNascimento:new Date(e.querySelector("#NASCIMENTOPROP"+(a+1)+"SEGURADO"+(o+1)).value.split("/").reverse().join("-")).toISOString(),pep:""}},telefones:[{tipoTelefone:"COM",numeroTelefone:e.querySelector("#TELEFONEPROP"+(a+1)+"SEGURADO"+(o+1)).value.slice(5).replace("-",""),dddTelefone:e.querySelector("#TELEFONEPROP"+(a+1)+"SEGURADO"+(o+1)).value.slice(0,4).replace(/[\( | \)]/g,"")}]})})}else A.push({tipoBeneficiario:p});t.orcamento.contratantes[0].grupos[0].segurados.push({pessoa:{tipo:"FIS",enderecos:[{paisResidencia:"SIM"==i?"BRA":u}],nome:a,dadosPessoaFisica:{numeroCpf:r.split("-")[0].replace(/\./g,""),digitoCpf:r.split("-")[1],dataNascimento:new Date(n.split("/").reverse().join("-")).toISOString(),fumante:!1,sexo:l.toLowerCase().includes("mas")?"MASCULINO":"FEMININO",estadoCivil:s,nacionalidade:c},rendaMensal:parseFloat(d.replace(/R\$ /g,"").replace(/\./g,"").replace(/\,/g,".")),telefones:C},numero:L.length+1,coberturas:t.orcamento.contratantes[0].grupos[0].segurados[0].coberturas,questionario:objQuestionario,beneficiarios:A})}),t.orcamento.contratantes[0].grupos[0].qtdeVidas=t.orcamento.contratantes[0].grupos[0].segurados.length);var M,y=document.querySelector("#retornoOrchestrator").value;M=viagem?{propostas:[{indice:1,codigoEmpresa:1,tipoSeguro:t.orcamento.tipoSeguro.toUpperCase(),numeroOrcamento:a,numeroPortal:t.orcamento.numeroPortal,dataProtocolo:(new Date).toISOString().slice(0,10),remuneracoes:D,contratantes:R,viagem:t.orcamento.viagem,segmento:t.orcamento.segmento}]}:individual&&"false"===y?{proposta:{indice:1,codigoEmpresa:1,numeroOrcamento:a,numeroPortal:t.orcamento.numeroPortal,origem:18,ramoSeguro:t.orcamento.ramoSeguro?t.orcamento.ramoSeguro:null,tipoSeguro:t.orcamento.tipoSeguro,entradaNegocio:t.orcamento.canalDistribuicao,dataProtocolo:(new Date).toISOString().slice(0,10),meioComercializacao:t.orcamento.meioComercializacao,codigoProdutoVida:t.orcamento.codigoProdutoVida,contratantes:R,canalDistribuicao:t.orcamento.canalDistribuicao,remuneracoes:D,segmento:t.orcamento.segmento,tempoRendaProtegida:t.orcamento.tempoRendaProtegida,dependentesFinanceiros:t.orcamento.dependentesFinanceiros,formaReceberApolice:t.orcamento.formaReceberApolice,termoGuarda:t.orcamento.termoGuarda,termoResponsabilidade:t.orcamento.termoResponsabilidade,assinaturaEletronica:t.orcamento.assinaturaEletronica,reaproveitarAssinatura:t.orcamento.reaproveitarAssinatura&&t.orcamento.reaproveitarAssinatura}}:individual&&"true"===y?{proposta:{indice:1,codigoEmpresa:14,numeroOrcamento:a,numeroPortal:t.orcamento.numeroPortal,origem:18,ramoSeguro:t.orcamento.ramoSeguro?t.orcamento.ramoSeguro:null,tipoSeguro:t.orcamento.tipoSeguro,entradaNegocio:t.orcamento.canalDistribuicao,dataProtocolo:(new Date).toISOString().slice(0,10),meioComercializacao:t.orcamento.meioComercializacao,codigoProdutoVida:t.orcamento.codigoProdutoVida,contratantes:R,canalDistribuicao:t.orcamento.canalDistribuicao,remuneracoes:D,segmento:t.orcamento.segmento,tempoRendaProtegida:t.orcamento.tempoRendaProtegida,dependentesFinanceiros:t.orcamento.dependentesFinanceiros,formaReceberApolice:t.orcamento.formaReceberApolice,termoGuarda:t.orcamento.termoGuarda,termoResponsabilidade:t.orcamento.termoResponsabilidade,assinaturaEletronica:t.orcamento.assinaturaEletronica,reaproveitarAssinatura:t.orcamento.reaproveitarAssinatura&&t.orcamento.reaproveitarAssinatura}}:{proposta:{indice:1,codigoEmpresa:1,numeroOrcamento:a,numeroPortal:t.orcamento.numeroPortal,origem:18,tipoSeguro:t.orcamento.tipoSeguro,entradaNegocio:t.orcamento.canalDistribuicao,dataProtocolo:(new Date).toISOString().slice(0,10),meioComercializacao:t.orcamento.meioComercializacao,codigoProdutoVida:t.orcamento.codigoProdutoVida,contratantes:R,canalDistribuicao:t.orcamento.canalDistribuicao,remuneracoes:D,segmento:t.orcamento.segmento,tempoRendaProtegida:t.orcamento.tempoRendaProtegida,dependentesFinanceiros:t.orcamento.dependentesFinanceiros,formaReceberApolice:t.orcamento.formaReceberApolice,termoGuarda:t.orcamento.termoGuarda,termoResponsabilidade:t.orcamento.termoResponsabilidade,assinaturaEletronica:t.orcamento.assinaturaEletronica,reaproveitarAssinatura:t.orcamento.reaproveitarAssinatura&&t.orcamento.reaproveitarAssinatura}},endosso&&(viagem?M.propostas[0].contratoOriginal=t.orcamento.contratoOriginal:(individual,M.proposta.contratoOriginal=t.orcamento.contratoOriginal));let F={propostas:[]};viagem?(console.log("entrou aqui"),M.propostas[0].contratantes[0].grupos.forEach(e=>{e.segurados&&e.segurados.forEach((o,a)=>{F.propostas.push(JSON.parse(JSON.stringify(M.propostas[0]))),F.propostas[F.propostas.length-1].indice=F.propostas.length,F.propostas[F.propostas.length-1].contratantes[0].grupos=[JSON.parse(JSON.stringify(e))],F.propostas[F.propostas.length-1].contratantes[0].grupos[0].qtdeVidas=1,F.propostas[F.propostas.length-1].contratantes[0].grupos[0].segurados=[],F.propostas[F.propostas.length-1].contratantes[0].grupos[0].segurados.push(o)})})):individual&&(M.proposta.remuneracoes=M.proposta.remuneracoes.filter(e=>0!=e.percentual),M.proposta.contratantes[0].grupos.forEach(e=>{e.segurados&&(console.log("grupo.segurados",e.segurados),e.segurados.forEach((o,a)=>{F.propostas.push(JSON.parse(JSON.stringify(M.proposta))),F.propostas[F.propostas.length-1].indice=F.propostas.length,F.propostas[F.propostas.length-1].contratantes=M.proposta.contratantes,F.propostas[F.propostas.length-1].contratantes[0].grupos=[JSON.parse(JSON.stringify(e))],F.propostas[F.propostas.length-1].contratantes[0].grupos[0].qtdeVidas=1,F.propostas[F.propostas.length-1].contratantes[0].grupos[0].segurados=[],F.propostas[F.propostas.length-1].contratantes[0].grupos[0].segurados.push(o)}))}));let G={propostas:[]};return Array(...document.querySelectorAll("#formProposta #CPF, .cpfSegurado")).map(e=>e.value||null).filter(e=>e).forEach(e=>{G.propostas.push(F.propostas.find(o=>{let a=o.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.numeroCpf+o.contratantes[0].grupos[0].segurados[0].pessoa.dadosPessoaFisica.digitoCpf;return e.replace(/\.|\-/g,"")==a}))}),G.propostas.forEach((e,o)=>e.indice=o+1),G}
"use strict";const translationsTypeInputs={"Número inteiro":"text",Texto:"text","Opções fixas":"select","Opção fixa painel":"select","Opções de serviço":"text",CEP:"text",CPF:"text",Booleano:"checkbox",DataCalendario:"text",Radiobutton:"radio",Data:"text"},translationsPayType={1:"cartao-12",11:"a-vista-cia",21:"a-vista-30",25:"cia-carne-melhor-data",41:"frac-parcela-carne",51:"adc-cia-carne",52:"adc-parcelas",53:"cheque-adc",62:"cartao-credito",71:"cia-carne-mensal",81:"cia-carne",82:"cia-carne-juridica",97:"cartao-porto",70:"cartao-credito-recorrente",98:"cartao-credito-porto"},translationsPayTypeLayout={ADC:"adc",Boleto:"boleto",CartaoCredito:"cartao"},translationsCardType={"jp-card-elo":"Elo","jp-card-visa":"Visa","jp-card-visaelectron":"Visaelectron","jp-card-mastercard":"Mastercard","jp-card-maestro":"Maestro","jp-card-amex":"Amex","jp-card-discover":"Discover","jp-card-dinersclub":"Dinersclub","jp-card-jcb":"Jcb"};
Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function r(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(a,e){return Array.isArray(e)?a.push.apply(a,r.call(e,t-1)):a.push(e),a}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(r){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});
function sanitizeString(e){var t=e.toLowerCase().trim().replace(/\s+/g," ");return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(new RegExp(/\s/g),"-")).replace(new RegExp(/[àáâãäå]/g),"a")).replace(new RegExp(/æ/g),"ae")).replace(new RegExp(/ç/g),"c")).replace(new RegExp(/[èéêë]/g),"e")).replace(new RegExp(/[ìíîï]/g),"i")).replace(new RegExp(/ñ/g),"n")).replace(new RegExp(/[òóôõö]/g),"o")).replace(new RegExp(/œ/g),"oe")).replace(new RegExp(/[ùúûü]/g),"u")).replace(new RegExp(/[ýÿ]/g),"y")).replace(new RegExp(/\W/g),"-")}function camelCase(e){return e=sanitizeString(e).replace(/\-/g," ").replace(/\-/g," ").replace(/\s[a-z]/g,e=>e.toUpperCase()).replace(/\s+/g,"").replace(/^[A-Z]/g,e=>e.toLowerCase())}function getOfertaSelecionada(){let e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")),t=window.localStorage.getItem("ofertaSelecionada");return e.ofertas.filter(e=>e.orcamento.numeroOrcamento==t).shift()||e.ofertas[0]}function apagarPagmento(){let e=getOfertaSelecionada(),t=JSON.parse(window.localStorage.getItem("jsonEntradaCalculo"));return!!(0==JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].retornosCalculo[0].precificacao.premio.total&&e.orcamento.tiposEndosso&&e.orcamento.tiposEndosso.cad&&e.orcamento.contratantes[0].manterPlanoParcelamento)||"VIAGEM_VIDA_ON"==t.consultivo.codigoOfertaConsultiva}function checkSimpleJsonStructure(e,t){return!!e.toString().includes(t+":")}function getCorrectDate(e){if(e.indexOf("-")>=0)return e;let t="";return e instanceof Date?Number.isNaN(e.getTime())||(t=e.toISOString().split("T")[0]):e.indexOf("/")>=0&&(t=e.split("/").reverse().join("-")),t}function selectedEndereco(e){console.log("selectedEndereco",e),setTimeout(()=>{document.getElementById(e).dispatchEvent(new Event("blur"));const t=document.getElementById(e).parentNode.nextElementSibling.nextElementSibling.querySelector("input").value,n=document.getElementById(e).parentNode.nextElementSibling.querySelector("select"),o=setInterval((function(){if(n.options.length>1){for(const e of n.options)if(e.value.includes(t)){n.value=e.value,n.dispatchEvent(new Event("change"));break}clearInterval(o)}}),500);setTimeout(()=>{clearInterval(o)},5e3)},1e3)}
"use strict";const msgErroCPFIgual="Não foi possível prosseguir pois um mesmo passageiro foi adicionado mais de uma vez na lista. Por favor, verifique os dados inseridos.";function validarInputsAtuais(e){let a=e.querySelectorAll('input[type="text"][required]'),t=e.querySelectorAll('input[type="radio"][required]'),r=(viagem||individual,e.querySelectorAll("select[required]")),l=!0;if(a.length>0){let e=[],t=[];a.forEach(a=>{if("DICIO_NOME"==a.id&&(a.value=a.value.trim()),""==a.value&&"CPF"!=a.id&&"DICIO_DATANASCIMENTO"!=a.id&&"DICIO_DATA_SAIDA"!=a.id&&"DICIO_DATA_RETORNO"!=a.id)e.push(a);else if("CPF"==a.id)validaCPF(a.value)?t.push(a):(l=!1,e.push(a));else if("DICIO_DATANASCIMENTO"==a.id){let r=validaDataNascimento(a);if("ok"!=r){l=!1;let t=a.parentNode.querySelector(".helper-text");t?t.dataset.error=r:(t=document.createElement("span"),t.classList.add("helper-text"),t.dataset.error=r,a.parentNode.appendChild(t)),e.push(a)}else t.push(a)}else if("DICIO_DATA_SAIDA"==a.id){let r=validaDataSaida(a);"ok"!=r?(l=!1,buildHelper(a,r),e.push(a)):(t.push(a),resetHelper(a))}else if("DICIO_DATA_RETORNO"==a.id){let r=validaDataRetorno(a);"ok"!=r?(l=!1,buildHelper(a,r),e.push(a)):(t.push(a),resetHelper(a))}else!a.classList.contains("servico")||""==a.value||void 0!==a.dataset.valor&&""!=a.dataset.valor&&"empty"!=a.dataset.valor?t.push(a):e.push(a)}),t.length>0&&t.forEach(e=>{e.classList.remove("invalid")}),e.length>0&&(l=!1,e.forEach(e=>{e.classList.add("invalid")}))}if(t.length>0){let a=[];t.forEach(e=>{a.includes(e.name)||a.push(e.name)}),Array(a).forEach(a=>{0==e.querySelectorAll('input[name="'+a+'"]:checked').length?(l=!1,e.querySelector(".message").innerHTML="Preencha o campo corretamente"):e.querySelector(".message").innerHTML=""})}if(r.length>0){let e=[],a=[],t=[];if(r.forEach(r=>{"nulloption"==r.value||null===r.value||void 0===r?e.push(r):"DICIO_QTD_IDOSOS"==r.id||"DICIO_QTD_JOVENS"==r.id?t.push(r):a.push(r)}),2==t.length){Array(...t).every(e=>"0"==e.value)?(l=!1,t.forEach(e=>{e.parentNode.classList.add("invalid"),buildHelper(e,"O valor de ao menos um destes campos deve ser maior do que 0.")})):t.forEach(t=>{"nulloption"==t.value?e.push(t):a.push(t)})}e.length>0&&(l=!1,e.forEach(e=>{e.parentNode.classList.add("invalid"),resetHelper(e)})),a.length>0&&a.forEach(e=>{resetHelper(e),e.parentNode.classList.remove("invalid")})}return l}function validarInputsBeneficiarios(e){let a=e.querySelectorAll('input[type="text"][required]'),t=e.querySelectorAll('input[type="radio"][required]'),r=e.querySelectorAll("select[required]"),l=!0;if(a.length>0){let e=[],t=[],r=!0,o="OUTROS"==document.getElementById("grauParentescoBeneficiario").value.toUpperCase();a.forEach(a=>{if("nomeBeneficiario"==a.id&&(a.value=a.value.trim()),""!=a.value||"nomeBeneficiario"!=a.id&&"grauParentescoBeneficiario"!=a.id&&"percentualBeneficio"!=a.id)if("cpfBeneficiario"==a.id||"cnpjBeneficiario"==a.id)r="cpfBeneficiario"==a.id,validaCPF(a.value)||""==a.value||"cpfBeneficiario"!=a.id?validaCNPJ(a.value)||""==a.value||"cnpjBeneficiario"!=a.id?t.push(a):(l=!1,e.push(a),buildHelper(a,"CNPJ inválido")):(l=!1,e.push(a),buildHelper(a,"CPF inválido"));else if("percentualBeneficio"==a.id)parseInt(a.value)<=0?(l=!1,e.push(a),a.parentNode.classList.add("invalid"),buildHelper(a,"Percentual deve ser maior que 0%")):t.push(a);else if("nascimentoBeneficiario"==a.id){let o=new Date(a.value.split("/").reverse().join("-"));if(console.log("dataDigitada",o,a),"Invalid Date"!=o){let i=new Date((new Date).toISOString().slice(0,10));""==a.value&&r?(l=!1,e.push(a),a.parentNode.classList.add("invalid"),buildHelper(a,"Data não informada")):isNaN(o.getTime())&&r?(l=!1,e.push(a),a.parentNode.classList.add("invalid"),buildHelper(a,"Data inválida")):o>i?(l=!1,e.push(a),a.parentNode.classList.add("invalid"),buildHelper(a,"A data de nascimento não pode ser posterior à data de hoje.")):t.push(a)}}else"beneficiarioGrauParentescoOutros"==a.id&&""==a.value&&o?(l=!1,e.push(a),a.parentNode.classList.add("invalid"),buildHelper(a,"O vínculo é obrigatório para Grau de Parentescos: OUTROS")):t.push(a);else e.push(a)}),t.length>0&&t.forEach(e=>{e.classList.remove("invalid")}),e.length>0&&(l=!1,e.forEach(e=>{e.classList.add("invalid")}))}if(t.length>0){let a=[];t.forEach(e=>{a.includes(e.name)||a.push(e.name)}),Array(a).forEach(a=>{if(Array.isArray(a))a.forEach(a=>{0==e.querySelectorAll('input[name="'+a+'"]:checked').length?(l=!1,e.querySelector(".message").innerHTML="Preencha o campo corretamente "+a):e.querySelector(".message").innerHTML=""});else{0==e.querySelectorAll('input[name="'+a+'"]:checked').length?(l=!1,e.querySelector(".message").innerHTML="Preencha o campo corretamente"):e.querySelector(".message").innerHTML=""}})}if(r.length>0){let e=[],a=[],t=[];r.forEach(r=>{"nulloption"==r.value?(e.push(r),"grauParentescoBeneficiario"==r.id&&t.push(r)):null===r.value||void 0===r?e.push(r):a.push(r)}),e.length>0&&(l=!1,e.forEach(e=>{e.parentNode.classList.add("invalid"),resetHelper(e),t.length>0&&t.forEach(e=>{e.parentNode.classList.add("invalid"),buildHelper(e,"Selecione o grau de parentesco.")})})),a.length>0&&a.forEach(e=>{resetHelper(e),e.parentNode.classList.remove("invalid")})}return l}function validaCNPJ(e){if(""==(e=e.replace(/[^\d]+/g,"")))return!1;if(14!=e.length)return!1;for(let a=0;a<=9;a++){let t="";for(let e=0;e<14;e++)t+=String(a);if(parseInt(e)===parseInt(t))return!1}let a=e.length-2,t=e.substring(0,a),r=e.substring(a),l=0,o=a-7;for(let e=a;e>=1;e--)l+=t.charAt(a-e)*o--,o<2&&(o=9);let i=l%11<2?0:11-l%11;if(i!=r.charAt(0))return!1;a+=1,t=e.substring(0,a),l=0,o=a-7;for(let e=a;e>=1;e--)l+=t.charAt(a-e)*o--,o<2&&(o=9);return i=l%11<2?0:11-l%11,i==r.charAt(1)}function validateDataNascimento(e){return!!document.forms.signup.dateofbirth.value.match(/(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d/)}function validaCPF(e){let a=e.replace(/[\. || \-]/g,""),t=0,r=0;if(11!=a.length)return!1;for(let e=0;e<=9;e++){let t="";for(let a=0;a<11;a++)t+=String(e);if(parseInt(a)===parseInt(t))return!1}for(let e=0;e<9;e++)t+=parseInt(a.substring(e,e+1))*(11-(e+1));if(r=10*t%11,10!=r&&11!=r||(r=0),r!=parseInt(a.substring(9,10)))return!1;t=0;for(let e=0;e<10;e++)t+=parseInt(a.substring(e,e+1))*(12-(e+1));return r=10*t%11,10!=r&&11!=r||(r=0),r==parseInt(a.substring(10,11))}function validaCampoPersonalizar(e,a){let t=document.querySelectorAll(".personalize .personalizeInput"),r=a.dataset&&a.dataset.incluir?a.dataset.incluir.split(","):null,l=a.dataset&&a.dataset.excluir?a.dataset.excluir.split(","):null;e.target.checked?(null!=r&&t.forEach(e=>{if(r.filter(a=>a==e.id).length>0){e.setAttribute("disabled","true"),e.checked=!0,closestByClass(e,"containerCampo").classList.remove("off"),t.forEach(e=>{let a=e.dataset.excluir?e.dataset.excluir.split(","):null;null!=a&&a.filter(e=>e==t.id).length>0&&e.setAttribute("disabled","true")})}}),null!=l&&t.forEach(e=>{if(l.filter(a=>a==e.id).length>0){e.setAttribute("disabled","true"),closestByClass(e,"containerCampo").classList.add("off"),e.checked=!1}})):(e.target.removeAttribute(""),t.forEach(e=>{r&&r.filter(a=>a==e.id).length>0&&e.removeAttribute("disabled"),l&&l.filter(a=>a==e.id).length>0&&e.removeAttribute("disabled")}))}function validarObjTransmissao(e){return(!e.retornoAceitacao.pendencias||!e.retornoAceitacao.pendencias.length)&&((!e.retornoAceitacao.analises||!e.retornoAceitacao.analises.length)&&(!e.retornoAceitacao.recusas||!e.retornoAceitacao.recusas.length))}function validaIntegracao(e){return!JSON.parse(e).message}function validaIntegracaoTransmissao(e){return!(new Array(...new Set([...JSON.parse(e).devolutivasPropostas.map(e=>e.message)])).filter(e=>e).length>0)}function validaEntradaConsultivoDuplicada(e,a){let t={},r={};return a=a||{},Object.values(a).length>0&&a.consultivo.respostas.forEach(e=>{t[e.id]=e.conteudo}),e.consultivo.respostas.forEach(e=>{r[e.id]=e.conteudo}),objectIsEquivalent(t,r)}function objectIsEquivalent(e,a){let t=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(a);if(t.length!=r.length)return!1;for(let r=0;r<t.length;r++){let l=t[r];if(e[l]!==a[l])return!1}return!0}function validaDatasTransmissao(){if(viagem){JSON.parse(window.localStorage.getItem("jsonMdtGrupo"));let e=0,a=0,t=0;console.log("Validando Datas na Transmissao...");for(let r of camposIdade)if(""!=r.value){if("ok"!=validaDataNascimento(r)){let e=r.parentNode.querySelector(".helper-text");return e&&e.dataset.error,r.classList.add("invalid"),!1}{let l=calculaIdade(new Date((new Date).toISOString().slice(0,10)),new Date(r.value.split("/").reverse().join("-")));console.log("Data Nasc: ",r),console.log("Idade: -> ",l),l<=70?a++:l>70&&l<=90?e++:t++,console.log("Idades Invalidas: ",t)}}if(t>0)return camposIdade.forEach(e=>{buildHelper(e,"As datas de nascimento não condizem com a faixa de idade informada para cálculo.")}),!1;let r={},l=!0;return console.log("qtdeVidas[0]: ",ofertaSelecionada.orcamento.contratantes[0].grupos[0].qtdeVidas),console.log("qtdeVidas[1]: ",ofertaSelecionada.orcamento.contratantes[0].grupos[1].qtdeVidas),console.log("AbaixoIdade: ",a),console.log("AcimaIdade: ",e),ofertaSelecionada.orcamento.contratantes[0].grupos.forEach(e=>r[e.nome]=e.qtdeVidas),l=ofertaSelecionada.orcamento.tipoSeguro&&"EDS"==ofertaSelecionada.orcamento.tipoSeguro.toUpperCase()?ofertaSelecionada.orcamento.contratantes[0].grupos[0].qtdeVidas==a||ofertaSelecionada.orcamento.contratantes[0].grupos[1].qtdeVidas==e:ofertaSelecionada.orcamento.contratantes[0].grupos[0].qtdeVidas==a&&ofertaSelecionada.orcamento.contratantes[0].grupos[1].qtdeVidas==e,l?(camposIdade.forEach(e=>{let a=e.parentNode.querySelector(".helper-text");a&&a.dataset.error,e.classList.remove("invalid")}),!0):(camposIdade.forEach(e=>{buildHelper(e,"As datas de nascimento não condizem com a faixa de idade informada para cálculo.")}),!1)}return!0}function confereCep(e,a){return e.length>0&&e.length<9||""===e?(console.log("entrou no if do cep"),"CEPCOMERCIAL"===a?(console.log("entrou no if do cep comercial"),""===e?document.getElementById("erroCepComercial").innerHTML="":document.querySelector(".logradourocom").value="",document.querySelector(".logradourocom").classList.remove("disabled"),document.querySelector(".bairrocom").value="",document.querySelector(".bairrocom").classList.remove("disabled"),document.querySelector(".cidadecom").value="",document.querySelector(".cidadecom").classList.remove("disabled"),document.querySelector(".estadocom").parentNode.querySelector("input").value="",document.querySelector(".estadocom").parentNode.parentNode.classList.remove("disabled"),!1):"CEPRESPFIN"===a?(console.log("entrou no if do cep responsavel Financeiro"),""===e?document.querySelectorAll(".erroCepMsgRespFin").innerHTML="":document.querySelector(".logradourorespfin").value="",document.querySelector(".logradourorespfin").classList.remove("disabled"),document.querySelector(".bairrorespfin").value="",document.querySelector(".bairrorespfin").classList.remove("disabled"),document.querySelector(".cidaderespfin").value="",document.querySelector(".cidaderespfin").classList.remove("disabled"),document.querySelector(".estadorespfin").parentNode.querySelector("input").value="",document.querySelector(".estadorespfin").parentNode.parentNode.classList.remove("disabled"),!1):(console.log("entrou no if do cep principal"),""===e?document.querySelectorAll(".erroCepMsg").innerHTML="":document.querySelector(".logradouro").value="",document.querySelector(".logradouro").classList.remove("disabled"),document.querySelector(".bairro").value="",document.querySelector(".bairro").classList.remove("disabled"),document.querySelector(".cidade").value="",document.querySelector(".cidade").classList.remove("disabled"),document.querySelector(".estado").parentNode.querySelector("input").value="",document.querySelector(".estado").parentNode.parentNode.classList.remove("disabled"),!1)):("CEPCOMERCIAL"===a?document.getElementById("erroCepComercial").innerHTML="":document.querySelectorAll(".erroCepMsg").innerHTML="",!0)}function email_check(e){let a=e.value.toLowerCase(),t=""!=a&&"undefined"!=a&&/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(a);return t?(e.classList.remove("invalid"),e.classList.add("valid"),resetHelper(e)):(e.classList.remove("valid"),e.classList.add("invalid"),buildHelper(e,"Email inválido")),t}function cidade_check(e){let a=e.value.toLowerCase(),t=""!=a&&"undefined"!=a&&/^[A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ ]+$/.test(a);return t?(e.classList.remove("invalid"),e.classList.add("valid"),resetHelper(e)):(e.classList.remove("valid"),e.classList.add("invalid"),buildHelper(e,"Nome de cidade Inválido")),t}function checarCepComercial(e){let a=e.querySelectorAll(".cepMask"),t=a[1]&&"CEPCOMERCIAL"==a[1].id?a[1].value:"",r=e.querySelector(".logradourocom"),l=e.querySelector(".bairrocom"),o=e.querySelector(".cidadecom"),i=e.querySelector(".estadocom");if(""==t)return r.removeAttribute("required"),l.removeAttribute("required"),o.removeAttribute("required"),void i.removeAttribute("required");r.setAttribute("required",!0),l.setAttribute("required",!0),o.setAttribute("required",!0),i.setAttribute("required",!0)}function validaCamposTransmissao(e){let a=viagem?document.querySelector("#formularioPropostaViagem"):(individual,document.querySelector("#formularioProposta"));if(a){let r;individual?(console.log("individual",individual),checarCepComercial(a),r=a.querySelectorAll(':required:not(#sexoBeneficiario):required:not(#nomeBeneficiario):required:not(#cpfBeneficiario):not(#cnpjBeneficiario):not(#grauParentescoBeneficiario):not(#nascimentoBeneficiario):not([name="imprimirApolice"]):not(#percentualBeneficio), input[name="CIENTEMOTOCICLETA"]:checked, input[name="CIENTECANCELAMENTO"]:checked, input[name="CIENTECONDICOES"]:checked')):viagem&&(console.log("viagem",viagem),r=a.querySelectorAll(':required, input[name="CIENTEMOTOCICLETA"]:checked, input[name="CIENTECANCELAMENTO"]:checked, input[name="CIENTECONDICOES"]:checked'));let l=[],o=[];console.trace("campos requeridos",r),r=Array.from(r).filter(e=>(e.required||console.log("not:",e.required,e),e.required));for(let a of r){a.value=a.value.trim();let t=["ADCDIGITOCONTA","DICIO_CICLOCOVID"];(""==a.value||"0"==a.value&&!t.includes(a.id)||"Nao"==a.value||"ADCDIGITOCONTA"==a.id&&a.value.length>1)&&l.push(a),!a.classList.contains("servico")||""==a.value||void 0!==a.dataset.valor&&""!=a.dataset.valor&&"empty"!=a.dataset.valor||l.push(a);const r=document.getElementById("cpfBeneficiario");r&&"CPF"==a.id&&"CPF"==a.name&&(validaCPFBeneficiarioJaExistente(a.value,e)||a.value==r.value?(buildHelper(a,"CPF pertencente a um beneficiário"),l.push(a)):resetHelper(a));const o=document.getElementById("cnpjBeneficiario");o&&"CNPJ"==a.id&&"CNPJ"==a.name&&(validaCNPJBeneficiarioJaExistente(a.value,e)||a.value==o.value?(buildHelper(a,"CNPJ pertencente a um beneficiário"),l.push(a)):resetHelper(a)),a.classList.contains("cpfMask")&&(validaCPF(a.value)||""==a.value||(console.log("campo cpf",a),buildHelper(a,"CPF inválido"),l.push(a))),a.classList.contains("cnpjMask")&&(validaCNPJ(a.value)||""==a.value||(console.log("campo cnpj",a),buildHelper(a,"CNPJ inválido"),l.push(a))),a.classList.contains("meiMask")&&(validaCNPJ(a.value)||(buildHelper(a,"Número de MEI inválido"),l.push(a)))}l=l.concat(l,function(){let e=document.querySelectorAll(".emailfield"),a=[];return e.forEach(e=>{if(e){let t=!1;if(e.required?0==e.value.length?(buildHelper(e,"Email não preenchido"),a.push(e),t=!0):email_check(e)||(buildHelper(e,"Email inválido"),a.push(e),t=!0):e.value.length>0&&(email_check(e)||(buildHelper(e,"Email não preenchido"),a.push(e),t=!0)),t)return;if(e.dataset.confirmation||e.dataset.destino){let t=document.querySelector("#"+e.dataset.destino),r=document.querySelector("#"+e.dataset.confirmation),l=t||r;l.value!=e.value&&(a.push(e),a.push(l),buildHelper(e,"Emails diferentes"),buildHelper(l,"Emails diferentes"))}}}),a}());let i=a.querySelectorAll("#DICIO_DATA_SAIDA, #DICIO_DATA_RETORNO");for(let e=0;e<i.length;e++){let a="ok";a=0==e?validaDataSaida(i[e]):validaDataRetorno(i[e]),"ok"!=a?(l.push(i[e]),buildHelper(i[e],a)):resetHelper(i[e])}if(camposIdade){camposIdade.forEach(e=>{let a=validaDataNascimento(e);"ok"!=a?(l.push(e),buildHelper(e,a)):resetHelper(e)}),Array(...camposIdade).every(e=>"ok"==validaDataNascimento(e))&&!validaDatasTransmissao()&&l.push(Array(...camposIdade))}let n=document.querySelectorAll("#CPF, .segurado .cpfSegurado");if(n){let e=validaCPFIgual(n);if(e)l.push(Array(...e)),e.forEach(e=>{buildHelper(e,msgErroCPFIgual),e.addEventListener("change",e=>e.target.classList.remove("invalid"))});else{document.querySelectorAll("#CPF, .segurado .cpfSegurado").forEach(e=>{let a=e.parentNode.querySelector(".helper-text");a&&a.dataset.error,e.classList.remove("invalid")})}}a.querySelectorAll('input[name="CIENTEMOTOCICLETA"], input[name="CIENTECANCELAMENTO"], input[name="CIENTECONDICOES"]').forEach(e=>{e.addEventListener("click",e=>{e.target.classList.remove("invalid");let a=e.target.closest(".col.s12").querySelector("p.message");a&&(a.innerHTML="")})});let s=document.getElementById("cardExpiry");if(s)if(""!=s.value){let e=(e=>{let a=(new Date).getFullYear().toString().slice(0,2),t=e.split("/");return t[1]=a+t[1],t=t.reverse().join("-"),t})(s.value);e.concat("-01");let a=new Date(e);var t=new Date((new Date).toISOString().slice(0,10));t.setDate(1),t.setHours(0),isNaN(a.getTime())?(buildHelper(s,"Data inválida."),l.push(s)):a<=t?(buildHelper(s,"O cartão informado deve ter data de vencimento futura."),l.push(s)):resetHelper(s)}else resetHelper(s);let d=document.getElementById("cardNumber");d&&(""!=d.value&&d.value.replace(/\s/g,"").length<13?(buildHelper(d,"O número do cartão informado deve possuir ao menos 13 dígitos."),l.push(d)):resetHelper(d));let c=document.getElementById("parc_SIM")&&document.getElementById("parc_SIM").checked,u=document.getElementsByName("RESPFINANCEIRO");if(u){if(Array(...u).some(e=>e.checked&&"Nao"==e.value)&&!c){let e=document.getElementById("CPFRESP");e&&(validaCPF(e.value)||""==e.value?verifyCPF()?viagem&&(console.log("cpf invalido 3",e),buildHelper(e,"O mesmo CPF foi adicionado para outra pessoa."),l.push(e)):resetHelper(e):(console.log("cpf invalido 2",e),buildHelper(e,"CPF inválido"),l.push(e)))}}if(displayErroTermoGuarda(""),document.querySelectorAll(".textField").forEach(e=>{if(!e.parentNode.classList.contains("hidden")&&e){let a=e.value,t=/^([A-Za-z0-9áàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ]+(\s[A-Za-z0-9áàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ])*){3,}$/;return""!=a&&"undefined"!=a&&t.test(a)?(e.classList.remove("invalid"),e.classList.add("valid"),resetHelper(e)):(e.classList.remove("valid"),e.classList.add("invalid"),buildHelper(e,"O limite minimo é de 3 caracteres e não é possivel inserir caracter especial."),l.push(e)),l}}),l.length>0){for(let e of l.flat()){if(console.log("campo: "+e.name),null!=e.name&&""!=e.name){let a=document.querySelector("label[for="+e.name+"]");console.log("campoLabel> "+a),console.log(a),null!=a&&null!=a.innerHTML&&""!=a.innerHTML&&(console.log("campo label: "+a.innerHTML),o.push("- Campo não preenchido ou preenchido incorretamente: "+a.innerHTML)),"TIPOPAGAMENTO"==e.name&&o.push("- Campo não preenchido ou preenchido incorretamente: Tipo pagamento"),"planoParcelamentos"==e.name&&o.push("- Campo não preenchido ou preenchido incorretamente: Quantidade de parcelas")}if("SELECT"==e.tagName){e.parentNode.classList.add("invalid");let a=document.createElement("label");a.classList.add("message"),e.parentNode.querySelector(".message")||e.parentNode.appendChild(a),e.addEventListener("change",e=>{e.target.parentNode.classList.remove("invalid"),resetHelper(e.target)})}else{if("CIENTEMOTOCICLETA"==e.name||"CIENTECANCELAMENTO"==e.name||"CIENTECONDICOES"==e.name){let a=e.closest(".col.s12").querySelector("p.message");a?a.innerHTML="Você deve certificar que está ciente do termo de responsabilidade acima.":(a=document.createElement("p"),a.classList.add("message"),a.innerHTML="Você deve certificar que está ciente do termo de responsabilidade acima.",e.closest(".col.s12").appendChild(a))}void 0!==e.classList&&e.classList.add("invalid"),e.addEventListener("change",e=>{e.target.classList.contains("cpfMask")||e.target.classList.contains("dataMask")||e.target.classList.remove("invalid")})}}const e=document.getElementById("modal1-div");return document.querySelectorAll('[id*="modal1-p"]').forEach(e=>{e.remove()}),errosScreenUnique=[...new Set(o)],errosScreenUnique.forEach(a=>{const t=document.createElement("p");t.id="modal1-p",t.style="align-self: self-start;",t.innerText=a+".",e.appendChild(t)}),openModal(),!1}}let r=document.querySelectorAll(".corretorFavorecido .percentagemFavorecido input");if(r&&null!=r&&r.length>0){let e=0;if(r.forEach(a=>{e+=parseInt(a.value)}),e<100){if(!document.querySelector(".warningPercentualFavorecido")){let e=document.querySelector(".section.listacorretores .section");e||(e=document.querySelector(".step.listacorretores .section"));let a=document.createElement("div");a.classList.add("col"),a.classList.add("s12"),a.classList.add("center-align"),a.classList.add("warningPercentualFavorecido"),a.innerHTML='<p class="message">O percentual dos favorecidos deve totalizar 100%</p>',e.insertBefore(a,e.querySelector(".row:last-child:not(.corretorFavorecido)"))}return!1}}let l=document.querySelectorAll('.listacorretores .row.corretorFavorecido input[type="text"]:not([disabled])'),o=!0;if([].forEach.call(l,e=>{e.classList.contains("valid")||(o=!1)}),!o)return!1;if(individual){let e=document.querySelectorAll("select.toggleBeneficiarios");if(null!=e&&null!=e){let a=!0;return e.forEach(e=>{if("Nome do beneficiário"==e.value){let e=validarPorcentagemBeneficiarios();if(!e.sucesso){document.querySelector("#tbl-beneficiarios").parentNode.querySelector(".helper-text").innerHTML="A somatória dos percentuais de indenização deve ser igual a 100%. Falta distribuir: "+e.totalPercentual+"%";a=e.sucesso}}}),a}}return!0}function validarPorcentagemBeneficiarios(){let e=document.querySelector("#tbl-beneficiarios-tbody"),a=100,t=document.querySelector("#tbl-beneficiarios"),r="";if(null!=e&&e.rows.length>0){for(let t=0;t<e.rows.length;t++)r=null!=e.rows[t].cells[3]?e.rows[t].cells[3].innerText:"",""!=r&&(a-=parseInt(r));return 0==a?(t.parentNode.querySelector(".helper-text").innerText="",{sucesso:!0,totalPercentual:a}):(t.parentNode.querySelector(".helper-text").innerHTML="A somatória dos percentuais de indenização deve ser igual a 100%. Falta distribuir: "+a+"%",{sucesso:!1,totalPercentual:a})}return t.parentNode.querySelector(".helper-text").innerText="",t.classList.remove("on"),{sucesso:!1,totalPercentual:a}}function validaCPFBeneficiarioJaExistente(e,a){return!!(""!=e&&a&&a.length>0)&&a.some(a=>a.cpfBeneficiario.replace("-","").replace(".","")==e.replace("-","").replace(".",""))}function validaCNPJBeneficiarioJaExistente(e,a){return!!(""!=cpf&&a&&a.length>0)&&a.some(a=>a.cnpjBeneficiario.replace("-","").replace(".","").replace("/","")==e.replace("-","").replace(".","").replace("/",""))}function validaDataSaida(e){let a=e.value;if(""!=a){let e=new Date(a.split("/").reverse().join("-"));return isNaN(e.getTime())?"Data inválida.":endosso?"ok":e<new Date((new Date).toISOString().slice(0,10))?"A data de saída não pode ser anterior a data de hoje.":"ok"}return""}function validaDataRetorno(e){let a=document.querySelector("#DICIO_DATA_SAIDA");if(!a)return"ok";let t=a.value,r=e.value;if(""!=r){let e=new Date(r.split("/").reverse().join("-"));return isNaN(e.getTime())?"Data inválida.":"ok"!=validaDataSaida(a)?'O campo "Data de saída" deve ser preenchido corretamente para calcular a duração da sua viagem.':e<new Date(t.split("/").reverse().join("-"))?"A data de retorno não pode ser anterior à data de saída.":"ok"}return""}function validaDataNascimento(e){let a=e.value;if(""!=a){let e=new Date(a.split("/").reverse().join("-"));if(isNaN(e.getTime()))return"Data inválida.";let t=new Date((new Date).toISOString().slice(0,10));if(e>t)return"A data de nascimento não pode ser posterior à data de hoje.";{let a=document.querySelector("#DICIO_QTD_JOVENS"),r=document.querySelector("#DICIO_QTD_IDOSOS");if(a&&r&&validaPassageirosCategoriaIdade(a)&&validaPassageirosCategoriaIdade(r)){let l=calculaIdade(t,e),o=l<=70?1:0,i=l>70&&l<=90?1:0;if(0==o&&0==i||o>a.value||i>r.value)return"A data de nascimento não condiz com a faixa de idade informada para cálculo."}return"ok"}}return""}function validaPassageirosCategoriaIdade(e){return""!=e.value&&"nulloption"!=e.value}function calculaIdade(e,a){let t=e.getFullYear()-a.getFullYear();return new Date(e.getFullYear(),e.getMonth(),e.getDate())<new Date(e.getFullYear(),a.getMonth(),a.getDate())&&t--,t}function diferencaDatas(e,a,t){return{Y:()=>new Number((a.getTime()-e.getTime())/31536e6).toFixed(0),D:()=>new Number(a.getTime()/864e5-e.getTime()/864e5).toFixed(0)}[t]()}function calcIdadeViagem(){let e=document.getElementById("DICIO_DATANASCIMENTO").value,a=0,t=null!=e&&new Date(e.split("/").reverse().join("-"));if(t){let e=Date.now()-t.getTime(),r=new Date(e);a=Math.abs(r.getUTCFullYear()-1970)}return a}function validaCPFIgual(e){let a={},t=!1;for(let r of Array(...e)){if(a[r.value]){t=Array(...e);break}a[r.value]=r.value}return t}function buildHelper(e,a){if("SELECT"==e.tagName){let t=e.parentNode.querySelector(".message");t?t.innerHTML=a:(t=document.createElement("label"),t.classList.add("message"),t.innerHTML=a,e.parentNode.appendChild(t))}else{let t=e.parentNode.querySelector(".helper-text");t?t.dataset.error=a:(t=document.createElement("span"),t.classList.add("helper-text"),t.dataset.error=a,e.parentNode.appendChild(t))}}function resetHelper(e){if("SELECT"==e.tagName){let a=e.parentNode.querySelector(".message");a&&a.remove()}else{let a=e.parentNode.querySelector(".helper-text");a&&(a.dataset.error="")}}function displayErroTermoGuarda(e){let a=document.querySelectorAll(".erro-termo-guarda");if(a&&a.length>0)for(const t of a)t.innerHTML=e}function openModal(){var e=document.getElementById("modal1");M.Modal.getInstance(e).open()}window.addEventListener("load",()=>{let e=document.querySelectorAll('select[required][id="DICIO_QTD_JOVENS"], select[required][id="DICIO_QTD_IDOSOS"]');2==e.length&&e.forEach(a=>{a.addEventListener("change",a=>{Array(...e).every(e=>"0"==e.value)?e.forEach(e=>{e.parentNode.classList.add("invalid"),buildHelper(e,"O valor de ao menos um destes campos deve ser maior do que 0.")}):e.forEach(e=>{e.parentNode.classList.remove("invalid"),resetHelper(e)})})});let a=document.querySelectorAll("#DICIO_DATA_SAIDA, #DICIO_DATA_RETORNO");for(let e=0;e<a;e++){let t="ok";a[e].addEventListener("change",r=>{t=0==e?validaDataSaida(a[e]):validaDataRetorno(a[e]),"ok"!=t?(a[e].classList.add("invalid"),buildHelper(a[e],t)):resetHelper(a[e])})}let t=viagem?document.querySelector("#formularioPropostaViagem"):document.querySelector("#formularioProposta");if(t){if(document.querySelectorAll(".emailfield").forEach(e=>{e&&e.addEventListener("blur",a=>{if(e.dataset.confirmation||email_check(e),e.dataset.confirmation||e.dataset.destino){let a=document.querySelector("#"+e.dataset.destino),t=document.querySelector("#"+e.dataset.confirmation),r=a||t;if(r.value!=e.value){if(r.classList.remove("valid"),r.classList.add("invalid"),!email_check(e))return;buildHelper(r,"Emails diferentes")}else{if(!email_check(e))return;if(!email_check(a||t))return}}})}),viagem){camposIdade=t.querySelectorAll("#DICIO_DATANASCIMENTO, .segurado .dataNascimentoSegurado"),camposIdade&&camposIdade.forEach(e=>{e.addEventListener("change",e=>{let a=validaDataNascimento(e.target);"ok"!=a?(buildHelper(e.target,a),e.target.classList.add("invalid")):(e.target.classList.remove("invalid"),resetHelper(e.target))})});let e=t.querySelectorAll("#CPF, .segurado .cpfSegurado");e.forEach(a=>{a.addEventListener("change",a=>{if(Array(...e).every(e=>""!=e.value)){if(Array(...e).every(e=>validaCPF(e.value))){return void(validaCPFIgual(e)?e.forEach(e=>{buildHelper(e,msgErroCPFIgual),e.classList.add("invalid")}):e.forEach(e=>{e.classList.remove("invalid"),resetHelper(e)}))}e.forEach(e=>{validaCPF(e.value)||""==e.value?(e.classList.remove("invalid"),resetHelper(e)):(buildHelper(e,"CPF inválido"),e.classList.add("invalid"))})}else e.forEach(e=>{validaCPF(e.value)||""==e.value?(e.classList.remove("invalid"),resetHelper(e)):(buildHelper(e,"CPF inválido"),e.classList.add("invalid"))})})});let a=t.querySelector("#CPFRESP");a&&a.addEventListener("change",e=>{validaCPF(e.target.value)||""==e.target.value?(resetHelper(e.target),e.target.classList.remove("invalid")):(console.log("cpf invalido 1",e.target),buildHelper(e.target,"CPF inválido"),e.target.classList.add("invalid"))})}}});
(function(){!function(){"use strict";if(!self.fetch){i.prototype.append=function(e,t){e=r(e),t=o(t);var n=this.map[e];n||(n=[],this.map[e]=n),n.push(t)},i.prototype.delete=function(e){delete this.map[r(e)]},i.prototype.get=function(e){var t=this.map[r(e)];return t?t[0]:null},i.prototype.getAll=function(e){return this.map[r(e)]||[]},i.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},i.prototype.set=function(e,t){this.map[r(e)]=[o(t)]},i.prototype.forEach=function(e){var t=this;Object.getOwnPropertyNames(this.map).forEach((function(n){e(n,t.map[n])}))};var e="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),t="FormData"in self,n=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.call(c.prototype),f.call(h.prototype),self.Headers=i,self.Request=c,self.Response=h,self.fetch=function(t,n){var r;return r=c.prototype.isPrototypeOf(t)&&!n?t:new c(t,n),new Promise((function(t,n){var o=new XMLHttpRequest;"cors"===r.credentials&&(o.withCredentials=!0),o.onload=function(){var e=1223===o.status?204:o.status;if(e<100||e>599)n(new TypeError("Network request failed"));else{var r={status:e,statusText:o.statusText,headers:d(o),url:"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0},i="response"in o?o.response:o.responseText;t(new h(i,r))}},o.onerror=function(){n(new TypeError("Network request failed"))},o.open(r.method,r.url,!0),"responseType"in o&&e&&(o.responseType="blob"),r.headers.forEach((function(e,t){t.forEach((function(t){o.setRequestHeader(e,t)}))})),o.send(void 0===r._bodyInit?null:r._bodyInit)}))},self.fetch.polyfill=!0}function r(e){if("string"!=typeof e&&(e=e.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=e.toString()),e}function i(e){this.map={};var t=this;e instanceof i?e.forEach((function(e,n){n.forEach((function(n){t.append(e,n)}))})):e&&Object.getOwnPropertyNames(e).forEach((function(n){t.append(n,e[n])}))}function s(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function u(e){var t=new FileReader;return t.readAsArrayBuffer(e),a(t)}function f(){return this.bodyUsed=!1,this._initBody=function(n){if(this._bodyInit=n,"string"==typeof n)this._bodyText=n;else if(e&&Blob.prototype.isPrototypeOf(n))this._bodyBlob=n;else if(t&&FormData.prototype.isPrototypeOf(n))this._bodyFormData=n;else{if(n)throw new Error("unsupported BodyInit type");this._bodyText=""}},e?(this.blob=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(u)},this.text=function(){var e,t,n=s(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,(t=new FileReader).readAsText(e),a(t);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var e=s(this);return e||Promise.resolve(this._bodyText)},t&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(e,t){var r,o;if(t=t||{},this.url=e,this.credentials=t.credentials||"omit",this.headers=new i(t.headers),this.method=(r=t.method||"GET",o=r.toUpperCase(),n.indexOf(o)>-1?o:r),this.mode=t.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&t.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(t.body)}function l(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}})),t}function d(e){var t=new i;return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){var n=e.trim().split(":"),r=n.shift().trim(),o=n.join(":").trim();t.append(r,o)})),t}function h(e,t){t||(t={}),this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof i?t.headers:new i(t.headers),this.url=t.url||""}}(),function(e,t){"use strict";if(!e.setImmediate){var n,r,o,i,s,a=1,u={},f=!1,c=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?n=function(){var e=d(arguments);return process.nextTick(h(p,e)),e}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(){var e=d(arguments);return o.port2.postMessage(e),e}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,n=function(){var e=d(arguments),t=c.createElement("script");return t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t),e}):n=function(){var e=d(arguments);return setTimeout(h(p,e),0),e}:(i="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&p(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(){var t=d(arguments);return e.postMessage(i+t,"*"),t}),l.setImmediate=n,l.clearImmediate=y}function d(e){return u[a]=h.apply(void 0,e),a++}function h(e){var t=[].slice.call(arguments,1);return function(){"function"==typeof e?e.apply(void 0,t):new Function(""+e)()}}function p(e){if(f)setTimeout(h(p,e),0);else{var t=u[e];if(t){f=!0;try{t()}finally{y(e),f=!1}}}}function y(e){delete u[e]}}(new Function("return this")()),function(e){"use strict";var t="[[PromiseStatus]]",n="[[PromiseValue]]",r=e.setImmediate||require("timers").setImmediate,o=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};function i(e){this["[[OriginalError]]"]=e}function s(e){return e instanceof i}function a(e){return"function"==typeof e}function u(e){return e instanceof w}function f(e){return e}function c(e){throw e}function l(e){delete e["[[OnFulfilled]]"],delete e["[[OnRejected]]"]}function d(e){var t,n=e.length;for(t=0;t<n;t++)e[t]()}function h(e,t,n){var r=p(n);u(r)?r.then(e,t):s(r)?t(r["[[OriginalError]]"]):e(n)}function p(e){var t;if(u(e))return e;if(function(e){return Object(e)===e}(e)){try{t=e.then}catch(e){return new i(e)}if(a(t))return new w((function(n,o){r((function(){try{t.call(e,n,o)}catch(e){o(e)}}))}))}return null}function y(e,r){function o(n){"pending"==e[t]&&m(e,n)}try{r((function(r){"pending"==e[t]&&function e(r,o){var i,a=p(o);u(a)?(r[t]="internal pending",a.then((function(t){e(r,t)}),(function(e){m(r,e)}))):s(a)?m(r,a["[[OriginalError]]"]):(r[t]="fulfilled",r[n]=o,(i=r["[[OnFulfilled]]"])&&i.length&&(l(r),d(i)))}(e,r)}),o)}catch(e){o(e)}}function m(e,r){var o=e["[[OnRejected]]"];e[t]="rejected",e[n]=r,o&&o.length&&(l(e),d(o))}function w(e){if(!u(this))throw new TypeError('constructor Promise requires "new".');this[t]="pending",this[n]=void 0,y(this,e)}w.prototype.then=function(e,o){var i,s=this;return e=a(e)?e:f,o=a(o)?o:c,i=new w((function(a,u){function f(e){var t;try{t=e(s[n])}catch(e){return void u(e)}t===i?u(new TypeError("then() cannot return same Promise that it resolves.")):h(a,u,t)}function c(){r(f,e)}function l(){r(f,o)}switch(s[t]){case"fulfilled":c();break;case"rejected":l();break;default:!function(e,t,n){e["[[OnFulfilled]]"]||(e["[[OnFulfilled]]"]=[],e["[[OnRejected]]"]=[]),e["[[OnFulfilled]]"].push(t),e["[[OnRejected]]"].push(n)}(s,c,l)}}))},w.prototype.catch=function(e){return this.then(f,e)},w.resolve=function(e){var t=p(e);return u(t)?t:new w((function(n,r){s(t)?r(t["[[OriginalError]]"]):n(e)}))},w.reject=function(e){return new w((function(t,n){n(e)}))},w.race=function(e){return new w((function(t,n){var r,i;if(o(e))for(i=e.length,r=0;r<i;r++)h(t,n,e[r]);else n(new TypeError("not an array."))}))},w.all=function(e){return new w((function(t,n){var r,i,a,f,c=0,l=0;if(o(e)){for(i=(e=e.slice(0)).length,f=0;f<i;f++)u(r=p(a=e[f]))?(l++,r.then(function(n){return function(r){e[n]=r,++c==l&&t(e)}}(f),n)):s(r)?n(r["[[OriginalError]]"]):e[f]=a;l||t(e)}else n(new TypeError("not an array."))}))},"undefined"!=typeof module&&module.exports?module.exports=e.Promise||w:e.Promise||(e.Promise=w)}(this)}).call("object"==typeof window&&window||"object"==typeof self&&self||"object"==typeof global&&global||{});