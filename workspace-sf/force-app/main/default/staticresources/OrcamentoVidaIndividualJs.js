function addData(){document.getElementById("input-screen-1-id-1-DICIO_NOME").addEventListener("keyup",(function(e){const o=e.target.value,I=[];"massa_testeCZE"===o?I.push({id:"DICIO_NOME",conteudo:"CZESXWQ VAN DAS QWERTY"},{id:"DICIO_DATANASCIMENTO",conteudo:"1997-09-19"}):"massa_testeJYM"===o?I.push({id:"DICIO_NOME",conteudo:"JYMME WWWEDRFCX ASXCVOPLMN"},{id:"DICIO_DATANASCIMENTO",conteudo:"1990-04-21"}):"massa_testeFRA"===o&&I.push({id:"DICIO_NOME",conteudo:"Francis Liu"},{id:"DICIO_DATANASCIMENTO",conteudo:"1964-05-22"}),I.length>0&&(I.push({id:"DICIO_SEXO",conteudo:"MASCULINO"},{id:"DICIO_FUMANTE",conteudo:"NAO"},{id:"DICIO_PROFISSAO",conteudo:"2111-05"},{id:"DICIO_REGIME_TRABALHO",conteudo:"CLT"},{id:"DICIO_RENDA",conteudo:"2500"},{id:"DICIO_DEPENDENTES",conteudo:!0},{id:"DICIO_CICLOCOVID",conteudo:"1"},{id:"DICIO_AGENCIAMENTO",conteudo:"0"},{id:"DICIO_CORRETAGEM",conteudo:"30"}),autoCompleteScreen1("auto",JSON.stringify(I)))}))}function addFieldsBudget(e){const o=JSON.parse(e),I=[];o.length>0&&(I.push({id:"DICIO_NOME",conteudo:o[0].nome},{id:"DICIO_DATANASCIMENTO",conteudo:o[0].datanascimento.substr(0,10)},{id:"DICIO_SEXO",conteudo:o[0].sexo.toUpperCase()},{id:"DICIO_FUMANTE",conteudo:removeAccents(o[0].fumante.toUpperCase())},{id:"DICIO_PROFISSAO",conteudo:o[0].profissao},{id:"DICIO_REGIME_TRABALHO",conteudo:o[0].regimetrabalho},{id:"DICIO_RENDA",conteudo:o[0].renda},{id:"DICIO_DEPENDENTES",conteudo:o[0].dependentes},{id:"DICIO_CICLOCOVID",conteudo:o[0].ciclocovid},{id:"DICIO_AGENCIAMENTO",conteudo:o[0].agenciamento},{id:"DICIO_CORRETAGEM",conteudo:o[0].corretagem}),console.log("arrObj",I),autoCompleteScreen1("auto",JSON.stringify(I)))}
const goToOfertasScreen=()=>console.log(),goToPersolanizarScreen=()=>console.log(),goToStartScreen=()=>console.log();function loadBtnPagePersonalizar(){const e=document.getElementById("btn2");e.setAttribute("onclick","backToStart()"),e.classList.add("btn","waves-effect","waves-light","blue"),e.innerText="← Voltar";const t=document.getElementById("btn1");t.setAttribute("onclick","validateFormScreen2()"),t.classList.add("btn","waves-effect","waves-light","blue"),t.innerText="Salvar personalização →";document.getElementById("btn3").classList.add("hide");document.getElementsByClassName("row");console.log("listRows => ");const n=document.getElementById("ofertasRow");n&&n.remove(),cards=[]}function backToStart(){window.localStorage.removeItem("jsonResponseCalculo"),backToFormScreen1();const e=document.getElementById("btn2");e.setAttribute("onclick","validateFormScreen1(true)"),e.innerText="Personalizar oferta";const t=document.getElementById("btn1");t.setAttribute("onclick","validateFormScreen1()"),t.innerText="Exibir ofertas";const n=document.getElementById("btn3");n.setAttribute("onclick","validateFormScreen1(true,true)"),n.innerText="Exibir combos",n.classList.remove("hide");const a=document.getElementById("ofertasRow");a&&a.remove(),cards=[],coveragePackage=[],requiredList=[]}function loadPageOferta(e){if(e){const e=document.getElementById("btn3");e.setAttribute("onclick","backToStart()"),e.classList.add("btn","waves-effect","waves-light","blue"),e.innerText="← Voltar";const t=document.getElementById("btn2");t.setAttribute("onclick","callFormScreen2()"),t.classList.add("btn","waves-effect","waves-light","blue"),t.innerText="Personalizar oferta";const n=document.getElementById("btn1");n.setAttribute("onclick","getCardSelected()"),n.innerText="Proposta →",e.classList.remove("hide")}else{const e=document.getElementById("btn3");e.setAttribute("onclick","showScreenPersonalizar()"),e.classList.add("btn","waves-effect","waves-light","blue"),e.innerText="← Voltar";const t=document.getElementById("btn2");t.setAttribute("onclick","showScreenPersonalizar()"),t.classList.add("btn","waves-effect","waves-light","blue"),t.innerText="Personalizar oferta";const n=document.getElementById("btn1");n.setAttribute("onclick","getCardSelected()"),n.innerText="Proposta →",e.classList.remove("hide"),document.getElementById("form-screen-2-pacotes").classList.add("hide"),document.getElementById("form-screen-2-personalizar").classList.add("hide"),document.getElementById("screen2-tab-form").classList.add("hide")}}function showScreenPersonalizar(){loadBtnPagePersonalizar(),document.getElementById(lastTab).classList.remove("hide");const e=document.getElementById("screen2-tab-form");e&&e.classList.remove("hide"),pageRef=2,stepNumber=2,stepPage="Personalizar Oferta",nextPage="Ofertas";const t=document.getElementById("pageSubtitle");t&&t.classList.add("hide"),currentPageNumber=document.getElementById("currentPageNumber"),currentPageNumber&&(currentPageNumber.innerText=pageRef),currentPageIndicator=document.getElementById("currentPageIndicator"),currentPageIndicator&&(currentPageIndicator.innerText=stepPage),nextPageIndicator=document.getElementById("nextPageIndicator"),nextPageIndicator&&(nextPageIndicator.innerText=nextPage),document.getElementById("rectangle-1").classList.remove("currentRectangle"),document.getElementById("rectangle-1").classList.add("previusRectangle"),document.getElementById("rectangle-2").classList.remove("nextRectangle"),document.getElementById("rectangle-2").classList.add("currentRectangle");const n=document.getElementById("ofertasRow");n&&n.remove(),cards=[]}function getCardSelected(){let e;document.querySelector('[class*="card-div-selected"]')?(e=document.querySelector('[class*="card-div-selected"]').id.split("-").pop(),window.localStorage.setItem("ofertaSelecionada",e),window.localStorage.setItem("chamouProposta",!0),redirecionarTela(),enableSpinner()):showModal("Selecione uma oferta para continuar.")}function loadPreviusState(){"true"==window.localStorage.getItem("chamouProposta")&&(loadScreenOffers(),goToPageOfertas(),hideScreen1(),loadPageOferta(!0))}function showModal(e){const t=document.getElementById("modal1-div");document.querySelectorAll('[id*="modal1-p"]').forEach(e=>{e.remove()});const n=document.createElement("p");n.id="modal1-p",n.innerText=e,t.appendChild(n),openModal()}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementsByClassName("fixed-action-btn-bar")[0],t=document.createElement("button");t.setAttribute("type","button"),t.setAttribute("name","action"),t.setAttribute("onclick","validateFormScreen1(true,true)"),t.id="btn3",t.classList.add("btn","waves-effect","waves-light","blue"),t.innerText="Exibir combos",e.appendChild(t);const n=document.createElement("button");n.setAttribute("type","button"),n.setAttribute("name","action"),n.setAttribute("onclick","validateFormScreen1(true)"),n.id="btn2",n.classList.add("btn","waves-effect","waves-light","blue"),n.innerText="Personalizar oferta",e.appendChild(n);const a=document.createElement("button");a.setAttribute("type","button"),a.setAttribute("name","action"),a.setAttribute("onclick","validateFormScreen1()"),a.id="btn1",a.classList.add("btn","waves-effect","waves-light","blue"),a.innerText="Exibir ofertas",e.appendChild(a)}));
let conjuntosJson,pageTitle,currentPageNumber,currentPageIndicator,nextPageIndicator,pageSubtitle,listaServicos=[],pageRef=1,titlePageText="Vida do seu jeito",stepNumber=1,stepPage="Perfis",nextPage="Ofertas";const datePattern="^([0-2][0-9]|(3)[0-1])(\\/)(((0)[0-9])|((1)[0-2]))(\\/)\\d{4}$";let screen1FormValue;function assambleScreen1(){const e=JSON.parse(window.localStorage.getItem("conjuntosJson")).conjuntos[0];let t=document.getElementById("form-screen-1");pageTitle=document.getElementById("pageTitle"),pageTitle.innerText=e.titulo,pageSubtitle=document.getElementById("pageSubtitle"),pageSubtitle.innerText=e.subtitulo,currentPageNumber=document.getElementById("currentPageNumber"),currentPageNumber.innerText=e.id,currentPageIndicator=document.getElementById("currentPageIndicator"),currentPageIndicator.innerText=stepPage,nextPageIndicator=document.getElementById("nextPageIndicator"),nextPageIndicator.innerText=nextPage,createDivRows(e.id,Math.ceil(e.informacoes.length/3),t,"");let o=splitArrayIntoSubarrays(e.informacoes,Math.ceil(e.informacoes.length/3));console.log("splitedFormFields: ",o),o.forEach((e,t)=>{e.forEach(e=>{createFormElements(e,t+1,1,e.ordem,"")})}),setupChboxNomeSocial(),checkCPFBCP(),callServicos(JSON.stringify(listaServicos))}function createDivRows(e,t,o,n){for(let a=1;a<=t;a++){let t=document.createElement("div"),r="row",i="div-screen-"+e+"-id-"+a+n;t.className=r,t.id=i,o.appendChild(t)}}function createFormElements(e,t,o,n,a){const r=document.getElementById(`div-screen-${o}-id-${t}${a}`);if(!r)return void console.error(`Div not found: div-screen-${o}-id-${t}`);o>=3&&"RequiredFields"!=a&&(r.hasAttribute("hidden")||(r.setAttribute("hidden","hidden"),r.setAttribute("package",a)));let i=createDivWithClass("col s4",`div-input-screen-${o}-id-${n}`);r.appendChild(i),e.servico&&montarListaServicos(e),"Texto"===e.tipo||"Opções de servico"===e.tipo?createInputField(i,e,o,n):"Data"===e.tipo?createDateInputField(i,e,o,n):"Opções fixas"===e.tipo?createSelectField(i,e,o,n):"Radiobutton"===e.tipo?createRadioButtons(i,e,o,n,"Não"):"Número inteiro"===e.tipo||"Dia(s)"===e.tipo?createNumberInputField(i,e,o,n):"Monetário"===e.tipo?createSelectFieldScreen2(i,e,o,n):(console.log("Unsupported type: "+e.tipo),0==e.opcoes.length?createInputField(i,e,o,n):createSelectField(i,e,o,n));let s=document.querySelectorAll(".tooltipped");if(s.length>0){M.Tooltip.init(s)}let l=document.querySelectorAll("select");l.length>0&&M.FormSelect.init(l)}function createDivWithClass(e,t){const o=document.createElement("div");return o.className=e,o.id=t,o}function createInputField(e,t,o,n){const a=createInputElement("text",t,o,n);let r,i;if("DICIO_NOME"==t.id){r=document.createElement("p"),r.classList.add("pnomesocial");const e=document.createElement("label"),t=document.createElement("input");t.setAttribute("type","checkbox"),t.setAttribute("id","cboxnomesocial"),t.classList.add("filled-in");let o=document.createElement("span"),n=document.createElement("a");n.classList.add("tooltipped"),n.setAttribute("data-position","bottom"),n.setAttribute("data-tooltip","Nome social é o nome pelo qual a pessoa travesti ou trans se identifica e é socialmente reconhecida");let i=document.createElement("i");i.classList.add("tiny"),i.classList.add("material-icons"),i.innerText="info",o.innerText="Cliente tem nome social",e.appendChild(t),e.appendChild(o),n.appendChild(i),e.appendChild(n),r.append(e),a.addEventListener("input",e=>{e.target.value.match(/[0-9]/g)&&(e.target.value=e.target.value.replace(/[0-9]/g,""))})}"DICIO_NOMESOCIAL"==t.id&&(e.classList.add("inputnomesocial"),e.classList.add("hide"),i=document.createElement("span"),i.classList.add("helper-text"),i.classList.add("helpernsocial"),i.innerHTML='<i class="tiny material-icons">info</i>O nome social será utilizado para identificar o(a) cliente Porto. Como Corretor(a), é sua responsabilidade incluir as alterações necessárias em  apólices, documentos, contratos vigentes e equivalentes.'),e.classList.add("input-field"),e.appendChild(a),e.appendChild(createLabel(a.id,t.nome)),t.obrigatorio&&e.appendChild(createErrorDiv(t.id)),"DICIO_NOME"==t.id&&r&&e.appendChild(r),"DICIO_NOMESOCIAL"==t.id&&i&&e.appendChild(i)}function disableLabel(e){if(e){e.querySelectorAll("label").forEach((function(e){e.classList.remove("active")}))}}function createInputElement(e,t,o,n,a=""){const r=document.createElement("input");return r.type=e,r.id=`input-screen-${o}-id-${n}-${t.id}`,r.classList.add("screen"+o),r.setAttribute("name",a),r.setAttribute("required",t.obrigatorio?"true":""),t.obrigatorio&&r.classList.add("validate"),r}function createDateInputField(e,t,o,n){e.classList.add("input-field"),e.appendChild(createDateIcon());const a=createInputElement("text",t,o,n);a.classList.add("data","screen1"),a.setAttribute("pattern",datePattern),a.oninput=function(){formatInput(a),validateDate(a)},e.appendChild(a),e.appendChild(createLabel(a.id,t.nome)),t.obrigatorio&&e.appendChild(createErrorDiv(t.id))}function createErrorDiv(e){const t=document.createElement("div");return t.classList.add("error-text","red-text"),t.id="error-"+e,t}function createLabel(e,t,o=null){const n=document.createElement("label");if(n.setAttribute("for",e),n.innerText=t,o){const e=document.createElement("i");e.classList.add("tiny","material-icons","tooltipped"),e.classList.add("help-icon"),e.textContent="help",e.setAttribute("data-position","right"),e.setAttribute("data-tooltip",o),n.appendChild(e)}return n}function createDateIcon(){const e=document.createElement("i");return e.className="material-icons suffix",e.innerHTML="date_range",e}function createSelectField(e,t,o,n){const a=document.createElement("select");a.id=`select-screen-${o}-id-${n}-${t.id}`,a.classList.add("screen"+o),a.setAttribute("sigla",t.id),a.setAttribute("required",t.obrigatorio?"true":""),t.obrigatorio&&a.classList.add("validate"),e.classList.add("input-field"),e.appendChild(a);const r=createOptionElement("nulloption","Não selecionado");r.id=a.id+"-option-id-0",r.setAttribute("selected","true"),r.setAttribute("disabled","true"),a.appendChild(r),t.opcoes.forEach((e,t)=>{const o=createOptionElement(e.codigo,e.rotulo);o.id=`${a.id}-option-id-${t+1}`,a.appendChild(o)}),e.appendChild(createLabel(a.id,t.nome)),t.obrigatorio&&e.appendChild(createErrorDiv(t.id))}function createOptionElement(e,t){const o=document.createElement("option");return o.setAttribute("value",e),o.innerHTML=t,o}function createRadioButtons(e,t,o,n,a=null){const r=document.createElement("p");r.innerHTML=t.nome,r.classList.add("title-field"),e.appendChild(r),t.opcoes.forEach((r,i)=>{const s=createLabelElement(`input-screen-${o}-id-${n}-label-id-${i+1}`);e.appendChild(s);const l=createInputElement("radio",t,o,n,t.id);l.value=r.codigo,console.log("option.codigo => "+r.codigo),a===r.rotulo?l.setAttribute("checked",!0):l.removeAttribute("checked"),s.appendChild(l);const c=document.createElement("span");c.innerHTML=r.rotulo,s.appendChild(c)})}function createLabelElement(e){const t=document.createElement("label");return t.id=e,t}function createNumberInputField(e,t,o,n){const a=createInputElement("number",t,o,n);if(a.setAttribute("sigla",t.id),a.setAttribute("min","0"),a.addEventListener("keypress",e=>{8!==e.charCode&&0!==e.charCode&&(e.charCode<48||e.charCode>57)&&e.preventDefault()}),null!=t.limiteMaximo&&a.setAttribute("max",t.limiteMaximo),e.classList.add("input-field"),e.appendChild(a),e.appendChild(createLabel(a.id,t.nome)),t.obrigatorio){let n=1!=o&&["DIT-Franquia","DIH-Dias"].includes(t.id)?t.id+o:t.id;e.appendChild(createErrorDiv(n))}}function splitArrayIntoSubarrays(e,t,o=0){if(t<=0)throw new Error("Number of subarrays should be greater than 0.");const n=[],a=e.length>6?Math.ceil(e.length/t):0!==o?o:3;for(let o=0;o<t;o++)n.push(e.splice(0,a));return n}function inicializaDatepicker(){let e=document.querySelectorAll(".datepicker");M.Datepicker.init(e,{format:"dd/mm/yyyy",language:"pt-BR",yearRange:90,maxDate:new Date,i18n:{weekdays:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],weekdaysShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],weekdaysAbbrev:["D","S","T","Q","Q","S","S"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthsShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],cancel:"Cancelar",clear:"Limpar",done:"Ok"}})}function setupChboxNomeSocial(){const e=document.getElementById("cboxnomesocial");var t=document.querySelector("#modalnomesocial"),o=M.Modal.init(t);e.addEventListener("change",(function(){const t=document.querySelector(".input-field.inputnomesocial");this.checked?o.open():(t.firstElementChild.value="",t.classList.add("hide"));document.getElementById("modalNomeSocialSim").addEventListener("click",(function(){t.classList.remove("hide"),o.close(),t.firstElementChild.focus()}));document.getElementById("modalNomeSocialNao").addEventListener("click",(function(){e.checked=!1,t.classList.add("hide"),o.close()}))}))}function checkCPFBCP(){const e=document.querySelector('[id*="CPF"]');if(null!=e&&null!=e){let t=createErrorDiv(e.id);e.addEventListener("keyup",(function(){e.value=e.value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/g,"$1.$2.$3-$4")})),e.addEventListener("blur",(function(){let o=e.value,n=[];Visualforce.remoting.Manager.invokeAction(controllerConsultaCPF,o,o=>{if(resultConsultaCPF=JSON.parse(o.replace(/&quot;/g,'"')),"Não encontrado"!=resultConsultaCPF.nomeCompleto){let e=checkGender(resultConsultaCPF.sexo);n.push({id:"DICIO_NOME",conteudo:resultConsultaCPF.nomeCompleto},{id:"DICIO_DATANASCIMENTO",conteudo:resultConsultaCPF.dataNascimento},{id:"DICIO_SEXO",conteudo:e}),autoCompleteScreen1("auto",JSON.stringify(n)),t.textContent=""}else t.textContent="CPF não encontrado. Preencha os dados adicionais.";fieldsCPFBlock(n),e.parentElement.appendChild(t)})}))}}function checkGender(e){return"m"===e.toLowerCase()?"MASCULINO":"FEMININO"}function fieldsCPFBlock(e){let t=document.querySelectorAll(".screen1"),o=document.querySelectorAll(".error-text");t.forEach(t=>{void 0!==e&&e.length>0?e.forEach(e=>{t.id.includes(e.id)&&!t.id.includes("DICIO_NOMESOCIAL")&&("SELECT"===t.tagName?(t.previousElementSibling.previousElementSibling.previousElementSibling.setAttribute("disabled",!0),t.previousElementSibling.previousElementSibling.previousElementSibling.classList.remove("invalid")):(t.setAttribute("disabled",!0),t.classList.remove("invalid")))}):"SELECT"===t.tagName?t.previousElementSibling.previousElementSibling.previousElementSibling.removeAttribute("disabled"):t.removeAttribute("disabled")}),o.forEach(t=>{void 0!==e&&e.length>0&&e.forEach(e=>{(t.id.includes(e.id)&&!t.id.includes("DICIO_NOMESOCIAL")||t.id.includes("CPF"))&&(t.textContent="")})})}function validateFormScreen1(e=!1,t=!1){isComboPersonalizar=t,isPersonalizar=e;const o=document.querySelectorAll(".validate"),n=document.querySelectorAll(".error-text");let a=0;o.forEach((e,t)=>{const o=n[a];"radio"===e.type||(e.value&&"nulloption"!=e.value&&""!=e.value?(o.textContent="",a+=1):(o.textContent="Campo obrigatório.",a+=1))}),validateFields();Array.from(n).some(e=>""!==e.textContent)||geraJsonComRespostas()}function validateFields(){assambleScreen1FormAwsers();document.querySelectorAll(".screen1").forEach(e=>{if("SELECT"===e.tagName)screen1FormValue.forEach((t,o,n)=>{e.id.includes(o)&&screen1FormValue.set(o,e.value)});else if("INPUT"===e.tagName)if("radio"===e.type&&e.checked)screen1FormValue.forEach((t,o,n)=>{e.id.includes(o)&&screen1FormValue.set(o,"true"===e.value)});else if("radio"!==e.type)if(e.className.includes("data")&&isDateValid(e.value))document.querySelector(`[id*="error-${e.id.split("-").at(-1)}"]`).textContent="",screen1FormValue.forEach((t,o,n)=>{e.id.includes(o)&&screen1FormValue.set(o,e.value.split("/").reverse().join("-"))});else if(e.className.includes("data")&&!isDateValid(e.value))document.querySelector(`[id*="error-${e.id.split("-").at(-1)}"]`).textContent="Data inválida.";else if(e.id.includes("DICIO_PROFISSAO")){const t=JSON.parse(window.localStorage.getItem("jsonServicos")).DICIO_PROFISSAO.itens.find(t=>t.rotulo===e.value);screen1FormValue.set("6-DICIO_PROFISSAO",t?t.codigo:null),screen1FormValue.get("6-DICIO_PROFISSAO")?document.querySelector('[id*="error-DICIO_PROFISSAO"]').textContent="":document.querySelector('[id*="error-DICIO_PROFISSAO"]').textContent="Ocupação profissional inválida"}else screen1FormValue.forEach((t,o,n)=>{e.id.includes(o)&&screen1FormValue.set(o,e.value)})}),console.log("Gio -> Screen1FormValue ->",screen1FormValue)}function assambleScreen1FormAwsers(){screen1FormValue=new Map;const e=JSON.parse(window.localStorage.getItem("conjuntosJson")).conjuntos[0];console.log("Danilo conjuntos.informacoes: "),console.log(JSON.stringify(e.informacoes)),e.informacoes.forEach(e=>screen1FormValue.set(e.ordem+"-"+e.id,null))}function isDateValid(e){if(!/^(\d{2})\/(\d{2})\/(\d{4})$/.test(e))return!1;const t=e.split("/"),o=parseInt(t[0],10),n=parseInt(t[1],10),a=parseInt(t[2],10),r=new Date;return new Date(a,n-1,o)<=r}function validateDate(){var e=document.getElementById("dateInput"),t=document.querySelector(".error-text");isDateValid(e.value)?t.textContent="":t.textContent="Please enter a valid date (dd/mm/yyyy) that is today or before."}function inicializaServicos(){const e=new URLSearchParams(window.location.search);if(disabledSpinner(),document.querySelector("#jsonServicos")&&""!=document.querySelector("#jsonServicos").value){let e;e=window.localStorage.getItem("jsonServicos")?Object.assign(JSON.parse(window.localStorage.getItem("jsonServicos")),JSON.parse(document.querySelector("#jsonServicos").value)):JSON.parse(document.querySelector("#jsonServicos").value),window.localStorage.setItem("jsonServicos",JSON.stringify(e))}preencherCamposServico();const t=!0;JSON.parse(e.get("dados")).consultivo.nProposta?(callReutilizarDados(),t=!1):JSON.parse(e.get("dados")).consultivo.portalAdm?checkOrcamento():JSON.parse(e.get("dados")).consultivo.fieldsBudget?addFieldsBudget(atob(JSON.parse(e.get("dados")).consultivo.fieldsBudget)):autoCompleteScreen1(),t&&window.localStorage.removeItem("dadosProposta"),loadPreviusState()}function preencherCamposServico(){null!==window.localStorage.getItem("jsonServicos")&&createAutoCompletePage()}function createAutoCompletePage(){1==pageRef&&initAutoComplete(document.querySelector('[id*="DICIO_PROFISSAO"]'),"DICIO_PROFISSAO")}function initAutoComplete(e,t){const o=JSON.parse(localStorage.getItem("jsonServicos"))[t].itens;M.Autocomplete.init(e,{data:o.reduce((e,t)=>(e[t.rotulo]=null,e),{}),minLength:1,onAutocomplete:function(t){e.rotulo=t}}),e.addEventListener("input",(function(){var e=this.value.toLowerCase();o.filter(t=>t.rotulo.toLowerCase().includes(e)).map(e=>`<li><span>${e.rotulo}</span></li>`).join("")}))}function montarListaServicos(e){listaServicos.push({id:e.id,servico:e.servico,body:null,metodo:"GET"});listaServicos.push({id:"ADCBANCO",servico:"Consulta_Banco",body:JSON.stringify({bancosConveniados:"true"}),metodo:"POST"}),listaServicos.push({id:"PAISRESIDENTE",servico:"paises",body:null,metodo:"GET"})}function orderConjuntosJson(){const e=JSON.parse(window.localStorage.getItem("conjuntosJson")),t=e.conjuntos[0];console.log(t.informacoes),t.informacoes=t.informacoes.sort((e,t)=>e.ordem-t.ordem),t.informacoes.opcoes=t.informacoes.map(e=>e.opcoes.sort((e,t)=>e.ordem-t.ordem)),e.conjuntos[0]=t,window.localStorage.setItem("conjuntosJson",JSON.stringify(e))}function formatInput(e){var t=e.value.replace(/\D/g,""),o="";t.length>0&&(o+=t.substring(0,2),t.length>=3&&(o+="/"+t.substring(2,4)),t.length>=5&&(o+="/"+t.substring(4,8))),e.value=o}function validateDate(e){e.setCustomValidity("")}function geraJsonComRespostas(){let e=new URLSearchParams(window.location.search);console.log("Dados Url: "+e.get("dados"));const t=JSON.parse(e.get("dados"));window.localStorage.setItem("entradaConsultivo",JSON.stringify(t));const o=t.consultivo,n={orcamento:null,consultivo:{codigoOfertaConsultiva:o.codigoOfertaConsultiva,canalDistribuicao:o.canalDistribuicao,identificadorRepresentante:o.identificadorRepresentante,meioComercializacao:o.entradaNegocio}};n.consultivo.respostas=[{id:"DICIO_TEMPO_PROTECAO",conteudo:"48"},{id:"TIPOCONTRATO",conteudo:"VOCE"}],console.log("Danilo screen1FormValue :"),console.log([...screen1FormValue.entries()]),screen1FormValue.forEach((e,t,o)=>{const a=t.split("-");n.consultivo.respostas.push({id:a[1],conteudo:e})}),window.localStorage.setItem("jsonEntradaCalculo",JSON.stringify(n)),callPagOfertas(JSON.stringify(n)),enableSpinner(!0)}function geraProdutos(e,t,o=!1){console.log("salvarLocalStorage => "+e),console.log("portalAdmNode => "+t),console.log("isOfertaPersonalizada => "+o),console.log(o?document.querySelector("#OfertaPersonalizada").value:document.querySelector("#Ofertas").value),window.localStorage.setItem("dadosUsuario",JSON.stringify(JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")).consultivo.respostas));let n=o?document.querySelector("#OfertaPersonalizada").value:document.querySelector("#Ofertas").value,a=JSON.parse(n);if(a.codigo){const e=document.getElementById("modal1-div");document.querySelectorAll('[id*="modal1-p"]').forEach(e=>{e.remove()}),a.message.split(".").forEach(t=>{const o=document.createElement("p");o.id="modal1-p",o.style="align-self: self-start;",o.innerText=`- ${t}.`,e.appendChild(o)}),disabledSpinner(),openModal()}else if(a.ofertas[0].retornoAceitacao.recusas.length>0){const e=a.ofertas[0].retornoAceitacao.recusas,t=document.getElementById("modal1-div");document.querySelectorAll('[id*="modal1-p"]').forEach(e=>{e.remove()}),e.forEach(e=>{const o=document.createElement("p");o.id="modal1-p",o.style="align-self: self-start;",o.innerText="- "+e.mensagens.cliente,t.appendChild(o)}),disabledSpinner(),openModal()}else a.ofertas.length>0&&(disabledSpinner(),a.ofertas.forEach((e,t)=>{e.regras&&e.regras.coberturas&&"INDIVIDUAL"==e.orcamento.segmento.toUpperCase()&&e.regras.coberturas.forEach(e=>{"IPA"==e.sigla&&(e.nome+=" Plus")})}),n=JSON.stringify(a),window.localStorage.setItem("jsonResponseCalculo",n),console.log("Inicial: ",n),console.log("Indo para página de ofertas => isOfertaPersonalizada = ",o),o?(console.log("Entoru 1"),console.log("Passou hideScreen2"),loadPageOferta(!1),console.log("Passou loadPageOferta")):hideScreen1(),console.log("Antes do if"),isPersonalizar?(console.log("Entrou no personalizar"),isPersonalizar=!1,callFormScreen2(t)):(console.log("Entrou na oferta"),loadScreenOffers(),o||loadPageOferta(!0),goToPageOfertas()),e&&gerarJsonCompleto())}function openModal(){var e=document.getElementById("modal1");M.Modal.getInstance(e).open()}function enableSpinner(e=!1){if(document.querySelector(".preloader-background").classList.add("active"),document.querySelector(".spinner").classList.add("active"),e){const e=["Recebemos seus dados e estamos gerando um orçamento…","Localizando ofertas disponíveis…","Por favor aguarde, estamos precificando seu orçamento…"];let o=0,n=document.getElementById("message-container"),a=document.getElementById("message-spinner");function t(){a.textContent=e[o],o=(o+1)%e.length}n.classList.add("active"),t(),setInterval(t,5e3)}}function disabledSpinner(){document.querySelector(".preloader-background").classList.remove("active"),document.querySelector(".spinner").classList.remove("active"),document.getElementById("message-container").classList.remove("active")}function hideScreen1(){document.getElementById("form-screen-1").classList.add("hide"),document.getElementById("rectangle-1").classList.remove("currentRectangle"),document.getElementById("rectangle-1").classList.add("previusRectangle"),document.getElementById("rectangle-2").classList.remove("nextRectangle"),document.getElementById("rectangle-2").classList.add("currentRectangle"),document.getElementById("pageSubtitle").classList.add("hide")}function hideScreen2(){document.getElementById("form-screen-2-personalizar").classList.add("hide"),document.getElementById("form-screen-2-pacotes").classList.add("hide"),document.getElementById("screen2-tab-form").classList.add("hide"),document.getElementById("rectangle-1").classList.remove("currentRectangle"),document.getElementById("rectangle-1").classList.add("previusRectangle"),document.getElementById("rectangle-2").classList.remove("nextRectangle"),document.getElementById("rectangle-2").classList.add("currentRectangle"),document.getElementById("pageSubtitle").classList.add("hide"),document.getElementById("screen2-salvar").classList.add("hide")}function goToPageOfertas(){pageRef=2,stepNumber=2,stepPage="Ofertas",nextPage="Proposta",currentPageNumber=document.getElementById("currentPageNumber"),currentPageNumber.innerText=pageRef,currentPageIndicator=document.getElementById("currentPageIndicator"),currentPageIndicator.innerText=stepPage,nextPageIndicator=document.getElementById("nextPageIndicator"),nextPageIndicator.innerText=nextPage}function goToPagePersonalizar(){const e=document.getElementById("form-screen-2-personalizar");e&&e.classList.remove("hide");const t=document.getElementById("form-screen-1");t&&t.classList.add("hide");const o=document.getElementById("screen1-personalizar");o&&o.classList.add("hide");const n=document.getElementById("screen1-exibir");n&&n.classList.add("hide");const a=document.getElementById("screen2-salvar");a&&a.classList.remove("hide"),pageRef=2,stepNumber=2,stepPage="Personalizar Oferta",nextPage="Ofertas";const r=document.getElementById("pageSubtitle");r&&r.classList.add("hide"),currentPageNumber=document.getElementById("currentPageNumber"),currentPageNumber&&(currentPageNumber.innerText=pageRef),currentPageIndicator=document.getElementById("currentPageIndicator"),currentPageIndicator&&(currentPageIndicator.innerText=stepPage),nextPageIndicator=document.getElementById("nextPageIndicator"),nextPageIndicator&&(nextPageIndicator.innerText=nextPage),document.getElementById("rectangle-1").classList.remove("currentRectangle"),document.getElementById("rectangle-1").classList.add("previusRectangle"),document.getElementById("rectangle-2").classList.remove("nextRectangle"),document.getElementById("rectangle-2").classList.add("currentRectangle"),loadBtnPagePersonalizar()}function backToFormScreen1(){document.getElementById("form-screen-1")&&document.getElementById("form-screen-1").classList.remove("hide"),document.getElementById("form-screen-2-personalizar")&&document.getElementById("form-screen-2-personalizar").classList.add("hide"),document.getElementById("screen1-personalizar")&&document.getElementById("screen1-personalizar").classList.remove("hide"),document.getElementById("screen1-exibir")&&document.getElementById("screen1-exibir").classList.remove("hide"),document.getElementById("screen2-salvar")&&document.getElementById("screen2-salvar").classList.add("hide"),pageRef=1,stepNumber=1,stepPage="Perfis",nextPage="Ofertas",pageSubtitle=document.getElementById("pageSubtitle"),pageSubtitle.innerText="Informe os dados do seu cliente:",pageSubtitle.classList.remove("hide"),currentPageNumber=document.getElementById("currentPageNumber"),currentPageNumber.innerText=pageRef,currentPageIndicator=document.getElementById("currentPageIndicator"),currentPageIndicator.innerText=stepPage,nextPageIndicator=document.getElementById("nextPageIndicator"),nextPageIndicator.innerText=nextPage,document.getElementById("rectangle-1")&&document.getElementById("rectangle-1").classList.add("currentRectangle"),document.getElementById("rectangle-1")&&document.getElementById("rectangle-1").classList.remove("previusRectangle"),document.getElementById("rectangle-2")&&document.getElementById("rectangle-2").classList.add("nextRectangle"),document.getElementById("rectangle-2")&&document.getElementById("rectangle-2").classList.remove("currentRectangle"),document.getElementById("screen2-tab-form")&&document.getElementById("screen2-tab-form").classList.add("hide"),document.getElementById("form-screen-2-personalizar")&&(document.getElementById("form-screen-2-personalizar").innerHTML=""),document.getElementById("form-screen-2-pacotes")&&(document.getElementById("form-screen-2-pacotes").innerHTML="")}function callFormScreen2(e=null){if(e){if(2===e.tarefa)return window.localStorage.setItem("ofertaSelecionada",e.numOrcamento),window.localStorage.setItem("chamouProposta",!0),redirecionarTela(),void enableSpinner();window.localStorage.setItem("ofertaSelecionadaPersonalizar",e.numOrcamento)}else document.querySelector('[class*="card-div-selected"]')?(ofertaSelecionada=document.querySelector('[class*="card-div-selected"]').id.split("-").pop(),window.localStorage.setItem("ofertaSelecionadaPersonalizar",ofertaSelecionada)):window.localStorage.setItem("ofertaSelecionadaPersonalizar","");if(goToPagePersonalizar(),document.getElementById("form-screen-2-personalizar").classList.contains("hide"))document.getElementById("form-screen-2-personalizar").classList.remove("hide");else{familyMock(),assambleScreen2();var t=document.querySelectorAll("select");M.FormSelect.init(t),setAddedValueFromSelectedOffer(),setPresetValues()}}function autoCompleteScreen1(e="default",t=""){if("true"==window.localStorage.getItem("chamouProposta")&&"default"===e||["orcamento","reaproveitamento","auto"].some(t=>t===e)){let o="reaproveitamento"===e||"auto"===e?t:window.localStorage.getItem("dadosUsuario");if(o){if(o=JSON.parse(o),"reaproveitamento"===e){if(!o.DICIO_ORIGEM)return void window.localStorage.removeItem("dadosProposta");window.localStorage.setItem("dadosProposta",t);const e=Object.entries(o);o=e.map(e=>({id:e[0],conteudo:e[1]}))}document.querySelectorAll(".screen1").forEach(t=>{"SELECT"===t.tagName?o.forEach(n=>{if(t.id.includes(n.id)){let a=n.conteudo;"reaproveitamento"===e&&(a="DICIO_RENDA"===n.id?formatFormValue(n.id,o.find(e=>"DICIO_FAIXARENDA"===e.id).conteudo):formatFormValue(n.id,n.conteudo)),t.value=a}}):"INPUT"===t.tagName&&o.forEach(e=>{if(t.id.includes(e.id)&&"DICIO_PROFISSAO"==e.id){const o=JSON.parse(window.localStorage.getItem("jsonServicos")).DICIO_PROFISSAO.itens.find(t=>t.codigo===e.conteudo);t.value=o.rotulo}else t.id.includes(e.id)&&"DICIO_DATANASCIMENTO"==e.id?t.value=e.conteudo.split("-").reverse().join("/"):t.id.includes(e.id)&&"DICIO_DEPENDENTES"==e.id?t.value==e.conteudo.toString()?(t.setAttribute("checked",!0),t.checked=!0):t.removeAttribute("checked"):t.id.includes(e.id)&&(t.value=e.conteudo)})}),M.updateTextFields();document.querySelectorAll("select").forEach(e=>{M.FormSelect.init(e,{})})}}}function gerarJsonCompleto(){const e=window.localStorage.getItem("jsonResponseCalculo")?JSON.parse(window.localStorage.getItem("jsonResponseCalculo")):null;if(e&&("individual"===e.ofertas[0].orcamento.segmento.toLowerCase()||"viagem"===e.ofertas[0].orcamento.segmento.toLowerCase())){const t=window.localStorage.getItem("entradaConsultivo")?JSON.parse(window.localStorage.getItem("entradaConsultivo")):null,o=window.localStorage.getItem("jsonMdtGrupo")?JSON.parse(window.localStorage.getItem("jsonMdtGrupo")):null,n=window.localStorage.getItem("conjuntosJson")?JSON.parse(window.localStorage.getItem("conjuntosJson")):null,a=window.localStorage.getItem("jsonServicos")?JSON.parse(window.localStorage.getItem("jsonServicos")):null,r=window.localStorage.getItem("jsonEntradaCalculo")?JSON.parse(window.localStorage.getItem("jsonEntradaCalculo")):null,i=window.localStorage.getItem("caminhoTomado")?JSON.parse(window.localStorage.getItem("caminhoTomado")):null,s=window.localStorage.getItem("dadosUsuario")?JSON.parse(window.localStorage.getItem("dadosUsuario")):null,l=[];e.ofertas.forEach(e=>{l.push(e.orcamento.numeroOrcamento)});const c={entradaConsultivo:t,jsonMdtGrupo:o,conjuntosJson:n,jsonServicos:a,jsonEntradaCalculo:r,jsonResponseCalculo:e,caminhoTomado:i,dadosUsuario:s};callGravaJson(JSON.stringify(c),JSON.stringify(l))}}function setLocalStorage(e){const t=document.getElementById("localStorage");if(t&&""!==t.value&&e){const o=JSON.parse(t.value);window.localStorage.clear();for(let e in o)if(o[e])if("caminhoTomado"===e)caminho=[],o[e].forEach(e=>{caminho.push(+e)}),window.localStorage.setItem(e,JSON.stringify(caminho));else if(window.localStorage.setItem(e,JSON.stringify(o[e])),"jsonEntradaCalculo"===e)window.localStorage.setItem("dadosUsuario",JSON.stringify(o[e].consultivo.respostas));else if("jsonResponseCalculo"===e)resetOfertas(o[e]);else if("jsonServicos"===e){let t=document.getElementById("jsonServicos");t&&(t.value=JSON.stringify(o[e]))}let n=JSON.parse(e);n.numOrcamento&&n.tarefa&&(autoCompleteScreen1("orcamento"),isPersonalizar=!0,geraProdutos(!1,n))}else disabledSpinner()}function checkOrcamento(){const e=new URLSearchParams(window.location.search),t=JSON.parse(e.get("dados")).consultivo.portalAdm;if([1,2].includes(t.tarefa)&&/^\d+$/.test(t.numOferta)){const e={numOrcamento:t.numOferta,tarefa:t.tarefa};enableSpinner(),callReturnLocalStorage(JSON.stringify(e))}}document.addEventListener("DOMContentLoaded",(function(){enableSpinner();let e=new URLSearchParams(window.location.search);console.log("Dados Url: "+e.get("origem")),"proposta"==e.get("origem")?window.localStorage.setItem("chamouProposta",!0):window.localStorage.setItem("chamouProposta",!1),conjuntosJson=JSON.parse(document.querySelector("#Conjuntos").value),window.localStorage.setItem("conjuntosJson",JSON.stringify(conjuntosJson)),orderConjuntosJson(),console.log(conjuntosJson.conjuntos[0]),console.log(window.localStorage.getItem("conjuntosJson")),document.getElementById("screen2-tab-form").classList.add("hide"),assambleScreen1(),window.localStorage.setItem("segmento",document.querySelector("#Segmento").value),addData()})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll("select");M.FormSelect.init(e)})),document.addEventListener("DOMContentLoaded",(function(){let e=document.querySelectorAll(".modal");M.Modal.init(e)}));const formatRenda=e=>+e>2e4?39e3:e;function formatFormValue(e,t){switch(e){case"DICIO_SEXO":return t.indexOf("MASC")>=0?"MASCULINO":"FEMININO";case"DICIO_FUMANTE":return"true"===t?"SIM":"NAO";case"DICIO_AGENCIAMENTO":return""+ +t;case"DICIO_RENDA":return+(o=t)>2e4?39e3:o;default:return t}var o}
const families=[{nome:"Cobertura para a família",siglas:["BAS","MAP","AFF","AFI","AFP","PET"]},{nome:"Cobertura para o segurado",siglas:["IPAM","IPA","DMHO"]},{nome:"Doenças",siglas:["IFPD","DG17","DG10","CAN","AED"]},{nome:"Renda",siglas:["DIH","DIT","DIHD"]}];let cards=[];const mapPayment=new Map;let ofertas=[];function loadScreenOffers(){console.log("Chamando tela de ofertas"),ofertas=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas,ofertas.forEach(e=>{const t=e.retornosCalculo.sort((e,t)=>t.precificacao.premio.total-e.precificacao.premio.total).filter((e,t,n)=>e.precificacao.premio.total===n[0].precificacao.premio.total)[0].precificacao.premio.total,n={id:e.orcamento.idProdutoSf,budgetNumber:e.orcamento.orcnum,title:e.orcamento.rotulo,priceText:"Preço mensal",price:t,priceValue:(t/12).toLocaleString("pt-br",{style:"currency",currency:"BRL"}),priceKey:"Plano anual",fullPriceValue:t.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),priceDescription:"10% de desconto com Cartão Porto ou 5% nos cartões de crédito.",options:families.map(t=>{const n={title:t.nome,sections:t.siglas.map(t=>{const n=e.orcamento.contratantes.find(e=>"PRI"===e.tipo).grupos[0].segurados[0].coberturas.find(e=>e.sigla==t);if(e.regras.coberturas.find(e=>t===e.sigla)){let a=e.orcamento.contratantes.find(e=>"PRI"===e.tipo).grupos[0].segurados[0].coberturas.find(e=>e.sigla==t&&0===parseFloat(e.valor));const o=e.regras.coberturas;let c=n?parseFloat(n.valor).toLocaleString("pt-br",{style:"currency",currency:"BRL"}):"-";const d=e.regras.coberturas.find(e=>t===e.sigla).nome,l=e.regras.coberturas.find(e=>t===e.sigla)?e.regras.coberturas.find(e=>t===e.sigla).descricao:"";return a&&o.forEach(e=>{a.sigla!==e.sigla||"Assistência"!==e.tipoGarantia||"Serviço Complementar (sem valor de capital)"!==e.formaExibicaoCapital&&!e.formaExibicaoCapital.includes("Serviço Complementar (sem valor de capital)")||(console.log("entrou if rogerio << >> "),c="Contratada")}),{key:d,value:c,descricao:l}}})};return n.sections=n.sections.filter(e=>e),n})};cards.push(n)}),createPaymentObject();const e=createCardsRow();cards.sort((e,t)=>e.price-t.price).forEach((t,n)=>{fillCardContent(createCardContent(createCardDiv(e),t.budgetNumber),t,t.budgetNumber)});let t=document.querySelectorAll(".tooltipped");if(t.length>0){M.Tooltip.init(t)}}function createCardsRow(){const e=document.getElementById("mainDiv"),t=createDivRow();return e.appendChild(t),t}function createCardDiv(e){const t=document.createElement("div");return t.classList.add("card"),t.classList.add("col"),t.classList.add("l4"),t.classList.add("card-div","z-depth-0"),e.appendChild(t),t}function createCardContent(e,t){const n=document.createElement("div");return n.classList.add("card-content"),n.classList.add("card-div-content"),n.id="card-option-"+t,e.appendChild(n),n}function fillCardContent(e,t,n){const a=document.createElement("div");a.id="card-option-selected-"+n,a.setAttribute("onclick","onClickSelect(this);"),e.appendChild(a);const o=document.createElement("div");o.classList.add("card-info"),a.appendChild(o);const c=document.createElement("span");c.innerText="Clique no card para selecionar",o.appendChild(c);const d=document.createElement("span");d.innerText=n,a.appendChild(d);const l=document.createElement("span");l.classList.add("card-title"),l.classList.add("bold-text"),l.innerText=t.title,a.appendChild(l),createMainPriceContentCard(a,t),createFullPriceContentCard(a,t),createBtnPaymentOptions(a,t,n),t.options.forEach(e=>{createPlanOptions(a,e)}),createBtnSelectOptions(e,t,n)}function createMainPriceContentCard(e,t){const n=createDivRow();n.classList.add("valign-wrapper"),e.appendChild(n);const a=document.createElement("span");a.classList.add("col","s6"),a.innerText=t.priceText,n.appendChild(a);const o=document.createElement("span");o.classList.add("col","s6","bold-text","price-value"),o.innerText=t.priceValue,n.appendChild(o)}function createFullPriceContentCard(e,t){const n=createDivRow();n.classList.add("div-full-price"),e.appendChild(n);const a=createDivRow();n.appendChild(a);const o=document.createElement("span");o.classList.add("col","s6"),o.innerText=t.priceKey,a.appendChild(o);const c=document.createElement("span");c.classList.add("col","s6","bold-text"),c.innerText=t.fullPriceValue,a.appendChild(c);const d=createDivRow();d.classList.add("section-row"),n.appendChild(d);const l=document.createElement("span");l.classList.add("col","s12","text-full-price-desc"),l.innerText=t.priceDescription,d.appendChild(l)}function createBtnPaymentOptions(e,t,n){const a=createDivRow();e.appendChild(a);const o=document.createElement("div");o.classList.add("col","s12","center"),a.appendChild(o);const c=document.createElement("a");c.classList.add("btn-flat","waves-effect","btn-payment","btn-ajust-height"),o.appendChild(c);const d=document.createElement("span");c.appendChild(d),c.id="btn-payment-"+n;const l=document.createElement("i");l.classList.add("material-icons","inline-icon"),l.innerText="monetization_on",d.appendChild(l),d.innerHTML+=" Gerar PDF do orçamento",c.setAttribute("onclick","onClickPayment(this);")}function createPlanOptions(e,t){const n=createDivRow();e.appendChild(n);const a=document.createElement("div");a.classList.add("col","l12","section"),n.appendChild(a);const o=document.createElement("h6");o.classList.add("bold-text"),o.innerText=t.title,a.appendChild(o),t.sections.forEach(e=>{createInsideSection(a,e.key,e.value,e.descricao)})}function createInsideSection(e,t,n="-",a=""){const o=createDivRow();o.classList.add("section-row","valign-wrapper"),e.appendChild(o);const c=document.createElement("div");c.classList.add("col","l8"),o.appendChild(c);const d=document.createElement("span");if(d.innerHTML=t,c.appendChild(d),a){const e=document.createElement("i");e.classList.add("tiny","material-icons","tooltipped"),e.classList.add("help-icon"),e.textContent="help",e.setAttribute("data-position","right"),e.setAttribute("data-tooltip",a),d.appendChild(e)}const l=document.createElement("div");l.classList.add("col","l4"),o.appendChild(l);const i=document.createElement("span");i.classList.add("right","bold-text","center"),i.innerText=n,l.appendChild(i)}function createBtnSelectOptions(e,t,n){const a=createDivRow();a.classList.add("valign-wrapper"),e.appendChild(a);const o=document.createElement("div");o.classList.add("col","s12","center"),a.appendChild(o);const c=document.createElement("a");c.classList.add("btn-flat","waves-effect","blue","darken-4","btn-select"),c.id="btn-option-"+n,o.appendChild(c);const d=document.createElement("span");c.appendChild(d),d.innerHTML="Selecionar",c.setAttribute("onclick","onClickSelect(this);")}function addIcon(e,t,n){const a=document.createElement("i");a.classList.add("material-icons","inline-icon"),a.innerText="check_circle",e.appendChild(a),e.innerHTML+=" "+n}function onClickSelect(e){e=document.getElementById("btn-option-"+e.id.split("-").pop()),console.log(e.id),unselectedAllCards(e.id.split("-").pop()),e.innerHTML="";const t=document.createElement("span");e.appendChild(t),[...e.classList].includes("selecionado")?e.innerHTML="Selecionar":addIcon(t,"check_circle","Selecionado"),[...e.classList].includes("selecionado")?e.classList.remove("selecionado"):e.classList.add("selecionado"),[...e.classList].includes("selecionado")?document.getElementById("card-option-"+e.id.split("-").pop()).classList.add("card-div-selected"):document.getElementById("card-option-"+e.id.split("-").pop()).classList.remove("card-div-selected")}async function unselectedAllCards(e){const t=document.querySelectorAll('[id*="card-option"]');await t.forEach(t=>{t.id.includes(e)||unselecCard(t)})}function unselecCard(e){e.classList.remove("card-div-selected");const t=document.getElementById("btn-option-"+e.id.split("-").pop());t.innerHTML="Selecionar",t.classList.remove("selecionado")}function onModalClose(e){e.parentNode.removeChild(e)}function onClickPayment(e){console.log(e.id.split("-").pop());const t=createPaymentModal(e.id.split("-").pop());M.Modal.init(t,{onCloseEnd:function(){onModalClose(t)}}).open()}function createPaymentModal(e){const t=document.getElementById("mainBody"),n=document.createElement("div");n.id="paymentOptionsModal",n.classList.add("modal","modalPayment"),t.appendChild(n);const a=document.createElement("div");a.id="payment-options-modal-content",a.classList.add("modal-content"),n.appendChild(a);const o=document.createElement("h4");o.classList.add("bold-text","modal-payment-margin","left-align","w100"),o.innerText="Formas de pagamento",a.appendChild(o);const c=document.createElement("h5");c.classList.add("left-align","w100"),c.innerText="Selecione a condição desejada",a.appendChild(c);const d=document.createElement("p");d.classList.add("left-align","w100"),d.innerText="Para imprimir ou exportar as condições de pagamento, selecione ao menos uma coluna.\nValores com IOF (Imposto sobre operações financeiras)",a.appendChild(d);const l=document.createElement("div");l.id="payment-options-modal-footer",l.classList.add("modal-footer"),n.appendChild(l);const i=document.createElement("a");i.classList.add("modal-close","waves-effect","btn","btn-modal"),i.innerText="Fechar",l.appendChild(i);const r=document.createElement("a");r.classList.add("waves-effect","btn","disabled","btn-modal"),r.innerText="Gerar PDF",r.id="generate-pdf-payment-btn",r.addEventListener("click",t=>{t.preventDefault(),callPdfOrcamento(e)}),l.appendChild(r);return createPaymentTable(a,Array.from(mapPayment.get(e).keys()).sort((t,n)=>parseFloat(mapPayment.get(e).get(t).values().next().value.replace(".","").replace(",",".").split(" ")[1])-parseFloat(mapPayment.get(e).get(n).values().next().value.replace(".","").replace(",",".").split(" ")[1]))),populatePaymentTable(e),n}function populatePaymentTable(e){for(let t=1;t<=12;t++){let n=null;Array.from(mapPayment.get(e).keys()).forEach(a=>{n=mapPayment.get(e).get(a).get(String(t)),document.getElementById(`row-${t}-${a}`).innerText=null!=n?n:"-";const o=document.getElementById("row-"+t);let c=document.querySelectorAll(`#row-${t} > td:not(:first-child)`),d=Array.from(c),l=!0;for(let e=1;e<d.length;e++)if(d[e].textContent!==d[0].textContent){l=!1;break}l&&o.remove()})}}function createPaymentTable(e,t){console.log("createPaymentTable",e,t);const n=document.createElement("table");n.classList.add("centered"),e.appendChild(n);const a=document.createElement("thead");a.classList.add("table-head"),n.appendChild(a);const o=document.createElement("tr");a.appendChild(o);const c=document.createElement("th"),d=document.createElement("span");d.innerText="Parcelas",c.appendChild(d),o.appendChild(c),t.forEach(e=>{const t=document.createElement("th");o.appendChild(t);const n=createCheckBox(e,"col-payment-"+e,updatePdfBtn);t.appendChild(n)});const l=document.createElement("tbody");n.appendChild(l);for(let e=0;e<12;e++){const n=document.createElement("tr");n.id="row-"+(e+1),l.appendChild(n);for(let a=0;a<=t.length;a++){const o=document.createElement("td");o.id=a-1>=0?`row-${e+1}-${t[a-1]}`:`row-${e+1}-parcela`,a-1<0&&(o.innerText=e+1+"x"),n.appendChild(o)}}}function createPaymentObject(){ofertas.forEach(e=>{console.log("oferta",e);const t=e.orcamento.orcnum,n=new Map;e.parcelamentos.forEach(t=>{console.log("parcelamento",t);let a=e.parcelamentos.filter(e=>e.nomeFormaPagamento===t.nomeFormaPagamento);console.log("parcFamily",a),n.set(t.nomeFormaPagamento,new Map(a.map(e=>[String(e.qtdParcelas),((parseFloat(e.valorPrimeiraParcela)+parseFloat(e.valorDemaisParcelas||0)*(e.qtdParcelas-1))/e.qtdParcelas).toLocaleString("pt-br",{style:"currency",currency:"BRL"})])))}),console.log("formasPagamento",n),mapPayment.set(t,n)})}function createDivRow(){const e=document.createElement("div");return e.id="ofertasRow",e.classList.add("row"),e}function createCheckBox(e,t,n=null){console.log("eventListener => ",n);const a=document.createElement("label"),o=document.createElement("input");o.type="checkbox",o.id=t,o.classList.add("filled-in","check-box-background-color"),n&&o.addEventListener("change",n),a.appendChild(o);const c=document.createElement("span");return c.classList.add("check-box-text-color"),c.innerText=toCamelCase(e),a.appendChild(c),a}function updatePdfBtn(){console.log("Entrou no botão");const e=document.querySelectorAll('input[id*="col-payment-"]'),t=document.getElementById("generate-pdf-payment-btn");Array.from(e).some(e=>e.checked)?t.classList.remove("disabled"):t.classList.add("disabled")}function callPdfOrcamento(e){const t=createPaymentSelectedObject(e);let n=`/apex/OrcamentoVidaPage?numeroOrcamento=${e}${t?"&formasPagamento="+t:""}`,a=JSON.parse(window.localStorage.getItem("dadosUsuario")),o="",c="",d="",l="",i="",r="",s="",p="",m="";for(let e of a)"DICIO_NOME"==e.id&&(o=e.conteudo.trim()),"DICIO_NOMESOCIAL"==e.id&&(c=e.conteudo.trim()),"DICIO_SEXO"==e.id&&(d=e.conteudo.trim()),"DICIO_DATANASCIMENTO"==e.id&&(r=e.conteudo.trim()),"DICIO_FUMANTE"==e.id&&(s=e.conteudo.trim()),"DICIO_PROFISSAO"==e.id&&(i=e.conteudo.trim()),"DICIO_RENDA"==e.id&&(l=e.conteudo.trim()),"DICIO_REGIME_TRABALHO"==e.id&&(m=e.conteudo.trim()),"DICIO_DEPENDENTES"==e.id&&(p=e.conteudo);let u=document.createElement("form");u.action=n,u.method="POST",u.style.display="none",u.target="_blank";let C=document.createElement("input");C.name="nomeSeguradoPDF",C.value=o,u.appendChild(C);let f=document.createElement("input");f.name="nomeSocialSeguradoPDF",f.value=c,u.appendChild(f);let h=document.createElement("input");h.name="sexoSeguradoPDF",h.value=d,u.appendChild(h);let g=document.createElement("input");g.name="rendaSeguradoPDF",g.value=l,u.appendChild(g);let E=document.createElement("input");E.name="ocupacaoSeguradoPDF",E.value=i,u.appendChild(E);let y=document.createElement("input");y.name="nascimentoSeguradoPDF",y.value=r,u.appendChild(y);let P=document.createElement("input");P.name="fumanteSeguradoPDF",P.value=s,u.appendChild(P);let L=document.createElement("input");L.name="dependenteSeguradoPDF",L.value=p,u.appendChild(L);let b=document.createElement("input");b.name="formaTrabalhoSeguradoPDF",b.value=m,u.appendChild(b),document.querySelector("body").appendChild(u),u.submit()}function createPaymentSelectedObject(e){e=String(e);const t=document.querySelectorAll('input[id*="col-payment-"]'),n=[];for(var a=0;a<t.length;a++)t[a].checked&&n.push(t[a].id.split("-").pop());console.log("formasDePagamento: ",n);const o=new Map,c=new Map;return n.forEach(t=>{c.set(t,mapPayment.get(e).get(t))}),o.set(e,c),console.log(o),mapToString(o)}
let screen2FormValue,Screen2Response,errosScreen2=[],requiredMainFields=!1,agencyField=!1,brokerage=!1,inputLimits=!1,needDIT=!1,needDIH=!1,needDIHD=!1,needBAS=!1,needIPA=!1;const familyMap=new Map;let isPersonalizar=!1,isComboPersonalizar=!1,lastTab="";function onClickPersonalizarButton(){document.getElementById("rectangle-1-screen2").classList.contains("hide")&&(document.getElementById("rectangle-1-screen2").classList.remove("hide"),document.getElementById("rectangle-2-screen2").classList.add("hide"),document.getElementById("form-screen-2-pacotes").classList.add("hide"),document.getElementById("form-screen-2-personalizar").classList.remove("hide"))}function onClickCoberturasButton(){document.getElementById("rectangle-2-screen2").classList.contains("hide")&&(document.getElementById("rectangle-2-screen2").classList.remove("hide"),document.getElementById("rectangle-1-screen2").classList.add("hide"),document.getElementById("form-screen-2-personalizar").classList.add("hide"),document.getElementById("form-screen-2-pacotes").classList.remove("hide"))}function assambleScreen2(){document.getElementById("screen2-tab-form").classList.remove("hide"),document.getElementById("rectangle-2-screen2").classList.add("hide"),document.getElementById("form-screen-2-pacotes").classList.add("hide"),document.querySelector("#div-personalizar-button").addEventListener("click",onClickPersonalizarButton),document.querySelector("#div-coberturas-button").addEventListener("click",onClickCoberturasButton);const e=document.getElementById("form-screen-2-personalizar");let a=[],t=[],r=[],i=[];const o=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].regras.coberturas;o.forEach(e=>{e.id=e.sigla,e.opcoes=getOptionsCoberturas(e),"DIH"==e.sigla?(e.prioridade=17,e.caracteristicaespecial.id="DIH-Dias",e.caracteristicaespecial.nome="Número de diárias por internação hospitalar por acidente",e.caracteristicaespecial.sigla="DIH-Dias",e.caracteristicaespecial.obrigatorio=!0,e.caracteristicaespecial.prioridade=18,o.push(e.caracteristicaespecial)):"DIT"==e.sigla?(e.prioridade=15,e.franquias.forEach(a=>{1==a.padrao&&(a.id="DIT-Franquia",a.sigla="DIT-Franquia",a.tipo="Monetário",a.nome="Selecione uma franquia",a.prioridade=16,a.opcoes=getOptionsDIT(e.franquias),a.obrigatorio=!0,o.push(a))})):"DMHO"==e.sigla?e.tipo="Monetário":"DIHD"==e.sigla&&(console.log("entrou no else if DIHD"),e.prioridade=19,e.caracteristicaespecial.nome="Número de diárias por internação hospitalar por doença",e.caracteristicaespecial.id="DIHD-Dias",e.caracteristicaespecial.sigla="DIHD-Dias",e.caracteristicaespecial.obrigatorio=!0,e.caracteristicaespecial.prioridade=20,o.push(e.caracteristicaespecial))}),o.sort(compare),o.forEach(e=>{"familia"==familyMap.get(e.sigla)?a.push(e):"segurado"==familyMap.get(e.sigla)?t.push(e):"doencas"==familyMap.get(e.sigla)?r.push(e):"renda"==familyMap.get(e.sigla)&&i.push(e)});const n=JSON.parse(window.localStorage.getItem("conjuntosJson")).conjuntos[0].informacoes;let l=[];if(n.forEach(e=>{console.log("Gior E ===> ",e),"DICIO_AGENCIAMENTO"!=e.id&&"DICIO_CORRETAGEM"!=e.id||("DICIO_CORRETAGEM"==e.id&&(e.limiteMaximo="40"),requiredList.push({...e}),e.id=e.id+"2",e.obrigatorio=!0,l.push(e))}),createDivWithText("Cobertura para a família",e),createDivRows(2,Math.ceil(a.length/3),e,"familia"),console.log("Gior Familia ==>",a),splitArrayIntoSubarrays(a,Math.ceil(a.length/3)).forEach((e,a)=>{let t=1;e.forEach(e=>{createFormElements(e,a+1,2,t,"familia"),t+=1}),t+=1}),createDivWithText("Cobertura para o segurado",e),createDivRows(2,Math.ceil(t.length/3),e,"segurado"),splitArrayIntoSubarrays(t,Math.ceil(t.length/3)).forEach((e,a)=>{let t=1;e.forEach(e=>{createFormElements(e,a+1,2,t,"segurado"),t+=1}),t+=1}),createDivWithText("Doenças",e),createDivRows(2,Math.ceil(r.length/3),e,"doencas"),splitArrayIntoSubarrays(r,Math.ceil(r.length/3)).forEach((e,a)=>{let t=1;e.forEach(e=>{createFormElements(e,a+1,2,t,"doencas"),t+=1}),t+=1}),i&&i.length>0){createDivWithText("Renda",e),createDivRows(2,Math.ceil(i.length/3),e,"renda"),splitArrayIntoSubarrays(i,Math.ceil(i.length/3),2).forEach((e,a)=>{let t=1;e.forEach(e=>{createFormElements(e,a+1,2,t,"renda"),t+=1}),t+=1})}createDivRows(2,Math.ceil(l.length/3),e,"corretagem"),splitArrayIntoSubarrays(l,Math.ceil(l.length/3)).forEach((e,a)=>{let t=1;e.forEach(e=>{createFormElements(e,a+1,2,t,"corretagem"),t+=1}),t+=1}),coveragePackage=[...o],assembleScreen2Pacotes(),isComboPersonalizar&&(isComboPersonalizar=!1,onClickCoberturasButton())}function createDivWithText(e,a){var t=document.createElement("div");const r=document.createElement("h6");r.classList.add("bold-text"),r.innerText=e,t.appendChild(r),a.appendChild(t)}function createInputFieldScreen2(e,a,t,r){const i=createInputElement("text",a,t,r);i.setAttribute("data-type","currency"),i.setAttribute("value",moneyMask("0")),i.classList.add("screen"+t),i.setAttribute("min",a.limiteMinimo),i.setAttribute("max",a.limiteMaximo),i.setAttribute("sigla",a.id),i.setAttribute("caracteristica",a.caracteristica),e.classList.add("input-field"),e.appendChild(i),i.setAttribute("hidden","hidden"),e.appendChild(createErrorDiv(a.id+t));let o=2==t?"form-screen-2-personalizar":"form-screen-2-pacotes";const n=document.getElementById(o);return i.addEventListener("focus",e=>{disableLabel(n)}),i.addEventListener("blur",e=>{disableLabel(n);const r=document.getElementById("error-"+a.id+t);let o=i.value.split(" ")[1].replaceAll(".","").replace(",","."),l=parseFloat(o);l>a.limiteMaximo||l<a.limiteMinimo?r.textContent="Capital fora do limite para a profissão Min "+a.limiteMinimo.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})+" Máx "+a.limiteMaximo.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}):r.textContent=""}),i.addEventListener("input",e=>{disableLabel(n),""!=e.target.value&&"R$ NaN"!=e.target.value&&"R$"!=e.target.value&&"R$ "!=e.target.value?i.value=moneyMask(e.target.value):i.value=moneyMask("0")}),i}function createSelectFieldScreen2(e,a,t,r){const i=document.createElement("select");i.id=`select-screen-${t}-id-${r}-${a.id}`,i.classList.add("screen"+t),i.setAttribute("sigla",a.id),i.setAttribute("caracteristica",a.caracteristica),i.setAttribute("min",a.limiteMinimo),i.setAttribute("max",a.limiteMaximo),e.classList.add("input-field"),e.appendChild(i);const o=createOptionElement("nulloption","Não contratada");o.id=i.id+"-option-id-0",i.appendChild(o),a.opcoes.forEach((e,a)=>{const t=createOptionElement(e.codigo,e.rotulo);t.id=`${i.id}-option-id-${a+1}`,i.appendChild(t)}),e.appendChild(createLabel(i.id,a.nome,a.descricao)),e.appendChild(createErrorDiv(a.id));let n=a.includentes,l=a.excludentes;if("DIT-Franquia"!=a.tipo){const o=createInputFieldScreen2(e,a,t,r),s=document.getElementById("error-"+a.id+t);i.addEventListener("change",e=>{"outro"==e.target.value?o.removeAttribute("hidden"):(o.setAttribute("hidden","hidden"),s.textContent=""),"DIH"==a.sigla?needDIH="nulloption"!=e.target.value:"DIT"==a.sigla?needDIT="nulloption"!=e.target.value:"DIHD"==a.sigla&&(needDIHD="nulloption"!=e.target.value);document.querySelectorAll(".screen"+t).forEach(a=>{"SELECT"===a.tagName&&"nulloption"!=e.target.value&&(null!=l&&l.length>0&&l.forEach((e,t)=>{if(a.id.includes(e)){a.value="nulloption",console.log("formElement excludente->",a);const e=document.getElementById(a.id.replace("select","input"));e.hasAttribute("hidden")||e.setAttribute("hidden","hidden")}}),null!=n&&n.length>0&&n.forEach((t,r)=>{if(a.id.includes(t)){a.value=e.target.value,console.log("formElement includente->",a);const t=document.getElementById(a.id.replace("select","input"));"outro"==e.target.value?t.hasAttribute("hidden")&&t.removeAttribute("hidden"):t.hasAttribute("hidden")||t.setAttribute("hidden","hidden")}}))});var r=document.querySelectorAll("select");M.FormSelect.init(r)})}}function familyMock(){familyMap.set("BAS","familia"),familyMap.set("MAP","familia"),familyMap.set("AFI","familia"),familyMap.set("AFF","familia"),familyMap.set("AFP","familia"),familyMap.set("PET","familia"),familyMap.set("IPA","segurado"),familyMap.set("DMHO","segurado"),familyMap.set("IPAM","segurado"),familyMap.set("IFPD","doencas"),familyMap.set("DG17","doencas"),familyMap.set("DG10","doencas"),familyMap.set("CAN","doencas"),familyMap.set("AED","doencas"),familyMap.set("DIT","renda"),familyMap.set("DIH","renda"),familyMap.set("DIH-Dias","renda"),familyMap.set("DIHD","renda"),familyMap.set("DIHD-Dias","renda"),familyMap.set("DIT-Franquia","renda")}function moneyMask(e){e=e.replaceAll(".","").replaceAll(",","").replace(/\D/g,"");return"R$ "+new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2}).format(parseFloat(e)/100)}function compare(e,a){return e.prioridade<a.prioridade?-1:e.prioridade>a.prioridade?1:0}function getOptionsCoberturas(e){const a=mockCurrencyOptions(e);let t=[];return a.forEach(a=>{t.push({rotulo:"PET"===e.sigla?"Contratada":a.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),codigo:a})}),["AFF","AFI"].includes(e.sigla.includes)||"PET"===e.sigla||t.push({rotulo:"Outro valor",codigo:"outro"}),t}function mockCurrencyOptions(e){const a=e.sigla,t=+e.limiteMaximo;let r={AFP:[5e3,1e4,15e3,2e4],PET:[0],BAS:[6e4,1e5,2e5,3e5,4e5,5e5,1e6,5e6,1e7],MAP:[6e4,1e5,2e5,3e5,4e5,5e5,1e6,5e6,1e7],IPA:[6e4,1e5,2e5,3e5,4e5,5e5,1e6,5e6,1e7],IPAM:[6e4,1e5,2e5,3e5,4e5,5e5,1e6,5e6,1e7],IFPD:[6e4,1e5,2e5,3e5,4e5,5e5,2e6],AED:[6e4,1e5,2e5,3e5,4e5,5e5,1e6,5e6,1e7],CAN:[6e4,1e5,2e5,3e5,4e5,5e5],DG17:[6e4,1e5,2e5,3e5,4e5,5e5],DG10:[6e4,1e5,2e5,3e5,4e5,5e5],DIH:[50,100,200,250,300,400,500,1e3],DIHD:[50,100,200,250,300,400,500,1e3],DIT:[50,100,200,250,300,400,500,1e3,1300],DIG:[50,55,100,200,250,350],AFF:[5e3,1e4,15e3,2e4],AFI:[5e3,1e4,15e3,2e4],DMHO:[100,200,250,300,400,500,5e3,1e4]};r=addValueFromSelectedOffer(r);const i=r[a]||[],o=i.filter(e=>e<t);return o.length===i.length?i:[...o,t]}function addValueFromSelectedOffer(e){let a;const t=window.localStorage.getItem("ofertaSelecionadaPersonalizar");if(console.log("ofertaSelecionada",t),t&&(a=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas.find(e=>e.orcamento.orcnum==t),a)){const t=a.orcamento.contratantes[0].grupos[0].segurados[0].coberturas;t&&(console.log("coberturas => ",t),console.log("options => ",e),t.forEach(a=>{if(console.log("cobertura.sigla => ",a.sigla),e[a.sigla]){const t=parseFloat(a.valor);e[a.sigla].find(e=>e==t)||(e[a.sigla].push(t),e[a.sigla]=e[a.sigla].sort((e,a)=>e-a))}}),console.log("addValueFromSelectedOffer => ",e))}return e}function setAddedValueFromSelectedOffer(){let e;M.AutoInit();const a=window.localStorage.getItem("ofertaSelecionadaPersonalizar");if(a&&(e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas.find(e=>e.orcamento.orcnum==a),e)){const a=e.orcamento.contratantes[0].grupos[0].segurados[0].coberturas;a&&a.forEach(e=>{console.log("Danilo setAddedValueFromSelectedOffer cobertura => ",JSON.stringify(e)),console.log("setAddedValueFromSelectedOffer cobertura.sigla => ",e.sigla);const a=document.querySelector(`[sigla=${e.sigla}]`);if(a&&(a.value=""+parseFloat(e.valor),M.FormSelect.init(a)),"DIH"===e.sigla&&e.caracteristicaespecialvalor&&"dia(s)"==e.caracteristicaespecialtipo.toLowerCase()){const a=document.querySelector(`[sigla=${e.sigla}-Dias]`);a.value=e.caracteristicaespecialvalor;document.querySelector(`label[for=${a.id}]`).classList.add("active")}if("DIT"===e.sigla&&e.franquias&&e.franquias.length>0){const a=e.franquias.find(e=>e.selecionado),t=document.querySelector(`[sigla=${e.sigla}-Franquia]`);t&&a&&(t.value=""+a.valor,M.FormSelect.init(t))}})}}function getOptionsDIT(e){let a=[];return e.forEach(e=>{a.push({rotulo:e.name,codigo:e.valor})}),a}function mockDIT(){return{tipo:"Monetário",sigla:"DIT",obrigatorio:!1,caracteristica:"Adicional",tipoGarantia:"Cobertura",nome:"Diária por Incapacidade Temporária - Doença ou Acidente",inclui:null,includentes:[],descricao:"Pagamento de diária(s) contratada(s) pelo período em que o segurado não puder trabalhar devido ao afastamento das suas atividades profissionais, por doença ou acidente.",limiteMinimo:25,excludentes:["DITA"],carencias:[{valor:"CARENCIA_DIT",padrao:null,descricao:"Cobertura de Diária por Incapacidade Temporária - carência mínima de 60 dias e máxima de 180 dias para eventos decorrentes de doenças, conforme descrito nas Condições Gerais."}],prioridade:9,franquias:[{valor:"FR_NORMAL",name:"Franquia de 10 dias para Doença e 10 dias para Acidente",padrao:!0,selecionado:!0,descricao:"Cobertura de Diárias por Incapacidade Temporária - Franquia de 10 dias para doença e 10 dias para acidente."},{valor:"FR_REDUZIDA",name:"Franquia de 10 dias para Doença e 7 dias para Acidente",padrao:!1,selecionado:!1,descricao:"Cobertura de Diária por Incapacidade Temporária - Franquia de 10 dias para doença e 7 dias para acidente."}],limiteMaximo:1300,caracteristicaespecial:null,filtrada:!1}}function validateFormScreen2(){index=indexScreen2+3;let e=document.getElementById("rectangle-2-screen2").classList.contains("hide")?2:index;validateFieldsScreen2(e),validateErrorScreen2(e)}function validateFieldsScreen2(e){const a=document.querySelectorAll(".screen"+e);requiredMainFields=!1,agencyField=!1,brokerage=!1,inputLimits=!1,a.forEach(a=>{const t=a.getAttribute("sigla"),r=a.getAttribute("hidden"),i=a.getAttribute("caracteristica"),o=getRequiredList().includes(t)?t:t+e,n=document.getElementById("error-"+o);if(!r)if("SELECT"===a.tagName){if("Principal"==i&&"nulloption"!=a.value&&(requiredMainFields=!0),t=="DICIO_AGENCIAMENTO"+e)a.value&&"nulloption"!=a.value&&""!=a.value?(n.textContent="",agencyField=!0):(n.textContent="Campo obrigatório",agencyField=!1);else if("DIT-Franquia"==t)needDIT?a.value&&"nulloption"!=a.value&&""!=a.value?(n.textContent="",needDIT=!1):(n.textContent="Campo obrigatório",needDIT=!0):n.textContent="";else if("AED"===t){const e=document.querySelector('[sigla="BAS"]').value;"nulloption"!==a.value&&"nulloption"===e&&(needBAS=!0)}else if("IPAM"===t){const e=document.querySelector('[sigla="IPA"]').value;"nulloption"!==a.value&&"nulloption"===e&&(needIPA=!0)}}else if("INPUT"===a.tagName){let r=parseFloat(a.getAttribute("min")),i=parseFloat(a.getAttribute("max"));if("number"==a.type)t=="DICIO_CORRETAGEM"+e?a.value&&"nulloption"!=a.value&&""!=a.value?parseFloat(a.value)>i||parseFloat(a.value)<r?(n.textContent="Valor de Comissionamento fora do limite para a profissão Min "+parseInt(r)+" Máx "+parseInt(i),brokerage=!1):(n.textContent="",brokerage=!0):(n.textContent="Campo obrigatório",brokerage=!1):"DIH-Dias"==t&&(needDIH?a.value&&"nulloption"!=a.value&&""!=a.value?parseFloat(a.value)>i||parseFloat(a.value)<r?(n.textContent="Número de diárias fora do limite para a profissão Min "+parseInt(r)+" Máx "+parseInt(i),needDIH=!0):(n.textContent="",needDIH=!1):(n.textContent="Campo obrigatório",needDIH=!0):n.textContent="");else if("text"==a.type){const o=document.getElementById("error-"+t+e);console.log("errorDivInput->",o);let n=a.value.split(" ")[1].replaceAll(".","").replace(",","."),l=parseFloat(n);console.log("value->",l),console.log("max->",i),console.log("min->",r),l>i||l<r?(o.textContent="Capital fora do limite para a profissão Min "+r.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})+" Máx "+i.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),inputLimits=!0):o.textContent=""}}}),a.forEach(a=>{const t=a.getAttribute("sigla"),r=a.getAttribute("caracteristica"),i=document.getElementById("error-"+t+e);"SELECT"===a.tagName&&"Principal"==r&&(requiredMainFields?i.textContent.includes("Capital fora do limite para a profissão Min")||(i.textContent=""):i.textContent="*")})}function createRequiredObjList(e){return Array.from(mapPackages)[e-3][1].filter((function(e){return["BAS","MAP","IPA","AED"].includes(e)}))}function validateErrorScreen2(e){errosScreen2=[],requiredMainFields||errosScreen2.push("- Contrate ao menos 1 das garantias em destaque (BAS, MAP, IPA, IFPD)"),agencyField||errosScreen2.push("- Selecione um valor para o Percentual de Agenciamento"),brokerage||errosScreen2.push("- Insira um valor dentro dos limites permitidos para a Corretagem"),inputLimits&&errosScreen2.push("- Insira valores dentro dos limites permitidos para as coberturas"),needDIH&&errosScreen2.push("- Insira um valor dentro dos limites permitidos para a cobertura DIH"),needDIT&&errosScreen2.push("- Insira um valor dentro dos limites permitidos para a cobertura DIT"),needDIHD&&errosScreen2.push("- Insira um valor dentro dos limites permitidos para a cobertura DIHD"),needBAS&&(errosScreen2.push("- Para a contratação de Antecipação Especial por Doença (AED) é necessário contratar a Morte (BAS)"),needBAS=!1),needIPA&&(errosScreen2.push("- Para a contratação de Invalidez Permanente por Acidente Majorada (IPAM) é necessário contratar a Invalidez Permanente Total ou parcial por Acidente (IPA)"),needIPA=!1),console.log("errosScreen2:\n",errosScreen2),screen2FormValue=new Map;let a=[];if(0==errosScreen2.length){document.querySelectorAll(".screen"+e).forEach(t=>{const r=t.getAttribute("sigla"),i=t.getAttribute("hidden"),o=t.getAttribute("min"),n=t.getAttribute("max"),l=t.getAttribute("caracteristica");if("SELECT"===t.tagName){if("nulloption"!=t.value&&"outro"!=t.value)if(r=="DICIO_AGENCIAMENTO"+e)a.push({percentual:parseInt(t.value),tipoRemuneracao:"AGENCIAMENTO"});else if("DIT-Franquia"==r){if(screen2FormValue.has("DIT")){let e=screen2FormValue.get("DIT");e.franquia=t.value,screen2FormValue.set("DIT",e)}}else"GARANTIASPRINCIPAIS"==r?createRequiredObjList(e).forEach(e=>{screen2FormValue.set(e,{caracteristica:l,limitemaximo:n,limiteminimo:o,moeda:"BRL",sigla:e,valor:String(parseFloat(t.value).toFixed(2))})}):screen2FormValue.set(r,{caracteristica:l,limitemaximo:n,limiteminimo:o,moeda:"BRL",sigla:r,valor:String(parseFloat(t.value).toFixed(2))})}else if("INPUT"===t.tagName&&!i)if(r=="DICIO_CORRETAGEM"+e)a.push({percentual:parseInt(t.value),tipoRemuneracao:"CORRETAGEM"});else if("DIH-Dias"==r){if(screen2FormValue.has("DIH")){let e=screen2FormValue.get("DIH");e.caracteristicaespecialtipo="Dia(s)",e.caracteristicaespecialvalor=t.value,screen2FormValue.set("DIH",e)}}else"GARANTIASPRINCIPAIS"==r?createRequiredObjList(e).forEach(e=>{screen2FormValue.set(e,{caracteristica:l,limitemaximo:n,limiteminimo:o,moeda:"BRL",sigla:e,valor:t.value.replace("R$ ","").replaceAll(".","").replaceAll(",",".")})}):screen2FormValue.set(r,{caracteristica:l,limitemaximo:n,limiteminimo:o,moeda:"BRL",sigla:r,valor:t.value.replace("R$ ","").replaceAll(".","").replaceAll(",",".")})});const t=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.contratantes[0].grupos[0].segurados[0].coberturas.find(e=>"TELEMED"===e.sigla);t&&screen2FormValue.set(t.sigla,{caracteristica:t.caracteristica,limitemaximo:t.limitemaximo,limiteminimo:t.limiteminimo,moeda:t.moeda,sigla:t.sigla,valor:t.valor}),createJSONScreen2(a)}else{const e=document.getElementById("modal1-div");document.querySelectorAll('[id*="modal1-p"]').forEach(e=>{e.remove()}),errosScreen2.forEach(a=>{const t=document.createElement("p");t.id="modal1-p",t.style="align-self: self-start;",t.innerText=a+".",e.appendChild(t)}),openModal()}}function createJSONScreen2(e){const a=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento;a.contratantes[0].grupos[0].segurados[0].coberturas;let t={orcamento:{tipoVigencia:a.tipoVigencia,ramoSeguro:a.ramoSeguro,tipoSeguro:a.tipoSeguro,vigenciaFinal:a.vigenciaFinal,qtdDiasVigencia:a.qtdDiasVigencia,customizavel:a.customizavel,canalDistribuicao:a.canalDistribuicao,viagem:a.viagem,varConsultivo:a.varConsultivo,idProdutoSf:a.idProdutoSf,ordemPortal:a.ordemPortal,rotulo:a.rotulo,susepOrcamento:a.susepOrcamento,remuneracoes:e,dataCalculo:a.dataCalculo,numeroPortal:a.numeroPortal,codigoProdutoVida:a.codigoProdutoVida,contratantes:a.contratantes,meioComercializacao:a.meioComercializacao,segmento:a.segmento,gerarDocumento:a.gerarDocumento,vigenciaInicial:a.vigenciaInicial}};const r=[...screen2FormValue.values()];t.orcamento.contratantes[0].grupos[0].coberturas=r,t.orcamento.contratantes[0].grupos[0].segurados[0].coberturas=r,window.localStorage.setItem("personalizacaoOferta",JSON.stringify(t)),callOfertaPersonalizada(JSON.stringify(t)),enableSpinner(!0),lastTab=document.getElementById("form-screen-2-personalizar").classList.contains("hide")?"form-screen-2-pacotes":"form-screen-2-personalizar"}function setPresetValues(){M.AutoInit();const e=JSON.parse(window.localStorage.getItem("jsonResponseCalculo")).ofertas[0].orcamento.remuneracoes,a=e.find(e=>"AGENCIAMENTO"==e.tipoRemuneracao),t=document.querySelectorAll('[sigla*="DICIO_AGENCIAMENTO"]');Array.from(t).forEach((e,t)=>{if(0!=t){const t=Array.from(e.options).find(e=>e.value==a.percentual);t&&(t.selected=!0),M.FormSelect.init(e)}});const r=document.querySelectorAll('[sigla*="DICIO_CORRETAGEM"]');Array.from(r).forEach((a,t)=>{0!=t&&(a.value=e.find(e=>"CORRETAGEM"==e.tipoRemuneracao).percentual)}),M.updateTextFields()}
let mapPackages=new Map,coveragePackage=[],requiredList=[],indexScreen2=0;function mockPackages(){mapPackages.set("Morte",["BAS","AFI","AFF","AFP","PET","DG10","DG17","CAN","DMHO","DIH","DIH-Dias","DIT","DIT-Franquia","IFPD","DIHD","DIHD-Dias"]),mapPackages.set("Morte + Invalidez por Acidente",["BAS","IPA","AFI","AFF","AFP","PET","DG10","DG17","CAN","DMHO","DIH","DIH-Dias","DIT","DIT-Franquia","IPAM","IFPD","DIHD","DIHD-Dias"]),mapPackages.set("Morte + Invalidez por Acidente + Morte acidental",["BAS","IPA","MAP","AFI","AFF","AFP","PET","DG10","DG17","CAN","DMHO","DIH","DIH-Dias","DIT","DIT-Franquia","IPAM","IFPD","DIHD","DIHD-Dias"]),mapPackages.set("Morte + Invalidez por Acidente + AED",["BAS","IPA","AED","AFI","AFF","AFP","PET","DG10","DG17","CAN","DMHO","DIH","DIH-Dias","DIT","DIT-Franquia","IPAM","DIHD","DIHD-Dias"]),mapPackages.set("Morte + Morte acidental + IPA dobro",["BAS","MAP","IPA","AFI","AFF","AFP","PET","DG10","DG17","CAN","DMHO","DIH","DIH-Dias","DIT","DIT-Franquia","IPAM","IFPD","DIHD","DIHD-Dias"]),mapPackages.set("Morte + Morte acidental + IPA dobro + AED",["BAS","MAP","IPA","AED","AFI","AFF","AFP","PET","DG10","DG17","CAN","DMHO","DIH","DIH-Dias","DIT","DIT-Franquia","IPAM","DIHD","DIHD-Dias"])}function assembleScreen2Pacotes(){mockPackages();const e=Array.from(mapPackages.keys());e.forEach((e,a)=>{createRect(e,a)}),e.forEach((e,a)=>{createChildren(e,mapPackages.get(e),a,!1)})}function createRect(e,a){const t=document.getElementById("form-screen-2-pacotes"),i=document.createElement("div");i.className="rect rect-desabilitado",i.dataset.id=e,i.textContent=e,i.addEventListener("click",function(a){return function(){document.querySelectorAll(".rect").forEach((function(e){e.classList.remove("rect-habilitado"),e.classList.add("rect-desabilitado")})),i.classList.remove("rect-desabilitado"),i.classList.add("rect-habilitado");traverseDivs(document.getElementById("form-screen-2-pacotes"),e),indexScreen2=a}}(a)),t.appendChild(i)}function traverseDivs(e,a){"DIV"===e.tagName&&e.hasAttribute("package")&&(e.getAttribute("package")==a?e.removeAttribute("hidden"):e.setAttribute("hidden","hidden"));e.querySelectorAll("div").forEach((function(e){traverseDivs(e,a)}))}function createChildren(e,a,t,i){const r=document.getElementById("form-screen-2-pacotes");let c=i?a:getCombo(a,t,e);createDivRows(3+t,Math.ceil(c.length/3),r,e),splitArrayIntoSubarrays(c,Math.ceil(c.length/3)).forEach((a,i)=>{let r=1;a.forEach(a=>{createFormElements(a,i+1,3+t,r,e),r+=1}),r+=1})}function getCombo(e,a,t){let i=[];return coveragePackage.forEach(a=>{if(!e.includes(a.sigla)||"Principal"==a.caracteristica&&"IFPD"!=a.sigla||"AED"==a.sigla){if("BAS"==a.sigla){let e={...a};e=setNewOption(e,t),i.push(e)}}else i.push(a)}),requiredList.forEach(e=>{let t={...e},r=a+3;t.id=t.id+r,i.push(t)}),i}function setNewOption(e,a){return e.id="GARANTIASPRINCIPAIS",e.sigla="GARANTIASPRINCIPAIS",e.nome="Garantias Principais",e.descricao=a,e}function getRequiredList(){let e=[];for(let a=2;a<9;a++)e.push("DICIO_AGENCIAMENTO"+a.toString()),e.push("DICIO_CORRETAGEM"+a.toString());return e}
function toCamelCase(n){return n.split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" ")}function mapToString(n){return function n(t){return`{${[...t].map(([t,r])=>r instanceof Map?`"${t}": ${n(r)}`:`"${t}": "${r}"`).join(", ")}}`}(n)}function stringToMap(n){return function n(t){const r=JSON.parse(t),e=new Map;for(const t in r)"object"!=typeof r[t]||Array.isArray(r[t])?e.set(t,r[t]):e.set(t,n(JSON.stringify(r[t])));return e}(n)}function removeAccents(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}
(function(){!function(){"use strict";if(!self.fetch){i.prototype.append=function(e,t){e=r(e),t=o(t);var n=this.map[e];n||(n=[],this.map[e]=n),n.push(t)},i.prototype.delete=function(e){delete this.map[r(e)]},i.prototype.get=function(e){var t=this.map[r(e)];return t?t[0]:null},i.prototype.getAll=function(e){return this.map[r(e)]||[]},i.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},i.prototype.set=function(e,t){this.map[r(e)]=[o(t)]},i.prototype.forEach=function(e){var t=this;Object.getOwnPropertyNames(this.map).forEach((function(n){e(n,t.map[n])}))};var e="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),t="FormData"in self,n=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.call(c.prototype),f.call(h.prototype),self.Headers=i,self.Request=c,self.Response=h,self.fetch=function(t,n){var r;return r=c.prototype.isPrototypeOf(t)&&!n?t:new c(t,n),new Promise((function(t,n){var o=new XMLHttpRequest;"cors"===r.credentials&&(o.withCredentials=!0),o.onload=function(){var e=1223===o.status?204:o.status;if(e<100||e>599)n(new TypeError("Network request failed"));else{var r={status:e,statusText:o.statusText,headers:d(o),url:"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0},i="response"in o?o.response:o.responseText;t(new h(i,r))}},o.onerror=function(){n(new TypeError("Network request failed"))},o.open(r.method,r.url,!0),"responseType"in o&&e&&(o.responseType="blob"),r.headers.forEach((function(e,t){t.forEach((function(t){o.setRequestHeader(e,t)}))})),o.send(void 0===r._bodyInit?null:r._bodyInit)}))},self.fetch.polyfill=!0}function r(e){if("string"!=typeof e&&(e=e.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=e.toString()),e}function i(e){this.map={};var t=this;e instanceof i?e.forEach((function(e,n){n.forEach((function(n){t.append(e,n)}))})):e&&Object.getOwnPropertyNames(e).forEach((function(n){t.append(n,e[n])}))}function s(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function u(e){var t=new FileReader;return t.readAsArrayBuffer(e),a(t)}function f(){return this.bodyUsed=!1,this._initBody=function(n){if(this._bodyInit=n,"string"==typeof n)this._bodyText=n;else if(e&&Blob.prototype.isPrototypeOf(n))this._bodyBlob=n;else if(t&&FormData.prototype.isPrototypeOf(n))this._bodyFormData=n;else{if(n)throw new Error("unsupported BodyInit type");this._bodyText=""}},e?(this.blob=function(){var e=s(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(u)},this.text=function(){var e,t,n=s(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,(t=new FileReader).readAsText(e),a(t);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var e=s(this);return e||Promise.resolve(this._bodyText)},t&&(this.formData=function(){return this.text().then(l)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(e,t){var r,o;if(t=t||{},this.url=e,this.credentials=t.credentials||"omit",this.headers=new i(t.headers),this.method=(r=t.method||"GET",o=r.toUpperCase(),n.indexOf(o)>-1?o:r),this.mode=t.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&t.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(t.body)}function l(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}})),t}function d(e){var t=new i;return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){var n=e.trim().split(":"),r=n.shift().trim(),o=n.join(":").trim();t.append(r,o)})),t}function h(e,t){t||(t={}),this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof i?t.headers:new i(t.headers),this.url=t.url||""}}(),function(e,t){"use strict";if(!e.setImmediate){var n,r,o,i,s,a=1,u={},f=!1,c=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?n=function(){var e=d(arguments);return process.nextTick(h(p,e)),e}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(){var e=d(arguments);return o.port2.postMessage(e),e}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,n=function(){var e=d(arguments),t=c.createElement("script");return t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t),e}):n=function(){var e=d(arguments);return setTimeout(h(p,e),0),e}:(i="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&p(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(){var t=d(arguments);return e.postMessage(i+t,"*"),t}),l.setImmediate=n,l.clearImmediate=y}function d(e){return u[a]=h.apply(void 0,e),a++}function h(e){var t=[].slice.call(arguments,1);return function(){"function"==typeof e?e.apply(void 0,t):new Function(""+e)()}}function p(e){if(f)setTimeout(h(p,e),0);else{var t=u[e];if(t){f=!0;try{t()}finally{y(e),f=!1}}}}function y(e){delete u[e]}}(new Function("return this")()),function(e){"use strict";var t="[[PromiseStatus]]",n="[[PromiseValue]]",r=e.setImmediate||require("timers").setImmediate,o=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};function i(e){this["[[OriginalError]]"]=e}function s(e){return e instanceof i}function a(e){return"function"==typeof e}function u(e){return e instanceof w}function f(e){return e}function c(e){throw e}function l(e){delete e["[[OnFulfilled]]"],delete e["[[OnRejected]]"]}function d(e){var t,n=e.length;for(t=0;t<n;t++)e[t]()}function h(e,t,n){var r=p(n);u(r)?r.then(e,t):s(r)?t(r["[[OriginalError]]"]):e(n)}function p(e){var t;if(u(e))return e;if(function(e){return Object(e)===e}(e)){try{t=e.then}catch(e){return new i(e)}if(a(t))return new w((function(n,o){r((function(){try{t.call(e,n,o)}catch(e){o(e)}}))}))}return null}function y(e,r){function o(n){"pending"==e[t]&&m(e,n)}try{r((function(r){"pending"==e[t]&&function e(r,o){var i,a=p(o);u(a)?(r[t]="internal pending",a.then((function(t){e(r,t)}),(function(e){m(r,e)}))):s(a)?m(r,a["[[OriginalError]]"]):(r[t]="fulfilled",r[n]=o,(i=r["[[OnFulfilled]]"])&&i.length&&(l(r),d(i)))}(e,r)}),o)}catch(e){o(e)}}function m(e,r){var o=e["[[OnRejected]]"];e[t]="rejected",e[n]=r,o&&o.length&&(l(e),d(o))}function w(e){if(!u(this))throw new TypeError('constructor Promise requires "new".');this[t]="pending",this[n]=void 0,y(this,e)}w.prototype.then=function(e,o){var i,s=this;return e=a(e)?e:f,o=a(o)?o:c,i=new w((function(a,u){function f(e){var t;try{t=e(s[n])}catch(e){return void u(e)}t===i?u(new TypeError("then() cannot return same Promise that it resolves.")):h(a,u,t)}function c(){r(f,e)}function l(){r(f,o)}switch(s[t]){case"fulfilled":c();break;case"rejected":l();break;default:!function(e,t,n){e["[[OnFulfilled]]"]||(e["[[OnFulfilled]]"]=[],e["[[OnRejected]]"]=[]),e["[[OnFulfilled]]"].push(t),e["[[OnRejected]]"].push(n)}(s,c,l)}}))},w.prototype.catch=function(e){return this.then(f,e)},w.resolve=function(e){var t=p(e);return u(t)?t:new w((function(n,r){s(t)?r(t["[[OriginalError]]"]):n(e)}))},w.reject=function(e){return new w((function(t,n){n(e)}))},w.race=function(e){return new w((function(t,n){var r,i;if(o(e))for(i=e.length,r=0;r<i;r++)h(t,n,e[r]);else n(new TypeError("not an array."))}))},w.all=function(e){return new w((function(t,n){var r,i,a,f,c=0,l=0;if(o(e)){for(i=(e=e.slice(0)).length,f=0;f<i;f++)u(r=p(a=e[f]))?(l++,r.then(function(n){return function(r){e[n]=r,++c==l&&t(e)}}(f),n)):s(r)?n(r["[[OriginalError]]"]):e[f]=a;l||t(e)}else n(new TypeError("not an array."))}))},"undefined"!=typeof module&&module.exports?module.exports=e.Promise||w:e.Promise||(e.Promise=w)}(this)}).call("object"==typeof window&&window||"object"==typeof self&&self||"object"==typeof global&&global||{});